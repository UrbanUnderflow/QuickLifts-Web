exports.id=893,exports.ids=[893],exports.modules={5796:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>i.t});var i=r(6927),o=e([i]);i=(o.then?(await o)():o)[0],s()}catch(e){s(e)}})},6927:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{t:()=>c});var i=r(401),o=r(1492),a=r(9777),n=e([i,o,a]);[i,o,a]=n.then?(await n)():n;let c={async signUpWithEmail({email:e,password:t,username:r,profileImage:s,quizData:n}){try{let s=await (0,i.createUserWithEmailAndPassword)(a.I,e,t);return await (0,o.setDoc)((0,o.doc)(a.db,"users",s.user.uid),{email:e,username:r,createdAt:new Date,quizData:n||null}),s}catch(e){throw console.error("Error in signUpWithEmail:",e),e}},signInWithEmail:async(e,t)=>(0,i.signInWithEmailAndPassword)(a.I,e,t),async signInWithGoogle(){let e=new i.GoogleAuthProvider;e.addScope("email"),e.addScope("profile");try{return await (0,i.signInWithPopup)(a.I,e,i.browserPopupRedirectResolver)}catch(e){throw console.error("Error in signInWithGoogle:",e),e}},async signInWithApple(){let e=new i.OAuthProvider("apple.com");e.addScope("email"),e.addScope("name"),e.setCustomParameters({client_id:"com.pulsefitnesscollective.pulse.web",redirect_uri:window.location.origin});try{return await (0,i.signInWithRedirect)(a.I,e)}catch(e){throw console.error("Error during Apple sign-in redirect:",e),e}}};s()}catch(e){s(e)}})},9777:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{I:()=>d,db:()=>u,t:()=>h});var i=r(3745),o=r(401),a=r(1492),n=r(3392),c=e([i,o,a,n]);[i,o,a,n]=c.then?(await c)():c;let l=(0,i.initializeApp)({apiKey:"AIzaSyCBNr8WylRpi7IZ5M_COy1E3LaStQgLMvk",authDomain:"quicklifts-dd3f1.firebaseapp.com",projectId:"quicklifts-dd3f1",storageBucket:"quicklifts-dd3f1.appspot.com",messagingSenderId:"691046627244",appId:"1:691046627244:ios:821c53e53f20c736a9ec09"}),d=(0,o.getAuth)(),u=(0,a.getFirestore)(l),h=(0,n.getStorage)(l);(0,o.setPersistence)(d,o.browserLocalPersistence).then(()=>console.log("Firebase persistence set to LOCAL")).catch(e=>console.error("Error setting persistence:",e)),s()}catch(e){s(e)}})},6883:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{$:()=>d});var i=r(1492),o=r(9777),a=r(6738),n=r(3171),c=e([i,o,a]);[i,o,a]=c.then?(await c)():c;class l{get allExercises(){return this._allExercises}async fetchExercises(){try{let e=(await (0,i.getDocs)((0,i.collection)(o.db,"exercises"))).docs.map(e=>a.cd.fromFirebase({id:e.id,...e.data()})),t=(await (0,i.getDocs)((0,i.collection)(o.db,"exerciseVideos"))).docs.map(e=>a.Ax.fromFirebase({id:e.id,...e.data()})),r=e.map(e=>{let r=t.filter(t=>t.exercise.toLowerCase()===e.name.toLowerCase()).map(e=>a.Ax.fromFirebase(e));return new a.cd({...e,videos:r})});this._allExercises=r.filter(e=>e.videos.length>0)}catch(e){throw console.error("Error fetching exercises:",e),Error("Failed to fetch exercises.")}}async fetchFeaturedExercisesWithVideos(e=24){try{let t=(await (0,i.getDocs)((0,i.collection)(o.db,"exercises"))).docs.map(e=>a.cd.fromFirebase({id:e.id,...e.data()})),r=(await (0,i.getDocs)((0,i.collection)(o.db,"exerciseVideos"))).docs.map(e=>a.Ax.fromFirebase({id:e.id,...e.data()}));return t.map(e=>{let t=r.filter(t=>t.exercise.toLowerCase()===e.name.toLowerCase()).map(e=>a.Ax.fromFirebase(e));return new a.cd({id:e.id,name:e.name,description:e.description,category:e.category||{},primaryBodyParts:e.primaryBodyParts||[],secondaryBodyParts:e.secondaryBodyParts||[],tags:e.tags||[],videos:t,steps:e.steps||[],visibility:e.visibility||"live",currentVideoPosition:e.currentVideoPosition||0,sets:e.sets||0,reps:e.reps||"",weight:e.weight||0,author:a.Ae.fromFirebase(e.author||{}),createdAt:(0,n.Q)(e.createdAt),updatedAt:(0,n.Q)(e.updatedAt)})}).sort(()=>Math.random()-.5).slice(0,e)}catch(e){return console.error("Error fetching featured exercises:",e),[]}}async getExercisesByAuthor(e){try{let t=(0,i.collection)(o.db,"exerciseVideos"),r=(0,i.query)(t,(0,i.where)("userId","==",e)),s=await (0,i.getDocs)(r),n=new Set;return s.forEach(e=>{let t=e.data();t.exerciseName&&n.add(t.exerciseName)}),Array.from(n).map(t=>new a.cd({id:t,name:t,author:{userId:e}}))}catch(e){return console.error("Error fetching exercises by author:",e),[]}}async fetchPaginatedExercises(e=null,t=15){try{let r=(0,i.query)((0,i.collection)(o.db,"exercises"),(0,i.orderBy)("createdAt","desc"),(0,i.limit)(t));e&&(r=(0,i.query)(r,(0,i.startAfter)(e)));let s=await (0,i.getDocs)(r);if(s.empty)return{exercises:[],lastVisible:null};let n=(await (0,i.getDocs)((0,i.collection)(o.db,"exerciseVideos"))).docs.map(e=>a.Ax.fromFirebase({id:e.id,...e.data()})),c=s.docs.map(e=>a.cd.fromFirebase({id:e.id,...e.data()})).map(e=>{let t=n.filter(t=>t.exerciseId===e.id);return new a.cd({...e,videos:t})}).filter(e=>e.videos.length>0),l=s.docs.length>0?s.docs[s.docs.length-1]:null;return{exercises:c,lastVisible:l}}catch(e){throw console.error("Error fetching paginated exercises:",e),e}}generateExerciseLogID(e,t){return(0,i.doc)((0,i.collection)(o.db,"users",t,"MyCreatedWorkouts",e,"logs")).id}constructor(){this._allExercises=[]}}let d=new l;s()}catch(e){s(e)}})},6738:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Ae:()=>g,Ax:()=>h,Pt:()=>m,cd:()=>u,lg:()=>l,mn:()=>i});var i,o=r(2069),a=r(1393),n=r(3171),c=e([o]);o=(c.then?(await c)():c)[0],function(e){e.Biceps="biceps",e.Triceps="triceps",e.Chest="chest",e.Calves="calves",e.Abs="abs",e.Hamstrings="hamstrings",e.Back="back",e.Glutes="glutes",e.Quadriceps="quadriceps",e.Forearms="forearms",e.Shoulders="shoulders",e.Lowerback="lowerback",e.Lats="lats",e.Traps="traps",e.Rhomboids="rhomboids",e.Deltoids="deltoids",e.Fullbody="fullbody"}(i||(i={}));class l{constructor(e){this.id=e.id||"",this.workoutId=e.workoutId||"",this.userId=e.userId||"",this.exercise=u.fromFirebase(e.exercise||{}),this.logs=(e.logs||[]).map(e=>o.c_.fromFirebase(e)),this.feedback=e.feedback||"",this.note=e.note||"",this.recommendedWeight=e.recommendedWeight||"calculating...",this.isSplit=e.isSplit||!1,this.isBodyWeight=e.isBodyWeight||!1,this.logSubmitted=e.logSubmitted||!1,this.logIsEditing=e.logIsEditing||!1,this.isCompleted=e.isCompleted||!1,this.order=e.order||null,this.completedAt=(0,n.Q)(e.completedAt),this.createdAt=(0,n.Q)(e.createdAt),this.updatedAt=(0,n.Q)(e.updatedAt)}static fromFirebase(e){return new l(e?{id:e.id||"",workoutId:e.workoutId||"",userId:e.userId||"",exercise:e.exercise||{},logs:e.logs||[],feedback:e.feedback||"",note:e.note||"",recommendedWeight:e.recommendedWeight,isSplit:e.isSplit||!1,isBodyWeight:e.isBodyWeight||!1,logSubmitted:e.logSubmitted||!1,logIsEditing:e.logIsEditing||!1,isCompleted:e.isCompleted||!1,order:e.order||null,completedAt:e.completedAt,createdAt:e.createdAt,updatedAt:e.updatedAt}:{})}toDictionary(){let e={id:this.id,workoutId:this.workoutId,userId:this.userId,exercise:this.exercise.toDictionary(),logs:this.logs.map(e=>e.toDictionary()),feedback:this.feedback,note:this.note,isSplit:this.isSplit,isBodyWeight:this.isBodyWeight,logSubmitted:this.logSubmitted,logIsEditing:this.logIsEditing,isCompleted:this.isCompleted,createdAt:this.createdAt.getTime(),updatedAt:this.updatedAt.getTime(),completedAt:this.completedAt.getTime(),recommendedWeight:this.recommendedWeight};return null!=this.order&&(e.order=this.order),e}}let d={weightTraining:e=>({type:"weightTraining",details:e}),cardio:e=>({type:"cardio",details:e}),fromIdentifier:e=>{switch(e){case"weight-training":return d.weightTraining({reps:["12"],sets:3,weight:0,screenTime:0,selectedVideo:null});case"cardio":return d.cardio({duration:20,bpm:125,calories:0,screenTime:0,selectedVideo:null});default:return null}},identifier:e=>{switch(e.type){case"weightTraining":return"weight-training";case"cardio":return"cardio"}}};class u{constructor(e){this.id=e.id||"",this.name=e.name||"",this.description=e.description||"",this.primaryBodyParts=e.primaryBodyParts||[],this.secondaryBodyParts=e.secondaryBodyParts||[],this.tags=e.tags||[],this.videos=(e.videos||[]).map(e=>h.fromFirebase(e)),this.steps=e.steps||[],this.visibility=e.visibility||"live",this.currentVideoPosition=e.currentVideoPosition||0,this.sets=e.sets||0,this.reps=e.reps||"",this.weight=e.weight||0,this.author=g.fromFirebase(e.author||{}),this.createdAt=(0,n.Q)(e.createdAt),this.updatedAt=(0,n.Q)(e.updatedAt);let t=e.category||{};switch(t.id){case"weight-training":this.category=d.weightTraining({reps:t.reps||"12",sets:t.sets||3,weight:t.weight||0,screenTime:t.screenTime||0,selectedVideo:t.selectedVideo?h.fromFirebase(t.selectedVideo):null});break;case"cardio":this.category=d.cardio({duration:t.duration||0,bpm:t.bpm||0,calories:t.calories||0,screenTime:t.screenTime||0,selectedVideo:t.selectedVideo?h.fromFirebase(t.selectedVideo):null});break;default:this.category=d.weightTraining({reps:["12"],sets:3,weight:0,screenTime:0})}}static fromFirebase(e){return new u(e?{id:e.id||"",name:e.name||"",description:e.description||"",category:e.category||{},primaryBodyParts:e.primaryBodyParts||[],secondaryBodyParts:e.secondaryBodyParts||[],tags:e.tags||[],videos:e.videos||[],steps:e.steps||[],visibility:e.visibility||"live",currentVideoPosition:e.currentVideoPosition||0,sets:e.sets||0,reps:e.reps||"",weight:e.weight||0,author:e.author||{},createdAt:e.createdAt,updatedAt:e.updatedAt}:{})}toDictionary(){let e={id:this.category.type,...this.category.details,...this.category.details?.selectedVideo?{selectedVideo:this.category.details.selectedVideo.toDictionary()}:{}};return{id:this.id,name:this.name,description:this.description,category:e,primaryBodyParts:this.primaryBodyParts,secondaryBodyParts:this.secondaryBodyParts,tags:this.tags,videos:this.videos.map(e=>e.toDictionary()),steps:this.steps,visibility:this.visibility,currentVideoPosition:this.currentVideoPosition,sets:this.sets,reps:this.reps,weight:this.weight,author:this.author.toDictionary(),createdAt:this.createdAt.getTime(),updatedAt:this.updatedAt.getTime()}}}class h{constructor(e){this.id=e.id||"",this.exerciseId=e.exerciseId||"",this.username=e.username||"",this.userId=e.userId||"",this.videoURL=e.videoURL||"",this.fileName=e.fileName||"",this.exercise=e.exercise||"",this.profileImage=a.m1.fromFirebase(e.profileImage||{}),this.caption=e.caption,this.gifURL=e.gifURL,this.thumbnail=e.thumbnail,this.visibility=e.visibility||"private",this.totalAccountsReached=e.totalAccountsReached||0,this.totalAccountLikes=e.totalAccountLikes||0,this.totalAccountBookmarked=e.totalAccountBookmarked||0,this.totalAccountUsage=e.totalAccountUsage||0,this.isApproved=e.isApproved||!1,this.liked=e.liked||!1,this.bookmarked=e.bookmarked||!1,this.createdAt=(0,n.Q)(e.createdAt),this.updatedAt=(0,n.Q)(e.updatedAt)}static fromFirebase(e){return new h(e?{id:e.id||"",exerciseId:e.exerciseId||"",username:e.username||"",userId:e.userId||"",videoURL:e.videoURL||"",fileName:e.fileName||"",exercise:e.exercise||"",profileImage:e.profileImage||{},caption:e.caption,gifURL:e.gifURL,thumbnail:e.thumbnail||null,visibility:e.visibility||"private",totalAccountsReached:e.totalAccountsReached||0,totalAccountLikes:e.totalAccountLikes||0,totalAccountBookmarked:e.totalAccountBookmarked||0,totalAccountUsage:e.totalAccountUsage||0,isApproved:e.isApproved||!1,liked:e.liked||!1,bookmarked:e.bookmarked||!1,createdAt:e.createdAt,updatedAt:e.updatedAt}:{})}toDictionary(){let e={id:this.id,exerciseId:this.exerciseId,username:this.username,userId:this.userId,videoURL:this.videoURL,fileName:this.fileName,exercise:this.exercise,profileImage:this.profileImage.toDictionary(),visibility:this.visibility,totalAccountsReached:this.totalAccountsReached,totalAccountLikes:this.totalAccountLikes,totalAccountBookmarked:this.totalAccountBookmarked,totalAccountUsage:this.totalAccountUsage,isApproved:this.isApproved,createdAt:this.createdAt.getTime(),updatedAt:this.updatedAt.getTime()};return this.caption&&(e.caption=this.caption),this.gifURL&&(e.gifURL=this.gifURL),this.thumbnail&&(e.thumbnail=this.thumbnail),null!==this.liked&&(e.liked=this.liked),null!==this.bookmarked&&(e.bookmarked=this.bookmarked),e}}class m{constructor(e){this.id=e.id||"",this.exerciseName=e.exerciseName,this.exercise=e.exercise,this.exerciseLogId=e.exerciseLogId,this.category=e.category,this.notes=e.notes,this.isSplit=e.isSplit,this.isMissing=e.isMissing,this.groupId=e.groupId,this.closestMatch=e.closestMatch}}class g{constructor(e){this.userId=e.userId||"",this.username=e.username||""}static fromFirebase(e){return new g(e?{userId:e.userId||"",username:e.username||""}:{})}toDictionary(){return{userId:this.userId,username:this.username}}}s()}catch(e){s(e)}})},7440:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{$5:()=>i,ZS:()=>o,kf:()=>h});var i,o,a=r(3392),n=r(8157),c=r(9777),l=e([a,n,c]);[a,n,c]=l.then?(await l)():l,function(e){e.Profile="profile_images",e.Feedback="feedback",e.CheckIn="checkin",e.Meal="meal",e.GroupChat="group_chat"}(i||(i={})),function(e){e.Exercise="exercise",e.Intro="intro",e.RoundChat="round-chat"}(o||(o={}));class d{async uploadVideo(e,t="exercise"){let r=c.I.currentUser;if(!r)throw Error("User must be authenticated to upload video");if(!["video/mp4","video/quicktime","video/x-msvideo"].includes(e.type))throw Error("Invalid file type. Only MP4, AVI, and QuickTime videos are allowed.");if(e.size>104857600)throw Error("File is too large. Maximum size is 100MB.");let s=`${Date.now()}_${e.name}`,i=`videos/${r.uid}/${s}`,o=(0,a.ref)((0,a.getStorage)(),i);try{let t=await (0,a.uploadBytes)(o,e),r=await (0,a.getDownloadURL)(t.ref);return{gsURL:`gs://${t.ref.bucket}/${t.ref.fullPath}`,downloadURL:r}}catch(e){throw console.error("Video upload failed",e),e}}async uploadImage(e,t="profile_images"){let r=c.I.currentUser;if(!r)throw Error("User must be authenticated to upload image");let s=`${Date.now()}_${e.name}`,i=`${t}/${r.uid}/${s}`,o=(0,a.ref)(this.storage,i);try{let r=await (0,a.uploadBytes)(o,e),s=await (0,a.getDownloadURL)(r.ref),i=`gs://${r.ref.bucket}/${r.ref.fullPath}`;return"profile_images"===t&&await this.updateUserProfileImage(s),{gsURL:i,downloadURL:s}}catch(e){throw console.error("Image upload failed",e),e}}async updateUserProfileImage(e){if(!n.W4.currentUser)throw Error("No current user found");let t=new n.n5({...n.W4.currentUser.toDictionary(),profileImage:{profileImageURL:e,imageOffsetWidth:0,imageOffsetHeight:0},updatedAt:new Date});await n.W4.updateUser(t.id,t)}async fetchImage(e){if(this.imageCache.has(e))return this.imageCache.get(e);try{let t=await fetch(e),r=await t.blob(),s=URL.createObjectURL(r);return this.imageCache.set(e,s),s}catch(e){throw console.error("Image fetch failed",e),e}}constructor(){this.storage=(0,a.getStorage)(),this.imageCache=new Map}}class u{trimVideo(e,t,r,s){return new Promise((i,o)=>{let a=document.createElement("video"),n=document.createElement("canvas"),c=n.getContext("2d");if(!c)return o(Error("Unable to get canvas context"));let l=[];a.src=URL.createObjectURL(e),a.onloadedmetadata=()=>{n.width=a.videoWidth,n.height=a.videoHeight,a.currentTime=t},a.onseeked=()=>{let o=n.captureStream(),d=new MediaRecorder(o);d.ondataavailable=e=>{e.data.size>0&&l.push(e.data)},d.onstop=()=>{let t=new Blob(l,{type:l[0]?.type||"video/webm"}),r=new File([t],e.name,{type:"video/webm"});URL.revokeObjectURL(a.src),i(r)},d.start(),a.play(),a.ontimeupdate=()=>{a.currentTime>=r?(d.stop(),a.pause()):(c.drawImage(a,0,0,n.width,n.height),s&&s((a.currentTime-t)/(r-t)))}},a.onerror=()=>{o(Error("Error loading video"))}})}}new u;let h=new d;s()}catch(e){s(e)}})},8157:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{I0:()=>i.I0,Qe:()=>i.Qe,Um:()=>i.Um,W4:()=>o.W,Y0:()=>i.Y0,aZ:()=>i.aZ,m1:()=>i.m1,n5:()=>i.n5,o5:()=>i.o5});var i=r(1393),o=r(8254),a=e([o]);o=(a.then?(await a)():a)[0],s()}catch(e){s(e)}})},8254:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{W:()=>g});var i=r(1393),o=r(4565),a=r(6738),n=r(8157),c=r(1492),l=r(9777),d=r(1912),u=r(4484),h=e([o,a,n,c,l,d,u]);[o,a,n,c,l,d,u]=h.then?(await h)():h;class m{get currentUser(){return d.h.getState().user.currentUser}set currentUser(e){d.h.dispatch((0,u.av)(e))}async fetchUserFromFirestore(e){let t=(0,c.doc)(l.db,"users",e),r=await (0,c.getDoc)(t);return r.exists()?new i.n5(r.data()):null}async updateUser(e,t){let r=(0,c.doc)(l.db,"users",e);await (0,c.setDoc)(r,t.toDictionary(),{merge:!0})}async getUsersByIds(e){if(!e.length)return[];let t=[];for(let r=0;r<e.length;r+=10){let s=e.slice(r,r+10),o=(0,c.collection)(l.db,"users"),a=(0,c.query)(o,(0,c.where)((0,c.documentId)(),"in",s));(await (0,c.getDocs)(a)).docs.forEach(e=>{t.push(new i.n5({id:e.id,...e.data()}))})}return t}async getUserById(e){try{let t=await (0,c.getDoc)((0,c.doc)(l.db,"users",e));if(!t.exists())throw Error("User not found");return new i.n5({id:t.id,...t.data()})}catch(e){throw console.error("Error getting user by ID:",e),e}}async createStack(e,t){if(!this.currentUser?.id)throw Error("No user is signed in.");let r=(0,c.doc)((0,c.collection)(l.db,"users",this.currentUser.id,"MyCreatedWorkouts"),e.id);try{if(console.log("Right before we save: "+JSON.stringify(e.toDictionary())),await (0,c.setDoc)(r,e.toDictionary()),console.log("Stack created successfully"),t&&t.length>0){let e=(0,c.writeBatch)(l.db);t.forEach((t,s)=>{t.order=s+1;let i=(0,c.doc)((0,c.collection)(r,"logs"),t.id);e.set(i,t.toDictionary())}),await e.commit(),console.log("Exercise logs saved successfully")}return e}catch(e){throw console.error("Error creating stack:",e),e}}async fetchUserStacks(e){let t=e||this.currentUser?.id;if(!t)throw Error("No user ID provided");try{let e=(0,c.collection)(l.db,"users",t,"MyCreatedWorkouts"),r=await (0,c.getDocs)(e);return await Promise.all(r.docs.map(async e=>{let t=e.data(),r=(0,c.collection)(e.ref,"logs"),s=(await (0,c.getDocs)(r)).docs.map(e=>a.lg.fromFirebase({id:e.id,...e.data()}));return new o.oQ({...t,id:e.id,logs:s})}))}catch(e){throw console.error("Error fetching user stacks:",e),e}}async fetchUserVideos(e){let t=e||this.currentUser?.id;if(!t)throw Error("No user ID provided");try{let e=(0,c.collection)(l.db,"exerciseVideos"),r=(0,c.query)(e,(0,c.where)("userId","==",t)),s=await (0,c.getDocs)(r),i={};s.docs.forEach(e=>{let t=e.data(),r=t.exercise;if(!r){console.warn(`Exercise name missing for video ${e.id}`);return}let s=new a.Ax({id:e.id,exerciseId:t.exerciseId||"",username:t.username||"",userId:t.userId||"",videoURL:t.videoURL||"",fileName:t.fileName||"",exercise:r,profileImage:new n.m1(t.profileImage||{}),caption:t.caption||"",gifURL:t.gifURL||"",thumbnail:t.thumbnail||"",visibility:t.visibility||"open",totalAccountsReached:t.totalAccountsReached||0,totalAccountLikes:t.totalAccountLikes||0,totalAccountBookmarked:t.totalAccountBookmarked||0,totalAccountUsage:t.totalAccountUsage||0,isApproved:t.isApproved||!1,liked:t.liked||!1,bookmarked:t.bookmarked||!1,createdAt:t.createdAt?new Date(t.createdAt):new Date,updatedAt:t.updatedAt?new Date(t.updatedAt):new Date});i[r]||(i[r]=[]),i[r].push(s)});let o=(0,c.collection)(l.db,"exercises");return(await (0,c.getDocs)(o)).docs.map(e=>{let t=e.data(),r=t.name;return new a.cd({id:e.id,name:r,category:t.category,primaryBodyParts:t.primaryBodyParts||[],secondaryBodyParts:t.secondaryBodyParts||[],tags:t.tags||[],description:t.description||"",visibility:t.visibility||"limited",steps:t.steps||[],videos:i[r]||[],currentVideoPosition:0,reps:t.reps||"",sets:t.sets||0,weight:t.weight||0,author:new a.Ae({userId:t.author?.userId||"",username:t.author?.username||""}),createdAt:t.createdAt?new Date(t.createdAt):new Date,updatedAt:t.updatedAt?new Date(t.updatedAt):new Date})}).filter(e=>e.videos.length>0)}catch(e){throw console.error("Error fetching user videos:",e),e}}async fetchFollowing(){let e=this.currentUser;if(!e?.id)throw Error("No user is signed in");try{let t=(0,c.collection)(l.db,"followRequests"),r=(0,c.query)(t,(0,c.where)("fromUser.id","==",e.id));return(await (0,c.getDocs)(r)).docs.map(e=>{let t=e.data();return{fromUser:{id:t.fromUser?.id||"",username:t.fromUser?.username||"",displayName:t.fromUser?.displayName||""},toUser:{id:t.toUser?.id||"",username:t.toUser?.username||"",displayName:t.toUser?.displayName||""},status:t.status||"",createdAt:t.createdAt instanceof Date?t.createdAt:t.createdAt?new Date(t.createdAt):new Date,updatedAt:t.updatedAt instanceof Date?t.updatedAt:t.updatedAt?new Date(t.updatedAt):new Date}})}catch(e){throw console.error("Error fetching following:",e),e}}async fetchFollowers(){let e=this.currentUser;if(!e?.id)throw Error("No user is signed in");try{let t=(0,c.collection)(l.db,"followRequests"),r=(0,c.query)(t,(0,c.where)("toUser.id","==",e.id));return(await (0,c.getDocs)(r)).docs.map(e=>{let t=e.data();return{fromUser:{id:t.fromUser?.id||"",username:t.fromUser?.username||"",displayName:t.fromUser?.displayName||""},toUser:{id:t.toUser?.id||"",username:t.toUser?.username||"",displayName:t.toUser?.displayName||""},status:t.status||"",createdAt:t.createdAt instanceof Date?t.createdAt:t.createdAt?new Date(t.createdAt):new Date,updatedAt:t.updatedAt instanceof Date?t.updatedAt:t.updatedAt?new Date(t.updatedAt):new Date}})}catch(e){throw console.error("Error fetching followers:",e),e}}async getUserIdByUsername(e){try{let t=(0,c.collection)(l.db,"users"),r=(0,c.query)(t,(0,c.where)("username","==",e),(0,c.limit)(1)),s=await (0,c.getDocs)(r);if(!s.empty)return s.docs[0].id;return null}catch(e){return console.error("Error fetching user ID by username:",e),null}}async getAllUsers(){try{let e=(0,c.collection)(l.db,"users");return(await (0,c.getDocs)(e)).docs.map(e=>new i.n5({id:e.id,...e.data()})).filter(e=>e.profileImage?.profileImageURL)}catch(e){return console.error("Error fetching users:",e),[]}}async getUserByUsername(e){try{let t=(0,c.collection)(l.db,"users"),r=(0,c.query)(t,(0,c.where)("username","==",e)),s=await (0,c.getDocs)(r);if(s.empty)return null;let o=s.docs[0].data();return new i.n5({id:s.docs[0].id,...o})}catch(e){throw console.error("Error fetching user by username:",e),e}}async fetchUsersWithVideosUploaded(){try{let e=(0,c.collection)(l.db,"users"),t=(0,c.query)(e,(0,c.where)("videoCount",">",0));return(await (0,c.getDocs)(t)).docs.map(e=>{let t=e.data();return new i.n5({id:e.id,...t})}).filter(e=>e.profileImage?.profileImageURL).sort(()=>Math.random()-.5)}catch(e){return console.error("Error fetching users with videos:",e),[]}}}let g=new m;s()}catch(e){s(e)}})},1393:(e,t,r)=>{"use strict";r.d(t,{I0:()=>c,Qe:()=>s,Um:()=>p,Y0:()=>a,aZ:()=>i,m1:()=>m,n5:()=>g,o5:()=>o});var s,i,o,a,n,c,l,d,u,h=r(3171);class m{constructor(e){this.profileImageURL=e.profileImageURL||"",this.imageOffsetWidth=e.imageOffsetWidth||0,this.imageOffsetHeight=e.imageOffsetHeight||0}static fromFirebase(e){return new m(e?{profileImageURL:e.profileImageURL||"",imageOffsetWidth:e.imageOffsetWidth||0,imageOffsetHeight:e.imageOffsetHeight||0}:{})}toDictionary(){return{profileImageURL:this.profileImageURL,imageOffsetWidth:this.imageOffsetWidth,imageOffsetHeight:this.imageOffsetHeight}}}class g{constructor(e){this.level="novice",this.id=e.id||"",this.displayName=e.displayName||"",this.email=e.email||"",this.username=e.username||"",this.homeGym=e.homeGym||null,this.encouragement=e.encouragement||[],this.birthdate=(0,h.Q)(e.birthdate)||null,this.gender=e.gender||null,this.selfDisclosedGender=e.selfDisclosedGender||"",this.height=e.height||null,this.location=e.location||null,this.bio=e.bio||"",this.fcmToken=e.fcmToken||"",this.workoutBuddy=e.workoutBuddy||"",this.workoutBuddyUser=e.workoutBuddyUser||null,this.additionalGoals=e.additionalGoals||"",this.blockedUsers=e.blockedUsers||[],this.level=e.level||"novice",this.goal=e.goal||[],this.bodyWeight=Array.isArray(e.bodyWeight)?e.bodyWeight.map(e=>p.fromFirebase(e)):[],this.macros=e.macros||{},this.profileImage=m.fromFirebase(e.profileImage||{}),this.registrationComplete=e.registrationComplete||!1,this.creator=e.creator||null,this.subscriptionType=e.subscriptionType||"Unsubscribed",this.subscriptionPlatform=e.subscriptionPlatform||"web",this.referrer=e.referrer||"",this.isCurrentlyActive=e.isCurrentlyActive||!1,this.videoCount=e.videoCount||0,this.createdAt=(0,h.Q)(e.createdAt)||null,this.updatedAt=(0,h.Q)(e.updatedAt)||null}toDictionary(){return{id:this.id,displayName:this.displayName,email:this.email,username:this.username,homeGym:this.homeGym,encouragement:this.encouragement,birthdate:this.birthdate?.getTime(),gender:this.gender,selfDisclosedGender:this.selfDisclosedGender,height:this.height,location:this.location,bio:this.bio,fcmToken:this.fcmToken,workoutBuddy:this.workoutBuddy,workoutBuddyUser:this.workoutBuddyUser,additionalGoals:this.additionalGoals,blockedUsers:this.blockedUsers,level:this.level,goal:this.goal,bodyWeight:this.bodyWeight,macros:this.macros,profileImage:this.profileImage.toDictionary(),registrationComplete:this.registrationComplete,creator:this.creator,subscriptionType:this.subscriptionType,subscriptionPlatform:this.subscriptionPlatform,referrer:this.referrer,isCurrentlyActive:this.isCurrentlyActive,videoCount:this.videoCount,createdAt:this.createdAt.getTime(),updatedAt:this.updatedAt.getTime()}}toShortUser(){return{id:this.id,displayName:this.displayName,email:this.email,fcmToken:this.fcmToken,username:this.username,level:this.level,videoCount:this.videoCount,profileImage:this.profileImage}}}(function(e){e.unsubscribed="Unsubscribed",e.beta="Beta User",e.monthly="Monthly Subscriber",e.annual="Annual Subscriber",e.sweatEquityPartner="Sweat Equity Partner",e.executivePartner="Executive Partner"})(s||(s={})),function(e){e.Novice="novice",e.Intermediate="intermediate",e.Expert="expert"}(i||(i={})),function(e){e.LoseWeight="Lose weight",e.GainWeight="Gain muscle mass",e.ToneUp="Tone up",e.GeneralFitness="General Fitness"}(o||(o={})),function(e){e.Woman="woman",e.Man="man",e.SelfDescribe="I'd rather self describe"}(a||(a={})),function(e){e.iOS="ios",e.Web="web",e.Android="android"}(n||(n={})),function(e){e.PersonalTrainer="personal_trainer",e.FitnessEnthusiast="fitness_enthusiast"}(c||(c={})),function(e){e.InspireOthers="inspire_others",e.BuildCommunity="build_community"}(l||(l={})),function(e){e.Introduction="introduction",e.InProgress="in_progress",e.Complete="complete"}(d||(d={})),function(e){e.NotStarted="not_started",e.InProgress="in_progress",e.Completed="completed"}(u||(u={}));class p{constructor(e){let t=Date.now()/1e3;this.id=e.id||crypto.randomUUID(),this.oldWeight=e.oldWeight||0,this.newWeight=e.newWeight||0,this.frontUrl=e.frontUrl||"",this.backUrl=e.backUrl||"",this.sideUrl=e.sideUrl||"",this.createdAt=e.createdAt||t,this.updatedAt=e.updatedAt||t}static fromFirebase(e){return new p({id:e.id||crypto.randomUUID(),oldWeight:e.oldWeight||0,newWeight:e.newWeight||0,frontUrl:e.frontUrl||"",backUrl:e.backUrl||"",sideUrl:e.sideUrl||"",createdAt:e.createdAt||0,updatedAt:e.updatedAt||0})}toFirestore(){return{oldWeight:this.oldWeight,newWeight:this.newWeight,frontUrl:this.frontUrl,backUrl:this.backUrl,sideUrl:this.sideUrl,createdAt:this.createdAt,updatedAt:this.updatedAt}}}},4565:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{G_:()=>i.G,oQ:()=>o.oQ});var i=r(9284),o=r(2069),a=e([i,o]);[i,o]=a.then?(await a)():a,s()}catch(e){s(e)}})},9284:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{G:()=>y});var i=r(1492),o=r(9777),a=r(8157),n=r(6738),c=r(6883),l=r(1393),d=r(2069),u=r(3592),h=r(2286),m=r(3171),g=r(1912),p=r(1308),f=e([i,o,a,n,c,d,g,p]);[i,o,a,n,c,d,g,p]=f.then?(await f)():f;class w{get currentWorkout(){return g.h.getState().workout.currentWorkout}set currentWorkout(e){g.h.dispatch((0,p.q1)(e))}get currentWorkoutLogs(){return g.h.getState().workout.currentExerciseLogs}set currentWorkoutLogs(e){g.h.dispatch((0,p.HX)(e))}get currentWorkoutSummary(){return g.h.getState().workout.workoutSummary}set currentWorkoutSummary(e){g.h.dispatch((0,p.QU)(e))}generateId(){return(0,i.doc)((0,i.collection)(o.db,"workouts")).id}async formatWorkoutAndInitializeLogs(e,t){let r=this.generateId(),s=[],i=[];return e.filter(e=>e?.exercise&&e.exercise.id).forEach((e,o)=>{let l=new n.cd({...e.exercise,id:e.exercise.id||y.generateId(),name:e.exercise.name||"",author:e.exercise.author||{userId:t||"PulseAI",username:t||"PulseAI"},description:e.exercise.description||"",category:e.exercise.category||{type:"weightTraining",details:null},primaryBodyParts:e.exercise.primaryBodyParts||[],secondaryBodyParts:e.exercise.secondaryBodyParts||[],tags:e.exercise.tags||[],videos:e.exercise.videos||[],createdAt:e.exercise.createdAt||new Date,updatedAt:e.exercise.updatedAt||new Date}),u={exercise:l,groupId:e.groupId||0};s.push(u);let h=e.category?.type==="weightTraining"?e.category:{type:"weightTraining",details:{sets:3,reps:["12"],weight:0,screenTime:0}},m=h.details?.sets??3,g=h.details?.reps??["12"],p=h.details?.weight??0,f=Array.from({length:m},()=>new d.c_({reps:parseInt(g[0]||"12",10),weight:p||0})),w=c.$.generateExerciseLogID(r,a.W4.currentUser?.id||"anonymous"),x=new n.lg({id:w,workoutId:r,userId:a.W4.currentUser?.id||"anonymous",exercise:l,logs:f,feedback:"",note:e.notes||"",isSplit:e.isSplit||!1,logSubmitted:!1,logIsEditing:!1,isCompleted:!1,order:o+1,createdAt:new Date,updatedAt:new Date,completedAt:new Date});i.push(x)}),{workout:new d.oQ({id:r,roundWorkoutId:"",exercises:s,logs:i,title:"",description:"",duration:d.oQ.estimatedDuration(s)||0,workoutRating:"none",useAuthorContent:!1,isCompleted:!1,workoutStatus:"archived",author:a.W4.currentUser?.id||"PulseAI",createdAt:new Date,updatedAt:new Date,zone:d.oQ.determineWorkoutZone(s)||"full"}),exerciseLogs:i}}async getUserById(e){try{let t=await (0,i.getDoc)((0,i.doc)(o.db,"users",e));if(!t.exists())throw Error("User not found");return new l.n5({id:t.id,...t.data()})}catch(e){throw console.error("Error getting user by ID:",e),e}}async revertAuthorFormat(e,t){if(!a.W4.currentUser?.id)throw Error("No user signed in");let r=(0,i.doc)(o.db,"users",a.W4.currentUser.id,"MyCreatedWorkouts",e);await (0,i.updateDoc)(r,{author:t})}async updateWorkout(e){if(!a.W4.currentUser?.id)throw Error("No user is signed in");try{let t=(0,i.doc)(o.db,"users",a.W4.currentUser.id,"MyCreatedWorkouts",e.id);if(await (0,i.setDoc)(t,e.toDictionary(),{merge:!0}),e.logs&&e.logs.length>0){let r=(0,i.writeBatch)(o.db),s=(0,i.collection)(t,"logs");e.logs.forEach(e=>{let t=(0,i.doc)(s,e.id);r.set(t,e.toDictionary(),{merge:!0})}),await r.commit()}}catch(e){throw console.error("Error updating workout:",e),e}}async fetchCurrentWorkout(e){return(await this.fetchCurrentWorkoutSession(e)).workout}async getAllSweatlists(e){if(!e)throw Error("User ID is required");let t=(0,i.collection)(o.db,"users",e,"MyCreatedWorkouts");try{let r=await this.fetchAndMapExercisesWithVideos(),s=await (0,i.getDocs)(t),a=[];for(let t of s.docs){let s=t.data(),n=t.id,c=(s.exercises||[]).map(e=>{let t=r.find(t=>t.name===e.exercise.name);return console.log("This is the mapped exercise: "+t),{...e,exercise:t||e}}),l=new d.oQ({id:s.id||"",roundWorkoutId:s.roundWorkoutId||"",collectionId:s.collectionId,exercises:c,challenge:s.challenge,logs:[],title:s.title||"",description:s.description||"",duration:s.duration||0,workoutRating:s.workoutRating,useAuthorContent:s.useAuthorContent||!1,isCompleted:s.isCompleted||!1,workoutStatus:s.workoutStatus||"notStarted",startTime:s.startTime?new Date(s.startTime):void 0,order:s.order,author:s.author||e,createdAt:s.createdAt?new Date(s.createdAt):new Date,updatedAt:s.updatedAt?new Date(s.updatedAt):new Date,zone:s.zone||"FULL_BODY"}),u=(0,i.collection)(o.db,"users",e,"MyCreatedWorkouts",n,"logs"),h=await (0,i.getDocs)(u);l.logs=h.docs.map(e=>({...e.data(),id:e.id})),a.push(l)}return a}catch(e){throw console.error("Error fetching sweatlists:",e.message),Error("Failed to fetch sweatlists")}}async getUserChallengesByChallengeId(e){let t=(0,i.collection)(o.db,"user-challenge"),r=(0,i.query)(t,(0,i.where)("challengeId","==",e));try{let e=(await (0,i.getDocs)(r)).docs.map(e=>{let t=e.data();return new d.lM(e.id,t)});if(e.length>0)return{userChallenges:e};return{userChallenges:[],error:"No user challenges found for this challenge."}}catch(e){return console.error("Error fetching user challenges by challengeId:",e),{userChallenges:[],error:e instanceof Error?e.message:"Unknown error"}}}async fetchWorkoutSummaries(e){let t=a.W4.currentUser;if(!t?.id)throw Error("No user is signed in");let r=(0,u.WU)(e,"MM-dd-yyyy"),s=(0,i.collection)(o.db,"users",t.id,"workoutSummaries"),n=(0,i.query)(s,(0,i.where)("date","==",r));try{return(await (0,i.getDocs)(n)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw console.error("Error fetching workout summaries:",e.message),Error(e.message)}}async fetchAllWorkoutSummaries(){let e=a.W4.currentUser;if(!e?.id)throw Error("No user is signed in");let t=(0,i.collection)(o.db,"users",e.id,"workoutSummary"),r=(0,i.query)(t,(0,i.orderBy)("createdAt","asc"));try{return(await (0,i.getDocs)(r)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw console.error("Error fetching all workout summaries:",e.message),Error(e.message)}}async fetchUserChallengesByUserId(e){let t=(0,i.collection)(o.db,"user-challenge"),r=(0,i.query)(t,(0,i.where)("userId","==",e));try{return(await (0,i.getDocs)(r)).docs.map(e=>{let t=e.data();return{id:e.id,...t,challenge:t.challenge?new d.tv({id:t.challenge.id,title:t.challenge.title,subtitle:t.challenge.subtitle,participants:t.challenge.participants||[],status:t.challenge.status,startDate:t.challenge.startDate?new Date(t.challenge.startDate):new Date,endDate:t.challenge.endDate?new Date(t.challenge.endDate):new Date,createdAt:t.challenge.createdAt?new Date(t.challenge.createdAt):new Date,updatedAt:t.challenge.updatedAt?new Date(t.challenge.updatedAt):new Date,introVideos:(t.challenge.introVideos||[]).map(e=>new d.L$({id:e.id,userId:e.userId,videoUrl:e.videoUrl}))}):void 0,createdAt:(0,h.C9)(t.createdAt),updatedAt:(0,h.C9)(t.updatedAt)}})}catch(e){throw console.error("Error fetching user challenges by userId:",e),e}}async fetchCollectionWithSweatLists(e){try{let t=await this.getCollectionById(e),r=[];for(let e of t.sweatlistIds||[])try{let[t]=await this.fetchSavedWorkout(e.sweatlistAuthorId,e.id);t&&r.push(t)}catch(t){console.error(`Error fetching workout ${e.id}:`,t)}return{collection:t,sweatLists:r}}catch(e){throw console.error("Error fetching collection with sweat lists:",e),e}}async fetchSavedWorkout(e,t){try{console.log("Starting fetchSavedWorkout with:",{userId:e,workoutId:t});let r=(0,i.doc)(o.db,"users",e,"MyCreatedWorkouts",t);console.log("Fetching workout document from:",r.path);let s=await (0,i.getDoc)(r);if(console.log("Workout document exists:",s.exists()),!s.exists())return console.log("No workout document found"),[null,null];let a=s.data();console.log("Raw workout data:",a),console.log("Fetching exercises with videos...");let c=await this.fetchAndMapExercisesWithVideos();console.log("Fetched exercises with videos:",c),console.log("Mapping exercises in workout:",a.exercises);let l=(a.exercises||[]).map(e=>{let t=c.find(t=>t.name===e.exercise.name);return console.log("Mapping exercise:",{name:e.exercise.name,foundMatch:!!t}),{...e,exercise:t||e.exercise}});a.exercises=l,console.log("Creating Workout instance with data:",{id:a.id,title:a.title,exerciseCount:l.length});let u=new d.oQ({id:t,...a});console.log("Fetching workout logs...");let h=(0,i.collection)(r,"logs"),g=await (0,i.getDocs)(h);console.log("Found logs count:",g.size);let p=g.docs.map(r=>{let s=r.data(),i=c.find(e=>e.name===s.exercise.name);return console.log("Processing log:",{logId:r.id,exerciseName:s.exercise.name,foundExerciseMatch:!!i}),new n.lg({id:r.id,workoutId:t,userId:e,exercise:i||s.exercise,logs:s.log||[],feedback:s.feedback||"",note:s.note||"",recommendedWeight:s.recommendedWeight||"calculating...",isSplit:s.isSplit||!1,isBodyWeight:s.isBodyWeight||!1,logSubmitted:s.logSubmitted||!1,logIsEditing:s.logIsEditing||!1,isCompleted:s.isCompleted||!1,completedAt:(0,m.Q)(s.completedAt),createdAt:(0,m.Q)(s.createdAt),updatedAt:(0,m.Q)(s.updatedAt)})});return u.logs=p,console.log("Returning workout and logs:",{workoutId:u.id,logsCount:p.length}),[u,p]}catch(e){throw console.error("Error fetching saved workout:",e),e}}async fetchUserChallengesByChallengeId(e){let t=(0,i.collection)(o.db,"user-challenge"),r=(0,i.query)(t,(0,i.where)("challengeId","==",e));try{return(await (0,i.getDocs)(r)).docs.map(e=>{let t=e.data();return{id:e.id,...t,challenge:t.challenge?new d.tv({id:t.challenge.id,title:t.challenge.title,subtitle:t.challenge.subtitle,participants:t.challenge.participants||[],status:t.challenge.status,startDate:t.challenge.startDate?new Date(t.challenge.startDate):new Date,endDate:t.challenge.endDate?new Date(t.challenge.endDate):new Date,createdAt:t.challenge.createdAt?new Date(t.challenge.createdAt):new Date,updatedAt:t.challenge.updatedAt?new Date(t.challenge.updatedAt):new Date,introVideos:(t.challenge.introVideos||[]).map(e=>new d.L$({id:e.id,userId:e.userId,videoUrl:e.videoUrl}))}):void 0,createdAt:(0,h.C9)(t.createdAt),updatedAt:(0,h.C9)(t.updatedAt)}})}catch(e){throw console.error("Error fetching user challenges by challengeId:",e),e}}async getCollectionById(e){console.log("Fetching collection with id:",e);try{let t=(0,i.doc)(o.db,"sweatlist-collection",e),r=await (0,i.getDoc)(t);if(r.exists())return new d.No({id:r.id,...r.data()});throw Error("Collection not found")}catch(e){throw console.error("Error getting collection by ID:",e),e}}async fetchActiveChallenges(){let e=a.W4.currentUser;if(!e?.id)throw Error("No user is signed in");let t=(0,i.collection)(o.db,"user-challenge"),r=(0,i.query)(t,(0,i.where)("userId","==",e.id));try{return(await (0,i.getDocs)(r)).docs.map(e=>{let t=e.data(),r=t.challenge?new d.tv({id:t.challenge.id,title:t.challenge.title,subtitle:t.challenge.subtitle,participants:t.challenge.participants||[],status:t.challenge.status,startDate:(0,m.Q)(t.challenge.startDate),endDate:(0,m.Q)(t.challenge.endDate),createdAt:(0,m.Q)(t.challenge.createdAt),updatedAt:(0,m.Q)(t.challenge.updatedAt),introVideos:(t.challenge.introVideos||[]).map(e=>new d.L$({id:e.id,userId:e.userId,videoUrl:e.videoUrl}))}):void 0;return{id:e.id,...t,challenge:r,createdAt:(0,m.Q)(t.createdAt),updatedAt:(0,m.Q)(t.updatedAt)}}).filter(e=>{let t=e.challenge?.endDate;return t&&t>new Date})}catch(e){throw console.error("Error fetching active challenges:",e),e}}async fetchUserChallenges(){let e=a.W4.currentUser;if(!e?.id)throw Error("No user is signed in");let t=(0,i.collection)(o.db,"user-challenge"),r=(0,i.query)(t,(0,i.where)("userId","==",e.id));try{return(await (0,i.getDocs)(r)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw console.error("Error fetching user challenges:",e),Error("Failed to fetch user challenges")}}async updateWorkoutSummary({userId:e,workoutId:t,summary:r}){if(!e)throw Error("No user ID provided");try{let t=(0,i.doc)(o.db,"users",e,"workoutSummary",r.id),s={id:r.id,workoutId:r.workoutId,exercises:r.exercises,bodyParts:r.bodyParts,secondaryBodyParts:r.secondaryBodyParts,workoutTitle:r.workoutTitle,caloriesBurned:r.caloriesBurned,workoutRating:r.workoutRating,exercisesCompleted:r.exercisesCompleted,aiInsight:r.aiInsight,recommendations:r.recommendations,gifURLs:r.gifURLs,recommendedWork:r.recommendedWork,isCompleted:r.isCompleted,createdAt:r.createdAt,updatedAt:new Date,completedAt:r.completedAt,duration:r.duration};await (0,i.setDoc)(t,s,{merge:!0}),console.log("Workout summary document updated successfully")}catch(e){throw console.error("Error updating workout summary:",e),e}}async updateWorkoutLogs({userId:e,workoutId:t,logs:r}){try{let s=(0,i.doc)(o.db,"users",e,"workoutSessions",t),a=(0,i.collection)(s,"logs"),n=(0,i.writeBatch)(o.db);r.forEach(e=>{let t=(0,i.doc)(a,e.id);n.update(t,{...e.toDictionary()})}),await n.commit()}catch(e){throw console.error("Error updating workout logs:",e),e}}async cancelWorkout(e,t){if(!a.W4.currentUser?.id||!e)throw Error("User not authenticated.");try{await this.deleteWorkoutSession(e.id),t&&await this.deleteWorkoutSummary(t.id),this.cleanUpWorkoutInProgress(),console.log("Workout canceled and cleaned up successfully.")}catch(e){throw console.error("Error canceling workout:",e),e}}async deleteWorkoutSession(e){if(!a.W4.currentUser?.id||!e)throw Error("User not authenticated.");let t=a.W4.currentUser.id,r=(0,i.doc)(o.db,"users",t,"workoutSessions",e);try{let e=(0,i.collection)(r,"logs"),t=await (0,i.getDocs)(e),s=(0,i.writeBatch)(o.db);t.docs.forEach(e=>{s.delete(e.ref)}),s.delete(r),await s.commit(),console.log("Workout session and logs deleted successfully.")}catch(e){throw console.error("Error deleting workout session:",e),e}}async deleteWorkoutSummary(e){if(e&&a.W4.currentUser?.id)try{let t=(0,i.doc)(o.db,"users",a.W4.currentUser.id,"workoutSummary",e);await (0,i.deleteDoc)(t),console.log("Workout summary deleted successfully.")}catch(e){throw console.error("Error deleting workout summary:",e),e}}cleanUpWorkoutInProgress(){g.h.dispatch((0,p.gf)())}async fetchCurrentWorkoutSession(e){if(!e)throw Error("No user ID provided");let t=await (0,i.getDocs)((0,i.collection)(o.db,"exercises")),r=(await (0,i.getDocs)((0,i.collection)(o.db,"exerciseVideos"))).docs.map(e=>n.Ax.fromFirebase({id:e.id,...e.data()})),s=t.docs.map(e=>{let t=n.cd.fromFirebase({id:e.id,...e.data()}),s=r.filter(e=>e.exercise.toLowerCase()===t.name.toLowerCase());return new n.cd({...t,videos:s})}),a=(0,i.collection)(o.db,"users",e,"workoutSessions"),c=(0,i.query)(a,(0,i.where)("status","==",d.Z0.QueuedUp)),l=await (0,i.getDocs)(c);return l.empty&&(c=(0,i.query)(a,(0,i.where)("status","==",d.Z0.InProgress)),(l=await (0,i.getDocs)(c)).empty)?{workout:null,logs:null}:this.processWorkoutSessionDocument(l.docs[0],s)}async fetchAndMapExercisesWithVideos(){try{let e=(await (0,i.getDocs)((0,i.collection)(o.db,"exercises"))).docs.map(e=>n.cd.fromFirebase({id:e.id,...e.data()})),t=(await (0,i.getDocs)((0,i.collection)(o.db,"exerciseVideos"))).docs.map(e=>n.Ax.fromFirebase({id:e.id,...e.data()}));return e.map(e=>{let r=t.filter(t=>t.exercise.toLowerCase()===e.name.toLowerCase());return new n.cd({...e,videos:r})})}catch(e){throw console.error("Error fetching and mapping exercises with videos:",e),e}}async fetchAllWorkoutSessions(e){if(!e)throw Error("No user ID provided");try{let t=(await (0,i.getDocs)((0,i.collection)(o.db,"exercises"))).docs.map(e=>n.cd.fromFirebase({id:e.id,...e.data()})),r=(await (0,i.getDocs)((0,i.collection)(o.db,"exerciseVideos"))).docs.map(e=>n.Ax.fromFirebase({id:e.id,...e.data()})),s=t.map(e=>{let t=r.filter(t=>t.exercise.toLowerCase()===e.name.toLowerCase());return new n.cd({...e,videos:t})}),a=(0,i.collection)(o.db,"users",e,"workoutSessions"),c=await (0,i.getDocs)(a);if(c.empty)return console.log("No workout sessions found for user"),[];return await Promise.all(c.docs.map(async e=>{let t=await this.processWorkoutSessionDocument(e,s);return t.logs&&t.logs.sort((e,t)=>{let r=e.order??0,s=t.order??0;return r-s}),t}))}catch(e){throw console.error("Error fetching workout sessions:",e),e}}async updateCollection(e){try{let t=(0,i.collection)(o.db,"sweatlist-collection");if(!e.id||""===e.id.trim()){let r=(0,i.doc)(t);e.id=r.id}return e.challenge&&(e.challenge.id=e.id),e.updatedAt=new Date,await (0,i.setDoc)((0,i.doc)(t,e.id),e.toDictionary()),console.log("Collection updated successfully"),e}catch(e){throw console.error("Error updating collection document:",e),Error("Error while updating the collection")}}async processWorkoutSessionDocument(e,t){let r=e.data(),s=(r.exercises||[]).map(e=>{let r=e.exercise?.name?.toLowerCase().trim(),s=t.find(e=>e.name.toLowerCase().trim()===r);return{...e,exercise:s||e.exercise}}),o=new d.oQ({id:e.id,roundWorkoutId:r.roundWorkoutId||"",exercises:s,title:r.title||"",description:r.description||"",duration:r.duration||0,useAuthorContent:r.useAuthorContent||!1,isCompleted:r.isCompleted||!1,workoutStatus:r.workoutStatus||d.Z0.Archived,author:r.author||"",createdAt:(0,m.Q)(r.createdAt),updatedAt:(0,m.Q)(r.updatedAt),startTime:(0,m.Q)(r.startTime),collectionId:r.collectionId,challenge:r.challenge,logs:(r.logs||[]).map(e=>{let r=e.exercise?.name?.toLowerCase().trim(),s=t.find(e=>e.name.toLowerCase().trim()===r);return{...e,exercise:s||e.exercise}}),workoutRating:r.workoutRating,order:r.order,zone:r.zone||d.Bc.FullBody});console.log("The Workout ID is: "+o.id);let a=(0,i.collection)(e.ref,"logs"),c=(await (0,i.getDocs)(a)).docs.map(e=>{let r=e.data(),s=r.exercise?.name?.toLowerCase().trim(),i=t.find(e=>e.name.toLowerCase().trim()===s),a={...r,id:e.id,workoutId:o.id,exercise:i||r.exercise,createdAt:(0,m.Q)(r.createdAt),updatedAt:(0,m.Q)(r.updatedAt)};return new n.lg(a)});return{workout:o,logs:c}}async saveWorkoutSession({userId:e,workout:t,logs:r}){if(!e)throw Error("No user ID provided");try{let s=new Date,a=new d.oQ({...t,roundWorkoutId:`${t.id}-${s.getTime()}`,workoutStatus:d.Z0.QueuedUp,createdAt:s,updatedAt:s,startTime:s,logs:[]}),n=(0,i.doc)((0,i.collection)(o.db,"users",e,"workoutSessions"));await (0,i.setDoc)(n,a.toDictionary());let c=(0,i.collection)(n,"logs"),l=(0,i.writeBatch)(o.db);return r.forEach((e,t)=>{let r=(0,i.doc)(c,`${e.id}-${s.getTime()}`);l.set(r,{id:r.id,workoutId:n.id,exercise:e.exercise.toDictionary(),order:t,createdAt:s.getTime(),updatedAt:s.getTime(),logSubmitted:!1,isCompleted:!1})}),await l.commit(),a}catch(e){throw console.error("Error saving workout session:",e),e}}async joinChallenge({username:e,challengeId:t}){if(!a.W4.currentUser)throw Error("No user is signed in");let r=(0,i.collection)(o.db,"users"),s=(0,i.query)(r,(0,i.where)("username","==",e)),n=await (0,i.getDocs)(s);if(n.empty)throw Error("User not found");let c=n.docs[0],l=c.data(),d=c.id,u=(0,i.doc)(o.db,"sweatlist-collection",t),h=await (0,i.getDoc)(u);if(!h.exists())throw Error("Challenge not found");let m=h.data(),g=`${t}-${d}-${Date.now()}`,p={id:g,challenge:m,challengeId:t,userId:d,fcmToken:l.fcmToken||"",profileImage:l.profileImage||{},progress:0,completedWorkouts:[],isCompleted:!1,uid:d,location:l.location||null,city:"",country:"",timezone:"",username:e,joinDate:new Date,createdAt:new Date,updatedAt:new Date,pulsePoints:{baseCompletion:0,firstCompletion:0,streakBonus:0,checkInBonus:0,effortRating:0,chatParticipation:0,locationCheckin:0,contentEngagement:0,encouragementSent:0,encouragementReceived:0},currentStreak:0,encouragedUsers:[],encouragedByUsers:[],checkIns:[]};await (0,i.setDoc)((0,i.doc)(o.db,"user-challenge",g),p)}}let y=new w;s()}catch(e){s(e)}})},2069:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Bc:()=>a,Dj:()=>c,L$:()=>A,No:()=>w,P7:()=>p,Z0:()=>i,c_:()=>m,lM:()=>k,oQ:()=>g,tv:()=>v});var i,o,a,n,c,l=r(6738),d=r(3171),u=r(9284),h=e([l,u]);[l,u]=h.then?(await h)():h,function(e){e.QueuedUp="queuedUp",e.InProgress="inProgress",e.Complete="complete",e.Archived="archived"}(i||(i={})),function(e){e.TooHard="Too Hard",e.TooEasy="Too Easy",e.JustRight="Just Right"}(o||(o={})),function(e){e.LowerBody="Lower Body",e.UpperBody="Upper Body",e.FullBody="Full Body",e.Core="Core"}(a||(a={}));class m{constructor(e){this.reps=e.reps||0,this.weight=e.weight||0,this.leftReps=e.leftReps||0,this.leftWeight=e.leftWeight||0,this.isSplit=e.isSplit||!1,this.isBodyWeight=e.isBodyWeight||!1,this.duration=e.duration||0,this.calories=e.calories||0,this.bpm=e.bpm||0}static fromFirebase(e){return new m(e?{reps:e.reps||0,weight:e.weight||0,leftReps:e.leftReps||0,leftWeight:e.leftWeight||0,isSplit:e.isSplit||!1,isBodyWeight:e.isBodyWeight||!1,duration:e.duration||0,calories:e.calories||0,bpm:e.bpm||0}:{})}toDictionary(){return{reps:this.reps,weight:this.weight,leftReps:this.leftReps,leftWeight:this.leftWeight,isSplit:this.isSplit,isBodyWeight:this.isBodyWeight,duration:this.duration,calories:this.calories,bpm:this.bpm}}}class g{constructor(e){this.id=void 0!==e.id?e.id:"",this.roundWorkoutId=void 0!==e.roundWorkoutId?e.roundWorkoutId:"",this.title=void 0!==e.title?e.title:"",this.description=void 0!==e.description?e.description:"",this.duration=void 0!==e.duration?e.duration:0,this.useAuthorContent=void 0!==e.useAuthorContent&&e.useAuthorContent,this.isCompleted=void 0!==e.isCompleted&&e.isCompleted,this.workoutStatus=void 0!==e.workoutStatus?e.workoutStatus:"archived",this.workoutRating=void 0!==e.workoutRating?e.workoutRating:null,this.exercises=void 0!==e.exercises?e.exercises:[],this.challenge=void 0!==e.challenge?e.challenge:null,this.logs=void 0!==e.logs?e.logs:null,this.collectionId=void 0!==e.collectionId?e.collectionId:null,this.startTime=e.startTime&&e.startTime instanceof Date?e.startTime:null,this.assignedDate=e.assignedDate&&e.assignedDate instanceof Date?e.assignedDate:null,this.createdAt=e.createdAt&&e.createdAt instanceof Date?e.createdAt:new Date,this.updatedAt=e.updatedAt&&e.updatedAt instanceof Date?e.updatedAt:new Date,this.order=void 0!==e.order?e.order:null,e.author?.username?(this.author=e.author.userId,u.G.revertAuthorFormat(this.id,this.author)):this.author=e.author,this.zone=void 0!==e.zone?e.zone:"Full Body"}get isTimedWorkout(){return!!this.logs&&this.logs.some(e=>"weightTraining"===e.exercise.category.type?e.exercise.category.details?.screenTime!==0:"cardio"===e.exercise.category.type&&e.exercise.category.details?.screenTime!==0)}fetchPrimaryBodyParts(){return this.exercises.flatMap(e=>e.exercise.primaryBodyParts)}fetchSecondaryBodyParts(){return this.exercises.flatMap(e=>e.exercise.secondaryBodyParts)}static estimatedDuration(e){let t=0,r=0,s=!1;for(let i of e){let e=i.exercise;if(console.groupCollapsed(`Exercise: ${e}`),"cardio"===e.category.type){let r=e.category.details?.duration||0;console.log("Cardio duration (minutes):",r),t+=r}else if("weightTraining"===e.category.type){let i=e.category.details?.screenTime||0;i>0?(console.log("Screen time (seconds):",i),console.log("Converted to minutes:",Math.floor(i/60)),t+=Math.floor(i/60),s=!0):(console.log("Using default timing (8m exercise + 1m rest)"),t+=8,r+=1)}console.log("Current totals:",{totalExerciseTime:t,restTime:r,hasScreenTimeExercises:s}),console.groupEnd()}s||(console.log("Adding warmup/cool-down:",10,"minutes"),t+=10);let i=t+r;console.log("Pre-rounded total:",i);let o=i;return s||(o=5*Math.round(i/5),console.log("Rounded to nearest 5 minutes:",o)),console.log("Final estimated duration:",o,"minutes"),o}static determineWorkoutZone(e){let t=new Set;for(let r of e)for(let e of r.exercise.primaryBodyParts||[r.exercise.primaryBodyParts])t.add(e);let r=new Set([l.mn.Chest,l.mn.Shoulders,l.mn.Biceps,l.mn.Triceps,l.mn.Traps,l.mn.Lats,l.mn.Forearms]),s=new Set([l.mn.Hamstrings,l.mn.Glutes,l.mn.Quadriceps,l.mn.Calves]),i=new Set([l.mn.Abs,l.mn.Lowerback]),o=(e,t)=>Array.from(e).some(e=>t.has(e)),a=o(t,r),n=o(t,s),c=o(t,i);return a&&n&&c||a&&n?"Full Body":a&&c||a?"Upper Body":n&&c||n?"Lower Body":c?"Core":"Full Body"}findUndefinedValues(e,t=""){let r=[];return function e(t,s){if(void 0===t){r.push(s);return}if(null!==t&&"object"==typeof t){if(Array.isArray(t)){t.forEach((t,r)=>{e(t,`${s}[${r}]`)});return}Object.entries(t).forEach(([t,i])=>{let o=s?`${s}.${t}`:t;void 0===i?r.push(o):e(i,o)})}}(e,t),r}checkForUndefined(e,t="Data"){let r=this.findUndefinedValues(e);return!(r.length>0)||(console.error(` Found undefined values in ${t}:`),r.forEach(e=>{console.error(`  - ${e}`)}),!1)}toDictionary(){let e={id:this.id,exercises:this.exercises.map(e=>({exercise:e.exercise.toDictionary(),groupId:e.groupId})),logs:this.logs?this.logs.map(e=>e.toDictionary()):[],title:this.title,description:this.description,zone:this.zone,duration:this.duration,workoutRating:this.workoutRating,useAuthorContent:this.useAuthorContent,isCompleted:this.isCompleted,workoutStatus:this.workoutStatus,author:this.author,createdAt:this.createdAt.getTime(),updatedAt:this.updatedAt.getTime(),assignedDate:this.assignedDate?this.assignedDate.getTime():null,startTime:this.startTime?this.startTime.getTime():null,order:this.order||null,collectionId:this.collectionId||null,challenge:this.challenge||null};if(!this.checkForUndefined(e,"Workout Dictionary"))throw Error("Workout contains undefined values");return e}}class p{constructor(e){this.id=e.id,this.workoutId=e.workoutId,this.exercises=e.exercises.map(e=>l.lg.fromFirebase(e)),this.bodyParts=e.bodyParts,this.secondaryBodyParts=e.secondaryBodyParts,this.workoutTitle=e.workoutTitle,this.caloriesBurned=e.caloriesBurned,this.workoutRating=e.workoutRating,this.exercisesCompleted=e.exercisesCompleted.map(e=>l.lg.fromFirebase(e)),this.aiInsight=e.aiInsight,this.recommendations=e.recommendations,this.gifURLs=e.gifURLs,this.recommendedWork=e.recommendedWork,this.isCompleted=e.isCompleted,this.createdAt=e.createdAt?new Date(e.createdAt):new Date,this.updatedAt=e.updatedAt?new Date(e.updatedAt):new Date,this.completedAt=e.completedAt?new Date(e.completedAt):null,this.duration=e.duration}static fromFirebase(e){return new p({id:e.id||"",workoutId:e.workoutId||"",exercises:e.exercises||[],bodyParts:e.bodyParts||[],secondaryBodyParts:e.secondaryBodyParts||[],workoutTitle:e.workoutTitle||"",caloriesBurned:e.caloriesBurned||0,workoutRating:e.workoutRating,exercisesCompleted:e.exercisesCompleted||[],aiInsight:e.aiInsight||"",recommendations:e.recommendations||[],gifURLs:e.gifURLs||[],recommendedWork:e.recommendedWork,isCompleted:e.isCompleted||!1,createdAt:e.createdAt,updatedAt:e.updatedAt,completedAt:e.completedAt,duration:e.duration||""})}}!function(e){e.Together="together",e.Solo="solo",e.Locked="locked"}(n||(n={}));class f{constructor(e){this.originalHostId=e.originalHostId||"",this.sharedBy=e.sharedBy||""}toDictionary(){return{originalHostId:this.originalHostId,sharedBy:this.sharedBy}}static fromFirestore(e){return new f(e)}}class w{constructor(e){this.id=e.id,this.title=e.title||"",this.subtitle=e.subtitle||"",this.pin=e.pin||null,this.challenge=e.challenge?new v(e.challenge):void 0,this.sweatlistIds=(e.sweatlistIds||[]).map(e=>({id:e.id||"",sweatlistAuthorId:e.sweatlistAuthorId||"",sweatlistName:e.sweatlistName||"",order:e.order||0})),Array.isArray(e.ownerId)?this.ownerId=e.ownerId:e.ownerId?this.ownerId=[e.ownerId]:this.ownerId=[],this.privacy=this.challenge?"together":"solo",this.participants=(e.participants||[]).map(e=>e||""),this.createdAt=(0,d.Q)(e.createdAt),this.updatedAt=(0,d.Q)(e.updatedAt)}static fromFirestore(e){return new w(e)}toDictionary(){return{id:this.id,title:this.title,subtitle:this.subtitle,pin:this.pin,challenge:this.challenge?this.challenge.toDictionary():null,sweatlistIds:this.sweatlistIds.map(e=>({id:e.id,sweatlistAuthorId:e.sweatlistAuthorId,order:e.order})),ownerId:this.ownerId,privacy:this.privacy,createdAt:this.createdAt.getTime(),updatedAt:this.updatedAt.getTime()}}toRESTDictionary(){return{fields:{id:{stringValue:this.id},title:{stringValue:this.title},subtitle:{stringValue:this.subtitle},pin:{stringValue:this.pin},ownerId:{arrayValue:{values:this.ownerId.map(e=>({stringValue:e}))}},sweatlistIds:{arrayValue:{values:this.sweatlistIds.map(e=>({mapValue:{fields:{id:{stringValue:e.id},sweatlistAuthorId:{stringValue:e.sweatlistAuthorId},order:{integerValue:e.order}}}}))}},createdAt:{doubleValue:this.createdAt.getTime()},updatedAt:{doubleValue:this.updatedAt.getTime()}}}}isPublished(){return!!this.challenge&&"published"===this.challenge.status}}class y{constructor(e){this.profileImageURL=e.profileImageURL||"",this.thumbnailURL=e.thumbnailURL||""}toDictionary(){return{profileImageURL:this.profileImageURL,thumbnailURL:this.thumbnailURL||null}}static fromFirestore(e){return new y(e)}}class x{constructor(e){this.latitude=e.latitude||0,this.longitude=e.longitude||0}toDictionary(){return{latitude:this.latitude,longitude:this.longitude}}static fromFirestore(e){return new x(e)}}class b{constructor(e){this.baseCompletion=e.baseCompletion??0,this.firstCompletion=e.firstCompletion??0,this.streakBonus=e.streakBonus??0,this.checkInBonus=e.checkInBonus??0,this.effortRating=e.effortRating??0,this.chatParticipation=e.chatParticipation??0,this.locationCheckin=e.locationCheckin??0,this.contentEngagement=e.contentEngagement??0,this.encouragementSent=e.encouragementSent??0,this.encouragementReceived=e.encouragementReceived??0,this.cumulativeStreakBonus=e.cumulativeStreakBonus??0}get totalStackPoints(){return this.baseCompletion+this.firstCompletion+this.streakBonus+this.checkInBonus+this.effortRating}get totalCommunityPoints(){return this.chatParticipation+this.locationCheckin+this.contentEngagement+this.encouragementSent+this.encouragementReceived}get totalPoints(){return this.totalStackPoints+this.totalCommunityPoints+this.cumulativeStreakBonus}toDictionary(){return{baseCompletion:this.baseCompletion,firstCompletion:this.firstCompletion,streakBonus:this.streakBonus,checkInBonus:this.checkInBonus,effortRating:this.effortRating,chatParticipation:this.chatParticipation,locationCheckin:this.locationCheckin,contentEngagement:this.contentEngagement,encouragementSent:this.encouragementSent,encouragementReceived:this.encouragementReceived,cumulativeStreakBonus:this.cumulativeStreakBonus,totalStackPoints:this.totalStackPoints,totalCommunityPoints:this.totalCommunityPoints,totalPoints:this.totalPoints}}static fromFirestore(e){return new b(e)}}class k{constructor(e,t){this.id=e,this.challenge=t.challenge?new v(t.challenge):void 0,this.challengeId=t.challengeId||"",this.userId=t.userId||"",this.username=t.username||"",this.profileImage=t.profileImage?new y(t.profileImage):void 0,this.progress=t.progress??0,this.referralChains=new f(t.referralChains?t.referralChains:{originalHostId:"",sharedBy:""}),this.completedWorkouts=Array.isArray(t.completedWorkouts)?t.completedWorkouts.map(e=>({id:e.id||"",workoutId:e.workoutId||"",completedAt:(0,d.Q)(e.completedAt)})):[],this.isCompleted=t.isCompleted??!1,this.location=t.location?new x(t.location):void 0,this.city=t.city||"",this.country=t.country||"",this.timezone=t.timezone||"",this.joinDate=(0,d.Q)(t.joinDate),this.createdAt=(0,d.Q)(t.createdAt),this.updatedAt=(0,d.Q)(t.updatedAt),this.pulsePoints=new b(t.pulsePoints?t.pulsePoints:{}),this.currentStreak=t.currentStreak??0,this.encouragedUsers=Array.isArray(t.encouragedUsers)?t.encouragedUsers:[],this.encouragedByUsers=Array.isArray(t.encouragedByUsers)?t.encouragedByUsers:[],this.checkIns=Array.isArray(t.checkIns)?t.checkIns.map(e=>(0,d.Q)(e)):[]}static fromFirestore(e,t){return new k(e,t)}toDictionary(){return{challenge:this.challenge?this.challenge.toDictionary():null,challengeId:this.challengeId,userId:this.userId,username:this.username,profileImage:this.profileImage?this.profileImage.toDictionary():null,progress:this.progress,referralChains:this.referralChains?this.referralChains.toDictionary():{},completedWorkouts:this.completedWorkouts.map(e=>({...e,completedAt:Math.floor(new Date(e.completedAt).getTime()/1e3)})),isCompleted:this.isCompleted,location:this.location?this.location.toDictionary():null,city:this.city,country:this.country,timezone:this.timezone,joinDate:Math.floor(this.joinDate.getTime()/1e3),createdAt:Math.floor(this.createdAt.getTime()/1e3),updatedAt:Math.floor(this.updatedAt.getTime()/1e3),pulsePoints:this.pulsePoints?this.pulsePoints.toDictionary():{},currentStreak:this.currentStreak,encouragedUsers:this.encouragedUsers,encouragedByUsers:this.encouragedByUsers,checkIns:this.checkIns.map(e=>Math.floor(e.getTime()/1e3))}}}!function(e){e.Draft="draft",e.Published="published",e.Completed="completed",e.Cancelled="cancelled"}(c||(c={}));class A{constructor(e){this.id=e.id,this.userId=e.userId,this.videoUrl=e.videoUrl}toDictionary(){return{id:this.id,userId:this.userId,videoUrl:this.videoUrl}}}class v{constructor(e){this.id=e.id,this.title=e.title,this.subtitle=e.subtitle,this.participants=Array.isArray(e.participants)?e.participants:[],this.status=e.status,this.startDate=(0,d.Q)(e.startDate),this.endDate=(0,d.Q)(e.endDate),this.createdAt=(0,d.Q)(e.createdAt),this.updatedAt=(0,d.Q)(e.updatedAt),Array.isArray(e.introVideos)?this.introVideos=e.introVideos.map(e=>new A(e)):e.introVideoURL&&Array.isArray(e.participants)&&e.participants.length>0?this.introVideos=[new A({id:"1",userId:e.participants[0].userId,videoUrl:e.introVideoURL})]:this.introVideos=[],this.durationInDays=this.calculateDurationInDays()}toDictionary(){return{id:this.id,title:this.title,subtitle:this.subtitle,participants:this.participants.map(e=>({id:e.id,challengeId:e.challengeId,userId:e.userId,username:e.username,profileImage:e.profileImage,progress:e.progress,completedWorkouts:e.completedWorkouts,isCompleted:e.isCompleted,location:e.location,city:e.city,country:e.country,timezone:e.timezone,joinDate:e.joinDate,createdAt:e.createdAt,updatedAt:e.updatedAt,pulsePoints:e.pulsePoints,currentStreak:e.currentStreak,encouragedUsers:e.encouragedUsers,encouragedByUsers:e.encouragedByUsers,checkIns:e.checkIns})),status:this.status,startDate:this.startDate.getTime(),endDate:this.endDate.getTime(),createdAt:this.createdAt.getTime(),updatedAt:this.updatedAt.getTime(),durationInDays:this.durationInDays,introVideos:this.introVideos.map(e=>e.toDictionary())}}calculateDurationInDays(){let e=this.startDate?.valueOf(),t=this.endDate?.valueOf();if(!e||!t||isNaN(e)||isNaN(t))throw Error("Invalid startDate or endDate");return Math.ceil((t-e)/864e5)}static toFirestoreObject(e){if(null===e||"object"!=typeof e||e instanceof Date)return e;if(Array.isArray(e))return e.map(e=>this.toFirestoreObject(e));if(e instanceof v)return{id:e.id,title:e.title,subtitle:e.subtitle,participants:e.participants,status:e.status,startDate:e.startDate,endDate:e.endDate,createdAt:e.createdAt,updatedAt:e.updatedAt,introVideos:e.introVideos.map(e=>({id:e.id,userId:e.userId,videoUrl:e.videoUrl}))};let t={};for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=this.toFirestoreObject(e[r]));return t}}s()}catch(e){s(e)}})},130:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>m});var i=r(997),o=r(6689),a=r(1163),n=r(3291),c=r(401),l=r(4484),d=r(8157),u=r(9238),h=e([n,c,l,d,u]);[n,c,l,d,u]=h.then?(await h)():h;let m=({children:e})=>{let t=(0,n.useDispatch)(),r=(0,c.getAuth)(),[s,h]=(0,o.useState)(!1),m=(0,a.useRouter)(),g=(0,n.useSelector)(e=>e.user.currentUser),p=(0,n.useSelector)(e=>e.user.loading),f=["/about","/creator","/rounds","/privacyPolicy","/starter-pack","/stacks","/moves","/terms"].map(e=>e?.toLowerCase()),w=["/round-invitation","/profile","/challenge"].map(e=>e.toLowerCase()),y=e=>{let t=e.toLowerCase();return!!f.includes(t)||w.some(e=>t.startsWith(e))};(0,o.useEffect)(()=>{try{t((0,l.K4)(!0));let e=(0,c.onAuthStateChanged)(r,async e=>{try{if(e){let r=await d.W4.fetchUserFromFirestore(e.uid);t((0,l.av)(r)),d.W4.currentUser=r}else{t((0,l.av)(null)),d.W4.currentUser=null;let e=y(m.pathname);h(!e)}}catch(e){console.error("Auth state change error:",e),t((0,l.av)(null))}finally{t((0,l.K4)(!1))}});return()=>e()}catch(e){console.error("Auth wrapper error:",e),t((0,l.K4)(!1))}},[t,r,m.pathname]);let x=e=>{},b=e=>{console.error("Sign in error:",e)};return p?i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-zinc-900"})}):(0,i.jsxs)(i.Fragment,{children:[e,(!g||!g.username)&&!y(m.pathname)&&i.jsx(u.Z,{isVisible:!0,closable:!1,onSignInSuccess:x,onSignInError:b,onSignUpSuccess:x,onSignUpError:b})]})};s()}catch(e){s(e)}})},9238:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>p});var i=r(997),o=r(6689),a=r(401),n=r(1304),c=r(8154),l=r(8157),d=r(5796),u=r(9777),h=r(1163),m=r(7440),g=e([a,l,d,u,m]);[a,l,d,u,m]=g.then?(await g)():g;let p=({isVisible:e,closable:t=!1,onClose:r,onSignInSuccess:s,onSignInError:g,onSignUpSuccess:p,onSignUpError:f,onQuizComplete:w,onQuizSkipped:y,onRegistrationComplete:x})=>{let[b,k]=(0,o.useState)(""),[A,v]=(0,o.useState)(""),[I,U]=(0,o.useState)(""),[D,E]=(0,o.useState)(""),[W,N]=(0,o.useState)(null),[C,j]=(0,o.useState)(!1),[S,F]=(0,o.useState)("initial"),[P,B]=(0,o.useState)({}),[L,T]=(0,o.useState)(!1),[R,z]=(0,o.useState)(!1),[V,G]=(0,o.useState)(!1),[$,Q]=(0,o.useState)(null),[M,q]=(0,o.useState)(null),[O,H]=(0,o.useState)(!1),_=/[A-Z]/.test(A),Z=/\d/.test(A),K=A.length>=8,Y=A===I,[J,X]=(0,o.useState)(0),[ee,et]=(0,o.useState)({gender:null,height:{feet:0,inches:0},weight:0,gymExperience:null,fitnessGoals:[],birthdate:null}),er=async e=>{try{let t=await fetch("https://fitwithpulse.ai/api/stripe-sync",{method:"GET",headers:{"Content-Type":"application/json"}});if(t.ok){let{subscriptionType:r}=await t.json();e.subscription=r,await l.W4.updateUser(e.uid,e)}}catch(e){console.error("Error syncing subscription:",e)}let t=await l.W4.fetchUserFromFirestore(e.uid);t?.username&&("Unsubscribed"===e.subscription||e.subscription===(l.Qe&&l.Qe.unsubscribed)?es.push("/subscribe"):(s?.(e),r?.()))},es=(0,h.useRouter)(),ei=async e=>{try{if(G(!0),Q(null),q(e),"apple"===e){let e=new a.OAuthProvider("apple.com");e.addScope("email"),e.addScope("name");try{let t=(await (0,a.signInWithPopup)(u.I,e)).user,r=await l.W4.fetchUserFromFirestore(t.uid);r||(r=new l.n5({id:t.uid,email:t.email||"",displayName:t.displayName||""}),await l.W4.updateUser(t.uid,r)),l.W4.currentUser=r,await er(t)}catch(e){if(console.error("Apple sign-in error:",e),e instanceof Error)Q(e.message),C?f?.(e):g?.(e);else{let e=Error("An unknown error occurred during Apple sign-in");Q(e.message),C?f?.(e):g?.(e)}}}else if("google"===e){let e=await d.Z.signInWithGoogle(),t=e.user;e.user.metadata.creationTime,e.user.metadata.lastSignInTime;let r=await l.W4.fetchUserFromFirestore(t.uid);if(r||((r=new l.n5({})).id=t.uid,r.email=t.email||"",r.displayName=t.displayName||"",await l.W4.updateUser(t.uid,r)),console.log("The User is: ",r),l.W4.currentUser=r,console.log("Username is empty?: ",""==r.username),""==r.username){console.log("Starting registraiton"),j(!0),F("profile");return}console.log("Checking Subs"),await er(t)}}catch(r){console.error(`${e} sign-in error:`,r);let t="An unexpected error occurred";if(r instanceof Error){switch(r.code){case"auth/popup-blocked":t="Please enable popups for this site and try again";break;case"auth/popup-closed-by-user":t="Sign-in cancelled. Please try again";break;case"auth/cancelled-popup-request":t="Another sign-in attempt is already in progress";break;case"auth/account-exists-with-different-credential":t="An account already exists with the same email address but different sign-in credentials. Please sign in using the original account method.";break;case"auth/network-request-failed":t="Network error. Please check your internet connection and try again";break;case"auth/user-disabled":t="This account has been disabled. Please contact support";break;case"auth/operation-not-allowed":t="This sign-in method is not enabled. Please contact support";break;default:t=r.message}Q(t),C?f?.(r):g?.(r)}else{Q(t);let e=Error(t);C?f?.(e):g?.(e)}}finally{G(!1),q(null)}},eo=e=>{let t=JSON.parse(localStorage.getItem("authFlowLogs")||"[]");t.push(`[${new Date().toISOString()}] ${e}`),localStorage.setItem("authFlowLogs",JSON.stringify(t))};(0,o.useEffect)(()=>{let t=localStorage.getItem("authFlowLogs");t&&(console.log("Auth Flow Logs:"),console.log("------------------------"),JSON.parse(t).forEach(e=>console.log(e)),console.log("------------------------"),localStorage.removeItem("authFlowLogs"));let i=!0;return(async()=>{if(eo("Starting redirect handler"),!e){eo("Modal not visible, skipping redirect handling");return}let t=new URLSearchParams(window.location.search).has("state")||window.location.href.includes("__/auth/handler");if(eo(`Redirect detected: ${t}`),eo(`Current URL: ${window.location.href}`),!t){eo("No redirect parameters detected, exiting redirect handler");return}try{G(!0),eo("Calling getRedirectResult...");let e=await (0,a.getRedirectResult)(u.I);if(eo(`getRedirectResult result: ${JSON.stringify(e)}`),!e){eo("No result returned by getRedirectResult, checking pending redirect...");let e=await (0,a.getRedirectResult)(u.I).catch(e=>(eo(`Pending redirect error: ${e.message}`),null));if(eo(`Pending redirect result: ${JSON.stringify(e)}`),!e){eo("No pending redirect result, exiting handler");return}}if(!i){eo("Component unmounted during redirect, exiting handler");return}if(!e||!e.user)throw Error("No user credential found in redirect result");let{user:t}=e;eo(`User info: providerId=${e.providerId}, email=${t.email}, isNewUser=${t.metadata.creationTime===t.metadata.lastSignInTime}`),"apple.com"===e.providerId||t.providerData.some(e=>"apple.com"===e.providerId);let o=await l.W4.fetchUserFromFirestore(t.uid);o||t.metadata.creationTime!==t.metadata.lastSignInTime||(eo("New user detected, creating Firestore document"),o=new l.n5({id:t.uid,email:t.email||"",displayName:t.displayName||""}),await l.W4.updateUser(t.uid,o)),i&&(l.W4.currentUser=o,t.metadata.creationTime===t.metadata.lastSignInTime?p?.(t):s?.(t),r?.(),eo("User processed successfully"))}catch(e){if(eo(`Redirect handler error: ${e instanceof Error?e.message:e}`),!i)return;Q(e instanceof Error?e.message:"Authentication failed"),C?f?.(e):g?.(e)}finally{i&&(G(!1),eo("Redirect handler complete"))}})(),()=>{i=!1}},[e,s,p,g,f,r]);let ea=async e=>{if(e.preventDefault(),C)switch(S){case"initial":eh()&&(F("password"),T(!1));break;case"password":em()&&(F("profile"),T(!1));break;case"profile":if(eg())try{G(!0),Q(null),l.W4.currentUser&&(l.W4.currentUser.username=D,await l.W4.updateUser(l.W4.currentUser.id,l.W4.currentUser),x?.()),F("quiz-prompt")}catch(e){console.error("Error during profile update:",e),Q(e.message)}finally{G(!1)}}else try{G(!0),Q(null);let e=await d.Z.signInWithEmail(b,A);console.log("Sign-in successful:",e.user);let t=await l.W4.fetchUserFromFirestore(e.user.uid);l.W4.currentUser=t,await er(e.user),r?.()}catch(e){console.error("Error during sign-in:",e),Q(e.message),g?.(e)}finally{G(!1)}},en=async()=>{try{if(G(!0),Q(null),!u.I.currentUser?.uid)throw Error("No user found");l.W4.currentUser,w?.(),es.push("/")}catch(e){console.error("Error updating user data:",e),Q(e.message)}finally{G(!1)}},ec=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"text-center mb-8",children:[i.jsx("h2",{className:"text-2xl font-bold text-white font-['Thunder'] mb-2",children:"One Last Thing!"}),i.jsx("p",{className:"text-zinc-400 font-['HK Grotesk'] text-sm px-4",children:"Take our quick fitness quiz to help Pulse AI create more accurate workout and fitness creator recommendations."})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[i.jsx("button",{onClick:()=>F("quiz"),className:"w-full bg-[#E0FE10] text-black font-semibold py-3 px-4 rounded-lg hover:bg-[#c8e60e] transition-colors font-['HK Grotesk']",children:"Take the Quiz"}),i.jsx("button",{onClick:()=>y?.(),className:"w-full bg-zinc-800 text-white font-semibold py-3 px-4 rounded-lg hover:bg-zinc-700 transition-colors font-['HK Grotesk']",children:"Skip for Now"})]})]}),el=[(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"text-center",children:[i.jsx("h2",{className:"text-2xl font-bold text-white font-['Thunder'] mb-2",children:"How do you identify?"}),i.jsx("p",{className:"text-zinc-400 font-['HK Grotesk'] text-sm",children:"This helps when giving fitness recommendations and calculating metrics."})]}),i.jsx("div",{className:"space-y-3",children:["Man","Woman","I'd rather self describe"].map(e=>i.jsx("button",{onClick:async()=>{let t;switch(e){case"Man":t=l.Y0.Man;break;case"Woman":t=l.Y0.Woman;break;default:t=l.Y0.SelfDescribe}if(et({...ee,gender:e}),u.I.currentUser?.uid&&l.W4.currentUser){let e=l.W4.currentUser;e.gender=t,e.updatedAt=new Date,await l.W4.updateUser(u.I.currentUser.uid,e)}X(J+1)},className:`w-full p-4 rounded-lg border ${ee.gender===e?"border-[#E0FE10] bg-[#E0FE10]/10":"border-zinc-700 hover:border-[#E0FE10]"} text-left text-white transition-colors`,children:e},e))})]},"gender"),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"text-center",children:[i.jsx("h2",{className:"text-2xl font-bold text-white font-['Thunder'] mb-2",children:"What is your height?"}),i.jsx("p",{className:"text-zinc-400 font-['HK Grotesk'] text-sm",children:"Height helps recommendations and calculating metrics."})]}),(0,i.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,i.jsxs)("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Feet"}),i.jsx("input",{type:"number",value:ee.height.feet||"",onChange:async e=>{let t=Number(e.target.value),r={...ee.height,feet:t};if(et({...ee,height:r}),u.I.currentUser?.uid&&l.W4.currentUser){let e=new l.n5({...l.W4.currentUser.toDictionary(),height:r,updatedAt:new Date});await l.W4.updateUser(u.I.currentUser.uid,e)}},min:"0",max:"8",className:"w-full bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white placeholder-zinc-400 focus:outline-none focus:border-[#E0FE10] focus:ring-1 focus:ring-[#E0FE10] transition-colors",placeholder:"0"})]}),(0,i.jsxs)("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Inches"}),i.jsx("input",{type:"number",value:ee.height.inches||"",onChange:async e=>{let t=Number(e.target.value),r={...ee.height,inches:t};if(et({...ee,height:r}),u.I.currentUser?.uid&&l.W4.currentUser){let e=new l.n5({...l.W4.currentUser.toDictionary(),height:r,updatedAt:new Date});await l.W4.updateUser(u.I.currentUser.uid,e)}},min:"0",max:"11",className:"w-full bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white placeholder-zinc-400 focus:outline-none focus:border-[#E0FE10] focus:ring-1 focus:ring-[#E0FE10] transition-colors",placeholder:"0"})]})]}),(ee.height.feet>8||ee.height.inches>11)&&i.jsx("p",{className:"text-red-400 text-sm mt-2",children:"Please enter a valid height"})]},"height"),(0,i.jsxs)("div",{className:"space-y-6",children:[i.jsx("div",{className:"text-center",children:i.jsx("h2",{className:"text-2xl font-bold text-white font-['Thunder'] mb-2",children:"What's your current weight?"})}),(0,i.jsxs)("div",{className:"flex gap-4",children:[i.jsx("input",{type:"number",value:ee.weight||"",onChange:async e=>{let t=Number(e.target.value);if(et({...ee,weight:t}),u.I.currentUser?.uid&&l.W4.currentUser){let e=new l.Um({oldWeight:l.W4.currentUser.bodyWeight.length>0?l.W4.currentUser.bodyWeight[l.W4.currentUser.bodyWeight.length-1].newWeight:0,newWeight:t}),r=new l.n5({...l.W4.currentUser.toDictionary(),bodyWeight:[...l.W4.currentUser.bodyWeight,e],updatedAt:new Date});await l.W4.updateUser(u.I.currentUser.uid,r)}},className:"w-full bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white",placeholder:"Enter weight in lbs",min:"0"}),i.jsx("span",{className:"flex items-center text-zinc-400",children:"Lbs"})]})]},"weight"),(0,i.jsxs)("div",{className:"space-y-6",children:[i.jsx("div",{className:"text-center",children:i.jsx("h2",{className:"text-2xl font-bold text-white font-['Thunder'] mb-2",children:"How well do you know your way around the gym?"})}),i.jsx("div",{className:"space-y-3",children:["Novice","Intermediate","Expert"].map(e=>i.jsx("button",{onClick:async()=>{let t={Novice:l.aZ.Novice,Intermediate:l.aZ.Intermediate,Expert:l.aZ.Expert};if(et({...ee,gymExperience:e}),u.I.currentUser?.uid&&l.W4.currentUser){let r=new l.n5({...l.W4.currentUser.toDictionary(),level:t[e],updatedAt:new Date});await l.W4.updateUser(u.I.currentUser.uid,r),X(J+1)}},className:`w-full p-4 rounded-lg border ${ee.gymExperience===e?"border-[#E0FE10] bg-[#E0FE10]/10":"border-zinc-700 hover:border-[#E0FE10]"} text-left text-white transition-colors`,children:e},e))})]},"experience"),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"text-center",children:[i.jsx("h2",{className:"text-2xl font-bold text-white font-['Thunder'] mb-2",children:"What is your fitness goal?"}),i.jsx("p",{className:"text-zinc-400 font-['HK Grotesk'] text-sm",children:"Select all that apply"})]}),i.jsx("div",{className:"space-y-3",children:["Lose weight","Gain muscle mass","Tone up","General Fitness"].map(e=>(0,i.jsxs)("button",{type:"button",onClick:async()=>{let t={"Lose weight":l.o5.LoseWeight,"Gain muscle mass":l.o5.GainWeight,"Tone up":l.o5.ToneUp,"General Fitness":l.o5.GeneralFitness},r=ee.fitnessGoals.includes(e)?ee.fitnessGoals.filter(t=>t!==e):[...ee.fitnessGoals,e];if(et(e=>({...e,fitnessGoals:r})),u.I.currentUser?.uid&&l.W4.currentUser){let e=new l.n5({...l.W4.currentUser.toDictionary(),goal:r.map(e=>t[e]),updatedAt:new Date});await l.W4.updateUser(u.I.currentUser.uid,e),r.length>0&&X(J+1)}},className:`w-full p-4 rounded-lg border ${ee.fitnessGoals.includes(e)?"border-[#E0FE10] bg-[#E0FE10]/10":"border-zinc-700 hover:border-[#E0FE10]"} text-left text-white transition-colors relative`,children:[i.jsx("span",{children:e}),ee.fitnessGoals.includes(e)&&i.jsx("svg",{className:"w-5 h-5 absolute right-4 top-1/2 transform -translate-y-1/2 text-[#E0FE10]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},e))})]},"goals"),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"text-center",children:[i.jsx("h2",{className:"text-2xl font-bold text-white font-['Thunder'] mb-2",children:"When is your birthdate?"}),i.jsx("p",{className:"text-zinc-400 font-['HK Grotesk'] text-sm",children:"We ask for your age to ensure accurate fitness calculations."})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[i.jsx("select",{className:"bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white",onChange:e=>{let t=new Date(ee.birthdate||new Date);if(t.setMonth(parseInt(e.target.value)),et({...ee,birthdate:t}),u.I.currentUser?.uid&&l.W4.currentUser){let e=new l.n5({...l.W4.currentUser.toDictionary(),birthdate:t,updatedAt:new Date});l.W4.updateUser(u.I.currentUser.uid,e)}},children:Array.from({length:12},(e,t)=>i.jsx("option",{value:t,children:new Date(0,t).toLocaleString("default",{month:"long"})},t))}),i.jsx("select",{className:"bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white",onChange:e=>{let t=new Date(ee.birthdate||new Date);t.setDate(parseInt(e.target.value)),et({...ee,birthdate:t})},children:Array.from({length:31},(e,t)=>i.jsx("option",{value:t+1,children:t+1},t+1))}),i.jsx("select",{className:"bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white",onChange:e=>{let t=new Date(ee.birthdate||new Date);t.setFullYear(parseInt(e.target.value)),et({...ee,birthdate:t})},children:Array.from({length:100},(e,t)=>{let r=new Date().getFullYear()-t;return i.jsx("option",{value:r,children:r},r)})})]})]},"birthdate")],ed=()=>el[J],eu=()=>J===el.length-1,eh=()=>b?!!/\S+@\S+\.\S+/.test(b)||(B({email:"Please enter a valid email address"}),T(!0),!1):(B({email:"Email is required"}),T(!0),!1),em=()=>!!_&&!!Z&&!!K&&!!Y||(T(!0),!1),eg=()=>D?R:(B({username:"Username is required"}),T(!0),!1),ep=e=>{E(e),z(/^[a-zA-Z0-9_]{3,}$/.test(e))},ef=async e=>{let t=e.target.files?.[0];if(t)try{H(!0),N(t);let e=await m.kf.uploadImage(t,m.$5.Profile);console.log("Profile image uploaded successfully",e)}catch(e){console.error("Profile image upload failed",e),Q("Failed to upload profile image"),N(null)}finally{H(!1)}},ew=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"text-center mb-8",children:[i.jsx("h2",{className:"text-2xl font-bold text-white font-['Thunder'] mb-2",children:"Personalize your experience"}),i.jsx("p",{className:"text-zinc-400 font-['HK Grotesk'] text-sm",children:"Set a username and profile image"})]}),(0,i.jsxs)("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex justify-center",children:(0,i.jsxs)("div",{className:"relative",children:[i.jsx("div",{className:"w-24 h-24 bg-zinc-800 rounded-full flex items-center justify-center overflow-hidden",children:W?i.jsx("img",{src:URL.createObjectURL(W),alt:"Profile Preview",className:"w-full h-full object-cover"}):i.jsx(n.Z,{size:32,className:"text-zinc-500"})}),(0,i.jsxs)("label",{className:"absolute bottom-0 right-0 w-8 h-8 bg-[#E0FE10] rounded-full flex items-center justify-center cursor-pointer",children:[i.jsx(n.Z,{size:16,className:"text-black"}),i.jsx("input",{type:"file",accept:"image/*",onChange:ef,className:"hidden"})]}),O&&i.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:i.jsx("div",{className:"loader border-t-transparent border-4 border-white rounded-full w-8 h-8 animate-spin"})})]})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[i.jsx("label",{className:"block text-sm font-medium text-zinc-300 mb-2 font-['HK Grotesk']",children:"Username"}),D&&i.jsx("span",{className:`text-xs ${R?"text-[#E0FE10]":"text-red-400"}`,children:R?"username is available":"username is not available"})]}),i.jsx("input",{type:"text",value:D,onChange:e=>ep(e.target.value),className:`w-full bg-zinc-800 border rounded-lg p-3 text-white placeholder-zinc-400 focus:outline-none focus:border-[#E0FE10] focus:ring-1 focus:ring-[#E0FE10] transition-colors ${P.username?"border-red-500":"border-zinc-600"}`,placeholder:"Choose a username"})]})]})]}),ey=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"text-center mb-8",children:[i.jsx("h2",{className:"text-2xl font-bold text-white font-['Thunder'] mb-2",children:"Create password"}),i.jsx("p",{className:"text-zinc-400 font-['HK Grotesk'] text-sm",children:"Set a password for your account"})]}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-zinc-300 mb-2 font-['HK Grotesk']",children:"Password"}),i.jsx("input",{type:"password",value:A,onChange:e=>{v(e.target.value),T(!1)},className:"w-full bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white placeholder-zinc-400 focus:outline-none focus:border-[#E0FE10] focus:ring-1 focus:ring-[#E0FE10] transition-colors",placeholder:"Create password"})]}),(0,i.jsxs)("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-zinc-300 mb-2 font-['HK Grotesk']",children:"Confirm Password"}),i.jsx("input",{type:"password",value:I,onChange:e=>{U(e.target.value),T(!1)},className:"w-full bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white placeholder-zinc-400 focus:outline-none focus:border-[#E0FE10] focus:ring-1 focus:ring-[#E0FE10] transition-colors",placeholder:"Confirm password"})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center ${_?"bg-[#E0FE10]":"bg-zinc-700"}`,children:_&&i.jsx("svg",{className:"w-3 h-3 text-black",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),i.jsx("span",{className:`text-sm ${_?"text-[#E0FE10]":"text-zinc-400"}`,children:"1 uppercase"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center ${Z?"bg-[#E0FE10]":"bg-zinc-700"}`,children:Z&&i.jsx("svg",{className:"w-3 h-3 text-black",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),i.jsx("span",{className:`text-sm ${Z?"text-[#E0FE10]":"text-zinc-400"}`,children:"1 number"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center ${K?"bg-[#E0FE10]":"bg-zinc-700"}`,children:K&&i.jsx("svg",{className:"w-3 h-3 text-black",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),i.jsx("span",{className:`text-sm ${K?"text-[#E0FE10]":"text-zinc-400"}`,children:"8 characters"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center ${Y&&A?"bg-[#E0FE10]":"bg-zinc-700"}`,children:Y&&A&&i.jsx("svg",{className:"w-3 h-3 text-black",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),i.jsx("span",{className:`text-sm ${Y&&A?"text-[#E0FE10]":"text-zinc-400"}`,children:"Passwords match"})]})]})]})]}),ex=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"text-center mb-8 pt-4 sm:pt-0",children:[i.jsx("img",{src:"/pulse-logo-white.svg",alt:"Pulse Logo",className:"h-8 mx-auto mb-8"}),i.jsx("h2",{className:"text-2xl font-bold text-white font-['Thunder'] mb-2",children:C?"Join the Collective":"Welcome Back!"}),i.jsx("p",{className:"text-zinc-400 font-['HK Grotesk'] text-sm",children:"Beat Your Best, Share Your Victory"})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-4 mb-8",children:[i.jsx("button",{type:"button",onClick:()=>{q("apple"),ei("apple")},disabled:V&&"apple"===M,className:`w-full bg-black text-white font-semibold py-3 px-4 rounded-lg transition-colors font-['HK Grotesk'] border border-zinc-700 flex items-center justify-center gap-3 ${V&&"apple"===M?"opacity-50 cursor-not-allowed":"hover:bg-zinc-800"}`,children:V&&"apple"===M?i.jsx("div",{className:"loader border-t-transparent border-4 border-white rounded-full w-5 h-5 animate-spin"}):(0,i.jsxs)(i.Fragment,{children:[i.jsx("img",{src:"/apple-logo.svg",alt:"Apple",className:"w-5 h-5"}),C?"Sign up with Apple":"Sign in with Apple"]})}),i.jsx("button",{type:"button",onClick:()=>ei("google"),disabled:V,className:`w-full bg-white text-black font-semibold py-3 px-4 rounded-lg hover:bg-gray-100 transition-colors font-['HK Grotesk'] flex items-center justify-center gap-3 ${V?"cursor-not-allowed opacity-50":""}`,children:V&&"google"===M?i.jsx("div",{className:"loader border-t-transparent border-4 border-black rounded-full w-5 h-5 animate-spin"}):(0,i.jsxs)(i.Fragment,{children:[i.jsx("img",{src:"/google-logo.svg",alt:"Google",className:"w-5 h-5"}),C?"Sign up with Google":"Sign in with Google"]})}),i.jsx("div",{className:"relative",children:i.jsx("div",{className:"absolute inset-0 flex items-center",children:i.jsx("div",{className:"w-full border-t border-zinc-700"})})})]}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-zinc-300 mb-2 font-['HK Grotesk']",children:"Email"}),i.jsx("input",{type:"email",value:b,onChange:e=>{k(e.target.value),T(!1)},className:`w-full bg-zinc-800 border rounded-lg p-3 text-white placeholder-zinc-400 focus:outline-none focus:border-[#E0FE10] focus:ring-1 focus:ring-[#E0FE10] transition-colors ${P.email?"border-red-500":"border-zinc-600"}`,placeholder:"Enter your email"}),L&&P.email&&i.jsx("div",{className:"text-red-400 text-sm mt-2",children:P.email})]}),!C&&(0,i.jsxs)("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-zinc-300 mb-2 font-['HK Grotesk']",children:"Password"}),i.jsx("input",{type:"password",value:A,onChange:e=>{v(e.target.value),T(!1)},className:"w-full bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white placeholder-zinc-400 focus:outline-none focus:border-[#E0FE10] focus:ring-1 focus:ring-[#E0FE10] transition-colors",placeholder:"Enter your password"})]})]})]});return i.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black z-50 sm:p-6",children:(0,i.jsxs)("div",{className:"bg-zinc-900 w-full h-full sm:h-auto sm:w-[480px] sm:rounded-xl p-6 sm:p-8 border-none sm:border sm:border-zinc-700 shadow-xl overflow-y-auto",children:[t&&r&&i.jsx("button",{onClick:r,className:"absolute top-4 right-4 text-zinc-400 hover:text-white transition-colors","aria-label":"Close modal",children:i.jsx(c.Z,{size:24})}),(0,i.jsxs)("form",{onSubmit:ea,className:"space-y-6",children:[$&&i.jsx("div",{className:"bg-red-500 text-white text-sm font-semibold p-3 rounded-lg",children:$}),(()=>{if(C)switch(S){case"password":return ey();case"profile":return ew();case"quiz-prompt":return ec();case"quiz":return ed()}return ex()})(),"quiz-prompt"!==S&&"quiz"!==S&&i.jsx("div",{className:"flex flex-col gap-4 mt-8",children:i.jsx("button",{type:"submit",className:"w-full bg-[#E0FE10] text-black font-semibold py-3 px-4 rounded-lg hover:bg-[#c8e60e] transition-colors font-['HK Grotesk']",children:C?"profile"===S?"Complete":"password"===S?"Continue":"Continue with Email":"Sign In"})})]}),"quiz"!==S?null:(0,i.jsxs)("div",{className:"mt-8 flex gap-4",children:[J>0&&i.jsx("button",{type:"button",onClick:()=>X(J-1),className:"flex-1 bg-zinc-800 text-white font-semibold py-3 px-4 rounded-lg hover:bg-zinc-700 transition-colors font-['HK Grotesk']",children:"Back"}),i.jsx("button",{type:"button",onClick:()=>{eu()?en():X(J+1)},disabled:!(()=>{switch(J){case 0:return!!ee.gender;case 1:return ee.height.feet>0&&ee.height.feet<=8&&ee.height.inches>=0&&ee.height.inches<=11;case 2:return ee.weight>0;case 3:return!!ee.gymExperience;case 4:return ee.fitnessGoals.length>0;case 5:return!!ee.birthdate;default:return!1}})(),className:"flex-1 bg-[#E0FE10] text-black font-semibold py-3 px-4 rounded-lg hover:bg-[#c8e60e] transition-colors font-['HK Grotesk'] disabled:opacity-50 disabled:cursor-not-allowed",children:eu()?"Complete quiz":"Next"})]}),"initial"===S&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"mt-6 text-center",children:[!C&&i.jsx("a",{href:"#",className:"text-zinc-400 hover:text-[#E0FE10] text-sm transition-colors mb-2 block",children:"Forgot your password?"}),(0,i.jsxs)("p",{className:"text-zinc-500 text-sm font-['HK Grotesk']",children:[C?"Already have an account? ":"Don't have an account? ",i.jsx("button",{onClick:()=>{j(!C),F("initial"),B({}),T(!1),v(""),U(""),E(""),N(null)},className:"text-[#E0FE10] hover:text-[#c8e60e]",children:C?"Sign In":"Sign Up"})]})]}),(0,i.jsxs)("div",{className:"mt-8 pt-6 border-t border-zinc-700",children:[i.jsx("p",{className:"text-zinc-400 text-xs text-center font-['HK Grotesk'] px-4",children:"Join the Fitness Collective: Create, Share, and Progress Together"}),i.jsx(i.Fragment,{children:(0,i.jsxs)("div",{className:"mt-8 pt-6 border-t border-zinc-700",children:[(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4 text-zinc-400 text-sm mb-6",children:[i.jsx("a",{href:"/about",className:"hover:text-[#E0FE10] transition-colors",target:"_blank",rel:"noopener noreferrer",children:"About Pulse"}),i.jsx("div",{className:"hidden sm:block w-1 h-1 bg-zinc-700 rounded-full"}),i.jsx("a",{href:"/creator",className:"hover:text-[#E0FE10] transition-colors",target:"_blank",rel:"noopener noreferrer",children:"Creator Program"}),i.jsx("div",{className:"hidden sm:block w-1 h-1 bg-zinc-700 rounded-full"}),i.jsx("a",{href:"/rounds",className:"hover:text-[#E0FE10] transition-colors",target:"_blank",rel:"noopener noreferrer",children:"Rounds Feature"})]}),(0,i.jsxs)("div",{className:"flex flex-wrap justify-center items-center gap-4 text-zinc-500 text-xs mb-6",children:[i.jsx("a",{href:"/terms",className:"hover:text-[#E0FE10] transition-colors",target:"_blank",rel:"noopener noreferrer",children:"Terms & Conditions"}),i.jsx("div",{className:"hidden sm:block w-1 h-1 bg-zinc-700 rounded-full"}),i.jsx("a",{href:"/privacyPolicy",className:"hover:text-[#E0FE10] transition-colors",target:"_blank",rel:"noopener noreferrer",children:"Privacy Policy"}),i.jsx("div",{className:"hidden sm:block w-1 h-1 bg-zinc-700 rounded-full"}),i.jsx("button",{onClick:()=>window.location.href="mailto:pulsefitnessapp@gmail.com",className:"hover:text-[#E0FE10] transition-colors",children:"Contact Us"})]}),(0,i.jsxs)("div",{className:"flex justify-center gap-6 mb-6",children:[i.jsx("a",{href:"https://www.instagram.com/fitwithpulse/",target:"_blank",rel:"noopener noreferrer",className:"text-zinc-400 hover:text-[#E0FE10] transition-colors",children:i.jsx("img",{src:"/instagram.svg",alt:"Instagram",className:"w-5 h-5"})}),i.jsx("a",{href:"https://twitter.com/fitwithpulse",target:"_blank",rel:"noopener noreferrer",className:"text-zinc-400 hover:text-[#E0FE10] transition-colors",children:i.jsx("img",{src:"/twitter.svg",alt:"Twitter",className:"w-5 h-5"})}),i.jsx("a",{href:"https://www.youtube.com/@fitwithpulse",target:"_blank",rel:"noopener noreferrer",className:"text-zinc-400 hover:text-[#E0FE10] transition-colors",children:i.jsx("img",{src:"/youtube.svg",alt:"Youtube",className:"w-5 h-5"})})]}),(0,i.jsxs)("div",{className:"text-center text-zinc-500 text-xs",children:["\xa9 ",new Date().getFullYear()," Pulse. All rights reserved."]})]})})]})]})]})})};s()}catch(e){s(e)}})},3893:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>l});var i=r(997);r(6689);var o=r(3291),a=r(1912);r(7491),r(2636),r(1856);var n=r(130),c=e([o,a,n]);[o,a,n]=c.then?(await c)():c;let l=({Component:e,pageProps:t})=>i.jsx(o.Provider,{store:a.h,children:i.jsx(n.Z,{children:i.jsx(e,{...t})})});s()}catch(e){s(e)}})},1912:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{h:()=>c});var i=r(3258),o=r(4484),a=r(1308),n=e([i,o,a]);[i,o,a]=n.then?(await n)():n;let c=(0,i.configureStore)({reducer:{user:o.ZP,workout:a.ZP}});s()}catch(e){s(e)}})},4484:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{K4:()=>c,ZP:()=>l,av:()=>n});var i=r(3258),o=e([i]);i=(o.then?(await o)():o)[0];let a=(0,i.createSlice)({name:"user",initialState:{currentUser:null,loading:!0},reducers:{setUser:(e,t)=>{e.currentUser=t.payload,e.loading=!1},setLoading:(e,t)=>{e.loading=t.payload}}}),{setUser:n,setLoading:c}=a.actions,l=a.reducer;s()}catch(e){s(e)}})},1308:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{HX:()=>c,QU:()=>l,ZP:()=>u,gf:()=>d,q1:()=>n});var i=r(3258),o=e([i]);i=(o.then?(await o)():o)[0];let a=(0,i.createSlice)({name:"workout",initialState:{currentWorkout:null,currentExerciseLogs:[],workoutSummary:null},reducers:{setCurrentWorkout:(e,t)=>{e.currentWorkout=t.payload},setCurrentExerciseLogs:(e,t)=>{e.currentExerciseLogs=t.payload},setWorkoutSummary:(e,t)=>{e.workoutSummary=t.payload},resetWorkoutState:e=>{e.currentWorkout=null,e.currentExerciseLogs=[],e.workoutSummary=null}}}),{setCurrentWorkout:n,setCurrentExerciseLogs:c,setWorkoutSummary:l,resetWorkoutState:d}=a.actions,u=a.reducer;s()}catch(e){s(e)}})},3171:(e,t,r)=>{"use strict";r.d(t,{Q:()=>s});let s=e=>{if(null==e)return new Date;if(e instanceof Date)return e;let t="string"==typeof e?parseInt(e,10):e;return new Date(t<1e10?1e3*t:t)}},2286:(e,t,r)=>{"use strict";r.d(t,{C9:()=>s});let s=e=>e?e._seconds?new Date(1e3*e._seconds).toISOString():e.seconds?new Date(1e3*e.seconds).toISOString():e.toDate&&"function"==typeof e.toDate?e.toDate().toISOString():e instanceof Date?e.toISOString():null:null},7491:()=>{},2636:()=>{},1856:()=>{}};
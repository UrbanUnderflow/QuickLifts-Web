"use strict";(()=>{var e={};e.id=377,e.ids=[377,888,660],e.modules={1323:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,l){return l in t?t[l]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,l)):"function"==typeof t&&"default"===l?t:void 0}}})},6428:(e,t,l)=>{l.a(e,async(e,n)=>{try{l.r(t),l.d(t,{config:()=>m,default:()=>u,getServerSideProps:()=>x,getStaticPaths:()=>p,getStaticProps:()=>h,reportWebVitals:()=>g,routeModule:()=>v,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>b,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>f});var i=l(7093),a=l(5244),s=l(1323),r=l(1070),o=l(3893),c=l(6122),d=e([o]);o=(d.then?(await d)():d)[0];let u=(0,s.l)(c,"default"),h=(0,s.l)(c,"getStaticProps"),p=(0,s.l)(c,"getStaticPaths"),x=(0,s.l)(c,"getServerSideProps"),m=(0,s.l)(c,"config"),g=(0,s.l)(c,"reportWebVitals"),f=(0,s.l)(c,"unstable_getStaticProps"),y=(0,s.l)(c,"unstable_getStaticPaths"),j=(0,s.l)(c,"unstable_getStaticParams"),w=(0,s.l)(c,"unstable_getServerProps"),b=(0,s.l)(c,"unstable_getServerSideProps"),v=new i.PagesRouteModule({definition:{kind:a.x.PAGES,page:"/round-invitation/[id]",pathname:"/round-invitation/[id]",bundlePath:"",filename:""},components:{App:o.default,Document:r.default},userland:c});n()}catch(e){n(e)}})},8088:(e,t,l)=>{l.d(t,{Z:()=>n});let n=(0,l(1462).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},7218:(e,t,l)=>{l.d(t,{Z:()=>n});let n=(0,l(1462).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},4954:(e,t,l)=>{l.d(t,{Z:()=>n});let n=(0,l(1462).Z)("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]])},358:(e,t,l)=>{l.d(t,{Z:()=>n});let n=(0,l(1462).Z)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]])},718:(e,t,l)=>{l.d(t,{Z:()=>n});let n=(0,l(1462).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},7963:(e,t,l)=>{l.d(t,{Z:()=>n});let n=(0,l(1462).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},1070:(e,t,l)=>{l.r(t),l.d(t,{default:()=>r});var n=l(997),i=l(6859),a=l.n(i);class s extends a(){static async getInitialProps(e){return{...await a().getInitialProps(e)}}render(){return(0,n.jsxs)(i.Html,{lang:"en",children:[n.jsx(i.Head,{}),(0,n.jsxs)("body",{children:[n.jsx(i.Main,{}),n.jsx(i.NextScript,{})]})]})}}let r=s},6122:(e,t,l)=>{l.r(t),l.d(t,{default:()=>I,getServerSideProps:()=>A});var n=l(997),i=l(6689),a=l(1163),s=l(1462);let r=(0,s.Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);var o=l(7963),c=l(8088),d=l(7218),u=l(4954);let h=(0,s.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var p=l(718),x=l(358);let m=(0,s.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),g=({challenge:e})=>{let[t,l]=(0,i.useState)(!1),a=[{title:"Download Pulse",description:"Get the Pulse app from the App Store to join this challenge",icon:n.jsx(h,{className:"w-8 h-8 text-[#E0FE10]"})},{title:"Create Account",description:"Sign up for an account to start your fitness journey",icon:n.jsx(p.Z,{className:"w-8 h-8 text-[#E0FE10]"})},{title:"Return Here",description:"Come back to this page and tap 'Join Challenge' to get started",icon:n.jsx(x.Z,{className:"w-8 h-8 text-[#E0FE10]"})}],s=encodeURIComponent(`https://www.quickliftsapp.com/?linkType=round&roundId=${e.id}`),r=`https://quicklifts.page.link/?link=${s}&apn=com.pulse.fitnessapp&ibi=Tremaine.QuickLifts&isi=6451497729`,o=`https://fitwithpulse.ai/round/${e.id};`;return t?n.jsx("div",{className:"fixed inset-0 bg-zinc-950 z-50 overflow-y-auto",children:n.jsx("div",{className:"min-h-screen px-4 text-center",children:n.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen",children:(0,n.jsxs)("div",{className:"bg-zinc-900 p-6 rounded-2xl max-w-md w-full mx-auto",children:[(0,n.jsxs)("h2",{className:"text-2xl font-bold text-white mb-8",children:["Join ",e.title]}),n.jsx("div",{className:"space-y-8",children:a.map((e,t)=>(0,n.jsxs)("div",{className:"flex items-start space-x-4",children:[n.jsx("div",{className:"flex-shrink-0",children:e.icon}),(0,n.jsxs)("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-semibold text-white",children:e.title}),n.jsx("p",{className:"text-zinc-400 mt-1",children:e.description})]}),t<a.length-1&&n.jsx(m,{className:"w-5 h-5 text-zinc-600 transform rotate-90 mt-2"})]},t))}),(0,n.jsxs)("div",{className:"mt-8 space-y-4",children:[n.jsx("a",{href:"https://apps.apple.com/ca/app/pulse-community-workouts/id6451497729",className:"w-full flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-xl text-black bg-[#E0FE10] hover:bg-[#E0FE10]/90",children:"Download iOS App"}),n.jsx("button",{onClick:()=>{window.location.href=r},className:"w-full px-8 py-3 text-base font-medium rounded-xl text-white bg-zinc-800 hover:bg-zinc-700",children:"I already have the iOS app"}),n.jsx("button",{onClick:()=>{window.location.href=o},className:"w-full px-8 py-3 text-base font-medium rounded-xl text-white bg-zinc-800 hover:bg-zinc-700",children:"I'm on a laptop or Android Device"})]})]})})})}):n.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-zinc-950 border-t border-zinc-800",children:n.jsx("button",{onClick:()=>{l(!0)},className:"w-full flex items-center justify-center px-8 py-4 text-lg font-medium rounded-xl text-black bg-[#E0FE10] hover:bg-[#E0FE10]/90",children:"Join Round"})})},f=e=>("string"==typeof e?new Date(e):e).toLocaleDateString("en-US",{month:"long",day:"numeric"}),y=(e,t)=>{let l="string"==typeof e?new Date(e):e;return Math.ceil(Math.abs(("string"==typeof t?new Date(t):t).getTime()-l.getTime())/864e5)},j=({title:e,value:t,icon:l})=>n.jsx("div",{className:"flex-1 p-4 bg-zinc-900 rounded-xl",children:(0,n.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[l,(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[n.jsx("span",{className:"text-lg font-semibold text-white",children:t}),n.jsx("span",{className:"text-sm text-white/70",children:e})]})]})}),w=({introVideos:e})=>{let[t,l]=(0,i.useState)(""),[a,s]=(0,i.useState)(!1),o=(0,i.useRef)(null);(0,i.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("id");e&&l(e)},[]);let c=e?.find(e=>e.userId===t)?.videoUrl;return((0,i.useEffect)(()=>{let e=async()=>{if(o.current)try{await o.current.play(),s(!0)}catch(e){console.error("Autoplay failed:",e)}};c&&e()},[c]),c)?(0,n.jsxs)("div",{className:"relative bg-black rounded-xl h-48 mb-8 overflow-hidden",children:[n.jsx("video",{ref:o,className:"w-full h-full object-cover",src:c,controls:a,playsInline:!0,autoPlay:!0,muted:!0}),!a&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 cursor-pointer",onClick:()=>{o.current?.play(),s(!0)},children:n.jsx(r,{className:"w-8 h-8 text-white/90"})})]}):n.jsx("div",{className:"relative bg-black rounded-xl h-48 mb-8 flex items-center justify-center",children:n.jsx(r,{className:"w-8 h-8 text-white/90"})})},b=({userId:e})=>{let t=(0,a.useRouter)(),[l,s]=(0,i.useState)({});return((0,i.useEffect)(()=>{let t=async()=>{try{let t=await fetch(`https://fitwithpulse.ai/.netlify/functions/get-user-by-id?id=${e}`),l=await t.json();console.log("API Response:",l),l.success&&s({username:l.user.username,profileImage:l.user.profileImage})}catch(e){console.error("Error fetching host data:",e)}};e&&t()},[e]),l.username)?n.jsx("div",{className:"flex items-center justify-center gap-3 mb-8 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>t.push(`/profile/${l.username}`),role:"button","aria-label":`View ${l.username}'s profile`,children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[l.profileImage?.profileImageURL?n.jsx("img",{src:l.profileImage.profileImageURL,alt:l.username,className:"w-10 h-10 rounded-full object-cover"}):n.jsx("div",{className:"w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center",children:n.jsx(o.Z,{className:"w-6 h-6 text-zinc-400"})}),(0,n.jsxs)("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-sm text-white/70",children:"Hosted by"}),n.jsx("span",{className:"font-medium",children:l.username})]})]})}):null},v=({challenge:e})=>{let t=new Date(e.startDate),l=new Date(e.endDate),[a,s]=(0,i.useState)(""),r=e.participants?.length??0;return(0,i.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("id");e&&s(e)},[]),n.jsx("div",{className:"min-h-screen bg-zinc-950 text-white",children:(0,n.jsxs)("div",{className:"max-w-2xl mx-auto px-6 py-8",children:[(0,n.jsxs)("div",{className:"text-center space-y-4 mb-8",children:[n.jsx("h2",{className:"text-lg font-semibold text-white/90",children:"You're invited to participate in this Round \uD83C\uDF89"}),n.jsx("h1",{className:"text-3xl font-bold",children:e.title}),n.jsx("p",{className:"text-white/70",children:e.subtitle})]}),a&&n.jsx(b,{userId:a}),n.jsx(w,{introVideos:e.introVideos}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-12",children:[n.jsx(j,{title:"Duration",value:`${y(t,l)} Days`,icon:n.jsx(c.Z,{className:"w-6 h-6 text-[#E0FE10]"})}),n.jsx(j,{title:"Start Date",value:f(t),icon:n.jsx(d.Z,{className:"w-6 h-6 text-[#E0FE10]"})}),n.jsx(j,{title:"End Date",value:f(l),icon:n.jsx(u.Z,{className:"w-6 h-6 text-[#E0FE10]"})}),n.jsx(j,{title:"Participants",value:r,icon:n.jsx(o.Z,{className:"w-6 h-6 text-[#E0FE10]"})})]}),n.jsx(g,{challenge:e})]})})};var S=l(968),N=l.n(S);let P=({challenge:e,id:t})=>{let l=new Date(e.startDate).toLocaleDateString("en-US",{month:"long",day:"numeric"}),i=new Date(e.endDate).toLocaleDateString("en-US",{month:"long",day:"numeric"}),a=`${e.subtitle} • ${l} - ${i} • Join the challenge now!`,s=`pulse://rounds?linkType=round&roundId=${t}`;return(0,n.jsxs)(N(),{children:[n.jsx("title",{children:`Join ${e.title} | Pulse`}),n.jsx("meta",{name:"description",content:a}),n.jsx("meta",{property:"og:title",content:"The Next Round Awaits | Pulse"}),n.jsx("meta",{property:"og:description",content:`${e.title}`}),n.jsx("meta",{property:"og:type",content:"website"}),n.jsx("meta",{property:"og:url",content:`https://fitwithpulse.ai/challenge/${t}`}),n.jsx("meta",{property:"og:site_name",content:"Pulse Fitness"}),n.jsx("meta",{property:"og:image",content:"https://fitwithpulse.ai/round-preview.png"}),n.jsx("meta",{property:"og:image:width",content:"1200"}),n.jsx("meta",{property:"og:image:height",content:"630"}),n.jsx("meta",{property:"al:ios:app_store_id",content:"6451497729"}),n.jsx("meta",{property:"al:ios:app_name",content:"Pulse: Community Workouts"}),n.jsx("meta",{property:"al:ios:url",content:s}),n.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),n.jsx("meta",{name:"twitter:title",content:`Join ${e.title} | Pulse`}),n.jsx("meta",{name:"twitter:description",content:a}),n.jsx("meta",{name:"twitter:image",content:"https://fitwithpulse.ai/round-preview.png"}),n.jsx("link",{rel:"canonical",href:`https://fitwithpulse.ai/challenge/${t}`})]})};var E=l(2069);let k=()=>n.jsx("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:n.jsx("div",{className:"text-white",children:"Loading challenge..."})}),D=({message:e})=>n.jsx("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-white text-center",children:[n.jsx("h2",{className:"text-xl font-bold mb-4",children:"Unable to load challenge"}),n.jsx("p",{className:"text-white/70",children:e}),n.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-[#E0FE10] text-black rounded-lg",children:"Try Again"})]})}),A=async({params:e,res:t})=>{try{console.log("getServerSideProps starting",e);let l=e?.id;if(!l)return{props:{initialError:"Challenge ID is required"}};t.setHeader("Cache-Control","public, s-maxage=10, stale-while-revalidate=59");let n=await fetch(`https://fitwithpulse.ai/.netlify/functions/get-challenge-by-id?id=${l}`);if(!n.ok)throw Error("Failed to fetch challenge");let i=await n.json();if(console.log("SSR Raw Response:",{introVideoURL:i.collection.introVideoURL,ownerId:i.collection.ownerId,rawData:JSON.stringify(i.collection,null,2)}),!i.success||!i.collection)return{props:{initialError:"Challenge not found"}};return console.log(i),{props:{initialCollection:{...i.collection,createdAt:new Date(i.collection.createdAt).toISOString(),updatedAt:new Date(i.collection.updatedAt).toISOString(),pin:i.collection.pin??null,challenge:{id:i.collection.challenge.id,title:i.collection.challenge.title,subtitle:i.collection.challenge.subtitle,introVideos:i.collection.challenge.introVideos||[],...i.collection.challenge.introVideoURL&&{introVideoURL:i.collection.challenge.introVideoURL},status:i.collection.challenge.status||"draft",startDate:new Date(i.collection.challenge.startDate).toISOString(),endDate:new Date(i.collection.challenge.endDate).toISOString(),createdAt:new Date(i.collection.challenge.createdAt).toISOString(),updatedAt:new Date(i.collection.challenge.updatedAt).toISOString(),participants:i.collection.challenge.participants||[]}}}}}catch(e){return console.error("Error fetching challenge:",e),{props:{initialError:"Failed to load challenge"}}}},R=({expectedPIN:e,onSuccess:t,onError:l})=>{let[a,s]=(0,i.useState)(Array(6).fill("")),[r,o]=(0,i.useState)(!1),[c,d]=(0,i.useState)(!1),u=(0,i.useRef)(Array(6).fill(null)),h=(e,t)=>{if(!/^\d*$/.test(t))return;let l=[...a];l[e]=t,s(l),t&&e<8&&u.current[e+1]?.focus(),d(l.every(e=>""!==e)),o(!1)},p=(e,t)=>{"Backspace"===t.key&&!a[e]&&e>0&&u.current[e-1]?.focus()};return n.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-zinc-950 p-4",children:(0,n.jsxs)("div",{className:"w-full max-w-md",children:[n.jsx("h2",{className:"text-2xl font-bold text-white text-center mb-8",children:"Enter Round PIN"}),(0,n.jsxs)("div",{className:"mb-8",children:[n.jsx("div",{className:"flex justify-center gap-2 mb-4",children:a.map((e,t)=>n.jsx("input",{ref:e=>{u.current&&(u.current[t]=e)},inputMode:"numeric",pattern:"[0-9]*",maxLength:1,value:e,onChange:e=>h(t,e.target.value),onKeyDown:e=>p(t,e),className:`
                  w-10 h-12 
                  text-center text-xl font-bold
                  bg-zinc-900 
                  border-2 ${r?"border-red-500":"border-[#E0FE10]"}
                  text-white 
                  rounded-lg 
                  focus:outline-none 
                  focus:border-[#E0FE10] 
                  transition-colors
                `},t))}),r&&n.jsx("p",{className:"text-red-500 text-center text-sm mt-2",children:"Incorrect PIN. Please try again."})]}),c&&n.jsx("button",{onClick:()=>{a.join("")===e?t():(o(!0),l("Incorrect PIN. Please try again."),s(Array(6).fill("")),u.current[0]?.focus(),d(!1))},className:"w-full py-3 bg-[#E0FE10] text-black rounded-lg font-bold  hover:bg-opacity-90 transition-opacity",children:"Enter"})]})})},I=({initialCollection:e,initialError:t})=>{console.log("Component rendering",{initialCollection:e,initialError:t}),console.log("Challenge Page Render - Collection Data:",{hasPin:!!e?.pin,pin:e?.pin,fullCollection:e});let l=(0,a.useRouter)(),{id:s}=l.query,[r,o]=(0,i.useState)(e||null),[c,d]=(0,i.useState)(!e),[u,h]=(0,i.useState)(t||null),[p,x]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{console.log("useEffect triggered",{id:s,initialCollection:e});let t=async()=>{if(s&&!e)try{let e=`https://fitwithpulse.ai/.netlify/functions/get-challenge-by-id?id=${s}`,t=await fetch(e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!t.ok){let e=await t.text();throw console.error("Error response:",e),Error(`HTTP error! status: ${t.status}`)}let l=await t.json();if(console.log("SSR Response Data:",{pin:l.collection.pin,fullData:l.collection}),console.log("Client - Raw API Response:",JSON.stringify(l,null,2)),console.log("Client - Collection introVideoURL:",l.collection.introVideoURL),console.log("Client - Collection ownerId:",l.collection.ownerId),!l.success)throw Error(l.error||"Failed to fetch challenge");if(!l.collection||!l.collection.challenge)throw Error("Invalid challenge data received");let n={...l.collection,createdAt:new Date(l.collection.createdAt),updatedAt:new Date(l.collection.updatedAt),pin:l.collection.pin,challenge:new E.tv({id:l.collection.challenge.id,title:l.collection.challenge.title,subtitle:l.collection.challenge.subtitle,introVideos:l.collection.challenge.introVideos,introVideoURL:l.collection.challenge.introVideoURL,status:l.collection.challenge.status||"draft",startDate:new Date(l.collection.challenge.startDate),endDate:new Date(l.collection.challenge.endDate),createdAt:new Date(l.collection.challenge.createdAt),updatedAt:new Date(l.collection.challenge.updatedAt),participants:l.collection.challenge.participants||[]})};o(n)}catch(e){console.error("Error details:",e),h(e instanceof Error?e.message:"An error occurred while loading the challenge")}finally{d(!1)}};l.isReady&&s&&t()},[s,l.isReady,e]),!l.isReady||c)?n.jsx(k,{}):u?n.jsx(D,{message:u}):r&&r.challenge?r.pin&&!p?n.jsx(R,{expectedPIN:r.pin,onSuccess:()=>x(!0),onError:e=>h(e)}):(0,n.jsxs)(n.Fragment,{children:[n.jsx(P,{challenge:r.challenge,id:s}),n.jsx(v,{challenge:r.challenge,onClose:()=>{l.push("/")},onJoinChallenge:async e=>{try{await new Promise(e=>setTimeout(e,1e3)),l.push("/")}catch(e){console.error("Error joining challenge:",e),h("Failed to join challenge. Please try again.")}}})]}):n.jsx(D,{message:"Challenge not found"})}},5244:(e,t)=>{var l;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return l}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(l||(l={}))},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")},3258:e=>{e.exports=import("@reduxjs/toolkit")},3745:e=>{e.exports=import("firebase/app")},401:e=>{e.exports=import("firebase/auth")},1492:e=>{e.exports=import("firebase/firestore")},3392:e=>{e.exports=import("firebase/storage")},3291:e=>{e.exports=import("react-redux")}};var t=require("../../webpack-runtime.js");t.C(e);var l=e=>t(t.s=e),n=t.X(0,[567,565,859,893],()=>l(6428));module.exports=n})();
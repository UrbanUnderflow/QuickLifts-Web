"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8071:function(e,s,t){t.d(s,{f:function(){return r}});var l=t(5893);t(7294);let r=e=>{let{gifUrl:s,alt:t,frameSize:r,contentMode:i="cover",className:a="",onClick:n}=e,c=r?{width:`${r.width}px`,height:`${r.height}px`}:{};return(0,l.jsx)("div",{className:`relative overflow-hidden rounded-full cursor-pointer ${a}`,style:c,onClick:n,children:(0,l.jsx)("img",{src:s,alt:t,className:`w-full h-full object-${i}`,loading:"lazy"})})}},359:function(e,s,t){t.d(s,{kg:function(){return b},ox:function(){return j}});var l=t(5893),r=t(7294),i=t(5432),a=t(2171),n=t(8267),c=t(39),o=t(4307),d=t(3050),x=t(2066),u=t(4454),m=t(8071);let h=e=>{let{month:s,day:t,weekday:r}=e;return(0,l.jsxs)("div",{className:"flex flex-col items-center bg-zinc-800 rounded p-2 text-xs",children:[(0,l.jsx)("span",{className:"text-gray-400",children:s}),(0,l.jsx)("span",{className:"text-white font-bold text-lg",children:t}),(0,l.jsx)("span",{className:"text-gray-400",children:r})]})},g=e=>{let{icon:s,value:t,label:r}=e;return(0,l.jsxs)("div",{className:"flex items-center gap-1 text-gray-400",children:[s,(0,l.jsxs)("span",{className:"text-sm",children:[t," ",r]})]})},f=e=>{let{selectedOrder:s,maxOrder:t,workoutDate:r,showCalendar:n,onUpdateOrder:c,onCalendarTap:o}=e;return(0,l.jsxs)("div",{className:"flex flex-col justify-between py-2 px-4 bg-zinc-800",children:[(0,l.jsx)("button",{onClick:()=>c(s-1),disabled:s<=0,className:`p-2 ${s>0?"text-green-500 hover:text-green-400":"text-gray-600"}`,children:(0,l.jsx)(i.Z,{size:16})}),n&&r&&(0,l.jsx)("button",{onClick:()=>o?.(r),className:"my-2",children:(0,l.jsx)(h,{month:(0,x.WU)(r,"MMM").toUpperCase(),day:(0,x.WU)(r,"d"),weekday:(0,x.WU)(r,"EEE").toUpperCase()})}),(0,l.jsx)("button",{onClick:()=>c(s+1),disabled:s>=t-1,className:`p-2 ${s<t-1?"text-green-500 hover:text-green-400":"text-gray-600"}`,children:(0,l.jsx)(a.Z,{size:16})})]})},p=(e,s,t)=>{if(!t?.length)return!1;let l=new Date(s);l.setHours(0,0,0,0);let r=new Date(s);r.setHours(23,59,59,999);let i=t.filter(e=>{if(!e.completedAt)return!1;let s=new Date(e.completedAt);return s>=l&&s<r}),a=e.exercises.map(e=>e.exercise.id);return i.some(e=>{if(!e.completedAt)return!1;let s=e.exercisesCompleted.map(e=>e.exercise.id);return!!a.some(e=>s.includes(e))&&new Date(e.completedAt).getHours()>=6})},b=e=>{let{workout:s,gifUrls:t,selectedOrder:i,maxOrder:a,showArrows:x,showCalendar:h,workoutDate:b,backgroundColor:j="bg-zinc-800",isComplete:v=!1,isChallengeEnabled:N=!1,challengeStartDate:w,challengeHasStarted:y,currentDayIndex:k,userChallenge:E,allWorkoutSummaries:C,index:S,onPrimaryAction:z,onCalendarTap:F,onUpdateOrder:I}=e,[D,W]=(0,r.useState)(v);(0,r.useEffect)(()=>{if(console.log("\n\uD83D\uDD0D Checking workout completion status"),console.log("\uD83D\uDCCA Initial Data:",{workoutId:s.id,workoutDate:b,challengeStartDate:w,isChallengeEnabled:N,initialIsComplete:v}),!w||!N){console.log("❌ No challenge date or challenge not enabled"),W(v);return}if(b&&b>new Date){console.log("⏳ Future date detected, marking incomplete:",b),W(!1);return}let e=E?.completedWorkouts?.some(e=>(console.log("Comparing:",{completedWorkoutId:e.workoutId,currentWorkoutId:s.id,matches:e.workoutId===s.id}),e.workoutId===s.id));console.log("\uD83C\uDFC6 Completion from userChallenge:",{isMarkedComplete:e,completedWorkouts:E?.completedWorkouts});let t=!!b&&p(s,b,C);console.log("\uD83D\uDCDD Completion from logs:",{completedViaLogs:t,summariesCount:C?.length||0});let l=e||t;console.log("✅ Final completion status:",l),W(l)},[s,w,E,C,b]);let U=`
    rounded-lg overflow-hidden cursor-pointer ${j}
    ${void 0!==S&&S<(k||0)||D?"opacity-70":"opacity-100"}
    ${((e,s)=>{if(void 0===e||!s)return!1;let t=new Date;t.setHours(0,0,0,0);let l=new Date(s);return l.setHours(0,0,0,0),e===Math.floor(Math.abs(t.getTime()-l.getTime())/864e5)})(S,w)&&y?"ring-2 ring-green-500":""}
  `;return(0,l.jsx)("div",{onClick:z,className:U,children:(0,l.jsxs)("div",{className:"flex",children:[x&&void 0!==i&&void 0!==a&&I&&(0,l.jsx)(f,{selectedOrder:i,maxOrder:a,workoutDate:b,showCalendar:!!h,onUpdateOrder:I,onCalendarTap:F}),(0,l.jsxs)("div",{className:"flex-1 p-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:s.title}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)(g,{icon:(0,l.jsx)(n.Z,{size:16}),value:String(s.exercises.length),label:"moves"}),(0,l.jsx)(g,{icon:(0,l.jsx)(c.Z,{size:16}),value:1>u.oQ.estimatedDuration(s.exercises)?"< 1":String(u.oQ.estimatedDuration(s.exercises)),label:"min"})]})]}),(0,l.jsx)(o.Z,{className:"text-gray-500",size:20})]}),(0,l.jsx)("div",{className:"flex gap-2 mb-4 overflow-x-auto",children:t.slice(0,3).map((e,t)=>(0,l.jsx)("div",{className:"w-24 h-24 rounded-lg overflow-hidden flex-shrink-0",children:(0,l.jsx)(m.f,{gifUrl:e,alt:`Exercise ${t+1} preview`,className:"w-full h-full"})},`${s.id}-gif-${t}`))}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"px-3 py-1 bg-green-500 bg-opacity-20 text-green-500 rounded-full text-sm",children:s.zone}),N&&(0,l.jsx)(d.Z,{className:D?"text-green-500":"text-gray-600",size:20})]})]})]})})},j=e=>{let{selectedOrder:s,maxOrder:t,showArrows:i,showCalendar:a,workoutDate:n,backgroundColor:c="bg-zinc-800",isComplete:o=!1,challengeStartDate:x,challengeHasStarted:u,currentDayIndex:m,index:h,onPrimaryAction:g,onCalendarTap:p,onUpdateOrder:b}=e,[j,v]=(0,r.useState)(o);(0,r.useEffect)(()=>{if(!x||!n){v(o);return}v(n<=new Date)},[n,x,o]);let N=`
    rounded-lg overflow-hidden cursor-pointer ${c}
    ${void 0!==h&&h<(m||0)||j?"opacity-70":"opacity-100"}
    ${((e,s)=>{if(void 0===e||!s)return!1;let t=new Date;t.setHours(0,0,0,0);let l=new Date(s);return l.setHours(0,0,0,0),e===Math.floor(Math.abs(t.getTime()-l.getTime())/864e5)})(h,x)&&u?"ring-2 ring-green-500":""}
  `;return(0,l.jsx)("div",{onClick:g,className:N,children:(0,l.jsxs)("div",{className:"flex",children:[i&&void 0!==s&&void 0!==t&&b&&(0,l.jsx)(f,{selectedOrder:s,maxOrder:t,workoutDate:n,showCalendar:!!a,onUpdateOrder:b,onCalendarTap:p}),(0,l.jsxs)("div",{className:"flex-1 p-4",children:[(0,l.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"Rest Day"}),(0,l.jsx)("p",{className:"text-gray-400 text-sm",children:"Take a moment to recover and come back stronger."})]})}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"px-3 py-1 bg-green-500 bg-opacity-20 text-green-500 rounded-full text-sm",children:"Recovery"}),(0,l.jsx)(d.Z,{className:j?"text-green-500":"text-gray-600",size:20})]})]})]})})}},3023:function(e,s,t){var l=t(5893);t(7294),s.Z=e=>{let{size:s=16,className:t=""}=e;return(0,l.jsx)("div",{style:{height:`${s}px`},className:t,"aria-hidden":"true"})}},7974:function(e,s,t){t.r(s),t.d(s,{default:function(){return em}});var l,r,i=t(5893),a=t(7294),n=t(5007);(l=r||(r={})).Discover="discover",l.Search="search",l.Create="create",l.Messages="messages",l.Profile="profile";var c=t(6045),o=e=>{let{selectedTab:s,onTabChange:t}=e;a.useEffect(()=>{console.log("Current user in BottomNav:",c.W4.currentUser),c.W4.currentUser?.profileImage&&console.log("Profile image data:",c.W4.currentUser.profileImage)},[]);let l=c.W4.currentUser;console.log("Rendering BottomNav with currentUser:",l),console.log("Has profile image?",l&&l.profileImage&&l.profileImage.profileImageURL);let n=[{id:r.Discover,label:"Discover",icon:"/discover-icon.svg",selectedIcon:"/discover-icon-selected.svg"},{id:r.Search,label:"Search",icon:"/search-icon.svg",selectedIcon:"/search-icon-selected.svg"},{id:r.Create,label:"",icon:"/create-icon.svg",selectedIcon:"/create-icon.svg"},{id:r.Messages,label:"Message",icon:"/message-icon.svg",selectedIcon:"/message-icon-selected.svg"},{id:r.Profile,label:"Profile",icon:"/profile-icon.svg",selectedIcon:"/profile-icon-selected.svg"}];return(0,i.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-zinc-800/80 backdrop-blur-sm border-t border-zinc-700",children:(0,i.jsx)("div",{className:"max-w-md mx-auto px-8 py-4 flex justify-between items-center",children:n.map(e=>{let l=s===e.id,a=e.id===r.Profile,n=c.W4.currentUser,o=n&&n.profileImage&&n.profileImage.profileImageURL;return(0,i.jsx)("button",{className:"flex flex-col items-center gap-1",onClick:()=>t(e.id),children:e.id===r.Create?(0,i.jsx)("div",{className:"w-12 h-12 bg-[#E0FE10] rounded-full flex items-center justify-center -mt-6",children:(0,i.jsx)("img",{src:e.icon,alt:e.label,className:"w-6 h-6"})}):(0,i.jsxs)(i.Fragment,{children:[a&&o?(0,i.jsx)("img",{src:n.profileImage.profileImageURL,alt:"User profile",className:`w-6 h-6 rounded-full object-cover
                        ${l?"ring-2 ring-[#E0FE10]":""}
                        `,onError:s=>{console.error("Error loading profile image:",s),s.currentTarget.src=e.icon}}):(0,i.jsx)("img",{src:l?e.selectedIcon:e.icon,alt:e.label,className:"w-6 h-6"}),e.label&&(0,i.jsx)("span",{className:`text-xs ${l?"text-[#E0FE10]":"text-zinc-400"}`,children:e.label})]})},e.id)})})})},d=t(3530),x=t(9073),u=t(8071),m=t(1163),h=()=>{let[e,s]=(0,a.useState)([]),[t,l]=(0,a.useState)(!0),[r,n]=(0,a.useState)(!1),[c,o]=(0,a.useState)(null),[h,g]=(0,a.useState)(!0),f=(0,a.useRef)(null),p=(0,m.useRouter)(),b=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e?n(!0):l(!0);let{exercises:t,lastVisible:r}=await x.$.fetchPaginatedExercises(c,15);s(s=>e?[...s,...t]:t),o(r),g(t.length>0)}catch(e){console.error("Error fetching exercises:",e)}finally{e?n(!1):l(!1)}};(0,a.useEffect)(()=>{b()},[]),(0,a.useEffect)(()=>{if(!f.current)return;let e=new IntersectionObserver(e=>{e[0].isIntersecting&&h&&!r&&b(!0)},{threshold:1});return e.observe(f.current),()=>e.disconnect()},[h,r,c]),(0,a.useEffect)(()=>{let e=new IntersectionObserver(e=>{for(let s of e){let e=s.target;s.isIntersecting&&!e.dataset.userPause?e.play().catch(e=>console.error("Video play error:",e)):e.pause()}},{threshold:.5}),s=document.querySelectorAll('video[data-observe="true"]');return s.forEach(s=>{e.observe(s)}),()=>{s.forEach(s=>e.unobserve(s)),e.disconnect()}},[e]);let j=e=>{let s=e.currentTarget;s.paused?(s.removeAttribute("data-user-pause"),s.play().catch(e=>console.error("Video play error:",e))):(s.setAttribute("data-user-pause","true"),s.pause())},v=e=>{e?p.push(`/profile/${e}`):console.error("Username is missing.")},N=(e,t)=>{s(s=>s.map((s,l)=>l===e?new d.cd({...s,currentVideoPosition:t}):s))};return t&&0===e.length?(0,i.jsx)("div",{className:"text-white text-center",children:"Loading exercises..."}):(0,i.jsxs)("div",{className:"max-w-xl mx-auto px-4 py-6",children:[e.map((e,s)=>(0,i.jsxs)("div",{className:"bg-zinc-800 rounded-xl overflow-hidden mb-6",children:[(0,i.jsx)("video",{"data-observe":"true",src:e.videos[e.currentVideoPosition]?.videoURL,muted:!0,loop:!0,className:"w-full aspect-square object-cover",onClick:e=>{e.preventDefault(),j(e)},playsInline:!0}),(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4 mb-3",children:[(0,i.jsx)("img",{src:e.videos[e.currentVideoPosition]?.profileImage.profileImageURL||"/default-profile.png",alt:e.videos[e.currentVideoPosition]?.username||"User",className:"w-8 h-8 rounded-full cursor-pointer",onClick:()=>v(e.videos[e.currentVideoPosition]?.username||"")}),(0,i.jsx)("p",{className:"text-white font-medium cursor-pointer",onClick:()=>v(e.videos[e.currentVideoPosition]?.username||""),children:e.videos[e.currentVideoPosition]?.username||"Unknown User"})]}),(0,i.jsx)("p",{className:"text-zinc-400 text-sm",children:e.name}),(0,i.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:e.description}),(0,i.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[e.videos.slice(0,4).map((t,l)=>(0,i.jsx)(u.f,{gifUrl:t.gifURL||"/default-gif.gif",alt:`Preview of ${e.name}`,frameSize:{width:36,height:36},contentMode:"cover",className:`border-2 ${e.currentVideoPosition===l?"border-[#E0FE10]":"border-zinc-500"}`,onClick:()=>N(s,l)},t.id)),e.videos.length>4&&(0,i.jsxs)("div",{className:"w-9 h-9 bg-gray-600 rounded-full flex items-center justify-center text-white text-sm",onClick:()=>console.log("More videos tapped"),children:["+",e.videos.length-4]})]})]})]},e.id)),h&&(0,i.jsx)("div",{ref:f,className:"text-center py-4",children:r&&(0,i.jsx)("div",{className:"spinner border-t-transparent border-4 border-[#E0FE10] w-6 h-6 rounded-full animate-spin"})})]})},g=t(6127),f=t(9176),p=t(2629),b=t(384),j=()=>{let[e,s]=(0,a.useState)(!0),[t,l]=(0,a.useState)("all"),[r,n]=(0,a.useState)(""),[o,d]=(0,a.useState)([]),[u,h]=(0,a.useState)([]),[j,v]=(0,a.useState)([]),[N,w]=(0,a.useState)([]),y=(0,m.useRouter)(),k=[{id:"all",label:"All",icon:(0,i.jsx)(g.Z,{className:"w-4 h-4"})},{id:"people",label:"People",icon:(0,i.jsx)(f.Z,{className:"w-4 h-4"})},{id:"exercises",label:"Moves",icon:(0,i.jsx)(p.Z,{className:"w-4 h-4"})},{id:"bodyparts",label:"Bodyparts",icon:(0,i.jsx)(p.Z,{className:"w-4 h-4"})}],E=e=>{y.push(`/profile/${e.username}`)},C=e=>{let s=e.name.toLowerCase().replace(/\s+/g,"-");y.push(`/exercise/${s}`)};return((0,a.useEffect)(()=>{(async()=>{s(!0);try{let e=await c.W4.fetchUsersWithVideosUploaded();v(e)}catch(e){console.error("Error loading initial data:",e)}finally{s(!1)}})()},[]),(0,a.useEffect)(()=>{(async()=>{s(!0);try{let[e,s]=await Promise.all([c.W4.fetchUsersWithVideosUploaded(),x.$.fetchFeaturedExercisesWithVideos(24)]);v(e),w(s)}catch(e){console.error("Error loading initial data:",e)}finally{s(!1)}})()},[]),e)?(0,i.jsx)("div",{className:"min-h-screen bg-zinc-900 flex items-center justify-center",children:(0,i.jsx)("div",{className:"text-white",children:"Loading..."})}):(0,i.jsxs)("div",{className:"min-h-screen bg-zinc-900",children:[(0,i.jsx)("div",{className:"sticky top-0 z-10 bg-zinc-900/80 backdrop-blur-sm border-b border-zinc-800 ",children:(0,i.jsxs)("div",{className:"pt-4 px-4",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3 bg-zinc-800 rounded-lg px-4 py-2",children:[(0,i.jsx)(g.Z,{className:"w-5 h-5 text-zinc-400"}),(0,i.jsx)("input",{type:"text",placeholder:(()=>{switch(t){case"people":return"Search people..";case"exercises":return"Search exercises..";case"bodyparts":return"Search bodyparts..";default:return"Search people, exercises, or bodyparts.."}})(),value:r,onChange:e=>n(e.target.value),className:"bg-transparent text-white placeholder-zinc-500 flex-1 outline-none"})]}),(0,i.jsx)("div",{className:"flex space-x-2 mt-4 pb-4 overflow-x-auto",children:k.map(e=>(0,i.jsxs)("button",{onClick:()=>l(e.id),className:`flex items-center space-x-2 px-4 py-2 rounded-full transition-colors
                  ${t===e.id?"bg-[#E0FE10] text-black":"bg-zinc-800 text-zinc-400 hover:text-white"}`,children:[e.icon,(0,i.jsx)("span",{className:"text-sm font-medium whitespace-nowrap",children:e.label})]},e.id))})]})}),(0,i.jsx)("div",{className:"pt-4 max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:""===r?(0,i.jsxs)("div",{className:"py-4 ",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold text-white px-4 mb-4",children:"People"}),(0,i.jsx)("div",{className:"overflow-x-auto scrollbar-hide",children:(0,i.jsx)("div",{className:"flex flex-nowrap space-x-4 px-4 pb-4 min-w-max",children:j.map(e=>(0,i.jsx)("div",{className:"flex-shrink-0 cursor-pointer",onClick:()=>E(e),children:(0,i.jsxs)("div",{className:"relative w-[150px]",children:[(0,i.jsxs)("div",{className:"aspect-square rounded-2xl overflow-hidden bg-zinc-800",children:[e.profileImage?.profileImageURL?(0,i.jsx)("img",{src:e.profileImage.profileImageURL,alt:e.username,className:"w-full h-full object-cover"}):(0,i.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,i.jsx)(b.Z,{className:"w-12 h-12 text-zinc-600"})}),e.creator?.type?.includes(c.I0.PersonalTrainer)&&(0,i.jsx)("div",{className:"absolute bottom-2 right-2",children:(0,i.jsx)("div",{className:"bg-[#E0FE10] px-3 py-1 rounded-xl",children:(0,i.jsx)("span",{className:"text-xs font-bold text-black tracking-wider",children:"T R A I N E R"})})})]}),(0,i.jsxs)("p",{className:"mt-2 text-sm text-white text-center",children:["@",e.username]})]})},e.id))})}),(0,i.jsxs)("div",{className:"py-4",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold text-white px-4 mb-4",children:"Explore New Moves"}),(0,i.jsx)("div",{className:"grid grid-cols-3 gap-0",children:N.map(e=>(0,i.jsx)("div",{className:"cursor-pointer aspect-[2/3]",onClick:()=>C(e),children:(0,i.jsx)("div",{className:"relative w-full h-full",children:e.videos[0]?.gifURL?(0,i.jsx)("img",{src:e.videos[0].gifURL,alt:e.name,className:"w-full h-full object-cover"}):(0,i.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-zinc-800",children:(0,i.jsx)(p.Z,{className:"w-8 h-8 text-zinc-600"})})})},e.id))})]})]}):(0,i.jsxs)("div",{className:"divide-y divide-zinc-800",children:["all"===t&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"px-4 py-2 text-sm font-medium text-zinc-400",children:"People"}),(0,i.jsx)("div",{className:"px-4 py-2 text-sm font-medium text-zinc-400",children:"Exercises"})]}),"people"===t&&(0,i.jsx)("div",{className:"px-4"}),"exercises"===t&&(0,i.jsx)("div",{className:"px-4"})]})})]})},v=t(6604),N=t(7581),w=t(756);let y=e=>{let{file:s,onTrimComplete:t,onCancel:l}=e,r=(0,a.useRef)(null),[n,c]=(0,a.useState)(0),[o,d]=(0,a.useState)(0),[x,u]=(0,a.useState)(0),[m,h]=(0,a.useState)(!1),[g,f]=(0,a.useState)(!1),[p,b]=(0,a.useState)({mediaRecorder:!1,captureStream:!1}),[j,v]=(0,a.useState)(0),y=(0,a.useRef)(null);(0,a.useEffect)(()=>(b({mediaRecorder:"MediaRecorder"in window,captureStream:"captureStream"in HTMLCanvasElement.prototype}),r.current&&s&&(y.current=URL.createObjectURL(s),r.current.src=y.current,r.current.addEventListener("loadedmetadata",()=>{let e=r.current?.duration||0;u(e),d(Math.min(e,30))})),()=>{y.current&&URL.revokeObjectURL(y.current)}),[s]),(0,a.useEffect)(()=>{let e=r.current;if(!e)return;let s=()=>{e.currentTime>=o&&(e.pause(),e.currentTime=n)};return e.addEventListener("timeupdate",s),()=>e.removeEventListener("timeupdate",s)},[o,n]);let k=async()=>{if(!r.current){alert("Video element not initialized");return}if(o-n<5||o-n>30){alert("Video must be between 5 and 30 seconds");return}try{h(!0);let e=new N.C;await e.load(),await e.writeFile("input.mp4",await (0,w.dc)(s)),await e.exec(["-ss",n.toString(),"-t",(o-n).toString(),"-i","input.mp4","-c","copy","output.mp4"]);let l=await e.readFile("output.mp4"),r=new File([l],"trimmed.mp4",{type:"video/mp4"});t(r)}catch(e){console.error("Video trimming failed:",e),alert(e instanceof Error?e.message:"Failed to trim video")}finally{h(!1),v(0)}},E=e=>`${Math.floor(e/60).toString().padStart(2,"0")}:${Math.floor(e%60).toString().padStart(2,"0")}`;return(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"bg-zinc-900 w-full max-w-md rounded-xl p-6",children:[(0,i.jsx)("h2",{className:"text-white text-xl font-bold mb-4",children:"Trim Your Video"}),(!p.mediaRecorder||!p.captureStream)&&(0,i.jsx)("div",{className:"text-red-500 mb-4",children:"Your browser doesn't support video trimming. Please use Chrome, Firefox, or Edge."}),(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsx)("video",{ref:r,controls:!0,className:"w-full rounded-lg",onPlay:()=>{if(!r.current)return;r.current.currentTime=n,r.current.play(),f(!0);let e=()=>{if(r.current&&r.current.currentTime>=o){r.current.pause(),f(!1);return}requestAnimationFrame(e)};e()},onPause:()=>f(!1)})}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsxs)("div",{className:"flex justify-between text-white text-sm mb-2",children:[(0,i.jsxs)("span",{children:["Start: ",E(n)]}),(0,i.jsxs)("span",{children:["Duration: ",E(o-n)]}),(0,i.jsxs)("span",{children:["End: ",E(o)]})]}),(0,i.jsxs)("div",{className:"relative mb-4",children:[(0,i.jsx)("input",{type:"range",min:0,max:x,value:n,onChange:e=>{c(Math.min(Number(e.target.value),o-5))},className:"w-full"}),(0,i.jsx)("input",{type:"range",min:0,max:x,value:o,onChange:e=>{d(Math.max(Number(e.target.value),n+5))},className:"w-full mt-2"})]}),m&&(0,i.jsx)("div",{className:"w-full bg-zinc-800 rounded-full h-2 mb-4",children:(0,i.jsx)("div",{className:"bg-[#E0FE10] h-2 rounded-full transition-all duration-300",style:{width:`${j}%`}})})]}),(0,i.jsxs)("div",{className:"flex space-x-4",children:[(0,i.jsx)("button",{onClick:l,disabled:m,className:"flex-1 bg-zinc-800 text-white py-2 rounded-lg disabled:opacity-50",children:"Cancel"}),(0,i.jsx)("button",{onClick:k,disabled:m||o-n<5||o-n>30||!p.mediaRecorder||!p.captureStream,className:"flex-1 bg-[#E0FE10] text-black py-2 rounded-lg disabled:opacity-50",children:m?`Trimming... ${j}%`:"Trim Video"})]})]})})};var k=t(3023),E=()=>{let[e,s]=(0,a.useState)(!1),[t,l]=(0,a.useState)(null),[r,n]=(0,a.useState)(null),[c,o]=(0,a.useState)(!1),[d,x]=(0,a.useState)(!1),[u,m]=(0,a.useState)(""),[h,g]=(0,a.useState)("Weight Training"),[f,p]=(0,a.useState)([]),[b,j]=(0,a.useState)(""),[N,w]=(0,a.useState)(""),E=(0,a.useRef)(null),C=e=>{if(!["video/mp4","video/quicktime","video/x-msvideo"].includes(e.type)){alert("Please upload a valid video file (MP4, AVI, QuickTime)");return}l(e),x(!0)},S=()=>{N.trim()&&!f.includes(N.trim())&&(p([...f,N.trim()]),w(""))},z=e=>{p(f.filter(s=>s!==e))},F=async()=>{if(t)try{o(!0);let e=await v.kf.uploadVideo(t,v.ZS.Exercise);console.log("Video uploaded successfully",e),console.log("Exercise Details:",{name:u,category:h,tags:f,caption:b})}catch(e){console.error("Upload failed",e),alert("Video upload failed")}finally{o(!1)}};return(0,i.jsxs)("div",{className:"max-w-xl mx-auto px-4 py-6",children:[(0,i.jsxs)("div",{className:"text-center text-white mb-6",children:[(0,i.jsx)("h2",{className:"text-2xl font-bold",children:"Create"}),(0,i.jsx)("p",{className:"text-zinc-400",children:"Start building your next workout or post."})]}),d&&t&&(0,i.jsx)(y,{file:t,onTrimComplete:e=>{n(URL.createObjectURL(e)),l(e),x(!1)},onCancel:()=>{x(!1),l(null)}}),(0,i.jsx)("div",{className:`
          border-2 border-dashed rounded-xl p-6 text-center transition-colors duration-300
          ${e?"border-[#E0FE10] bg-[#E0FE10]/10":"border-zinc-700"}
        `,onDragOver:e=>{e.preventDefault(),s(!0)},onDragLeave:()=>{s(!1)},onDrop:e=>{e.preventDefault(),s(!1),C(e.dataTransfer.files[0])},children:r?(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("video",{src:r,controls:!0,className:"w-full rounded-xl"}),(0,i.jsx)("button",{onClick:()=>{l(null),n(null),E.current&&(E.current.value="")},className:"absolute top-2 right-2 bg-red-500 text-white p-2 rounded-full",children:"✕"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{type:"file",ref:E,accept:"video/mp4,video/quicktime,video/x-msvideo",onChange:e=>{let s=e.target.files?.[0];s&&C(s)},className:"hidden"}),(0,i.jsxs)("div",{className:"text-zinc-400",children:[(0,i.jsx)("p",{className:"mb-4",children:"Drag and drop videos here"}),(0,i.jsx)("p",{className:"mb-4",children:"or"}),(0,i.jsx)("button",{onClick:()=>E.current?.click(),className:"bg-[#E0FE10] text-black px-4 py-2 rounded-lg",children:"Browse Files"})]})]})}),r&&(0,i.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm text-zinc-300 mb-2",children:"Exercise Name"}),(0,i.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),placeholder:"Enter exercise name",className:"w-full bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white placeholder-zinc-400"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm text-zinc-300 mb-2",children:"Exercise Category"}),(0,i.jsx)("select",{value:h,onChange:e=>g(e.target.value),className:"w-full bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white",children:["Weight Training","Cardio","Pilates","Mobility","Stretching","Calisthenics"].map(e=>(0,i.jsx)("option",{value:e,children:e},e))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm text-zinc-300 mb-2",children:"Tags"}),(0,i.jsxs)("div",{className:"flex mb-2",children:[(0,i.jsx)("input",{type:"text",value:N,onChange:e=>w(e.target.value),onKeyPress:e=>"Enter"===e.key&&S(),placeholder:"Add a tag",className:"flex-grow bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white placeholder-zinc-400"}),(0,i.jsx)("button",{onClick:S,className:"ml-2 bg-[#E0FE10] text-black px-4 rounded-lg",children:"Add"})]}),(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:f.map(e=>(0,i.jsxs)("div",{className:"bg-zinc-700 text-white px-3 py-1 rounded-full flex items-center",children:[e,(0,i.jsx)("button",{onClick:()=>z(e),className:"ml-2 text-red-400",children:"✕"})]},e))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm text-zinc-300 mb-2",children:"Caption"}),(0,i.jsx)("textarea",{value:b,onChange:e=>j(e.target.value),placeholder:"Add a caption to your exercise...",className:"w-full bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white placeholder-zinc-400",rows:4})]}),(0,i.jsx)("button",{onClick:F,disabled:!u||c,className:"w-full bg-[#E0FE10] text-black font-semibold py-3 px-4 mb-20 rounded-lg hover:bg-[#c8e60e] transition-colors disabled:opacity-50",children:c?"Uploading...":"Post Exercise"}),(0,i.jsx)(k.Z,{size:100})]})]})},C=t(7055);let S=e=>{let{onShare:s}=e;return(0,i.jsx)("div",{className:"bg-zinc-800 rounded-lg p-6 mx-4 mb-6 cursor-pointer shadow-lg transition-colors hover:bg-zinc-700/80",onClick:s,children:(0,i.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,i.jsx)("div",{className:"bg-zinc-700 p-4 rounded-full mb-4",children:(0,i.jsx)(f.Z,{className:"w-8 h-8 text-white"})}),(0,i.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"Pulse is even better with friends"}),(0,i.jsx)("p",{className:"text-zinc-400 text-sm",children:"Find your tribe, or invite your friends to join you sweat. Tap here to send out an invite link."})]})})},z=e=>{let{message:s,currentUserId:t,onSelect:l}=e,r=s.participants.find(e=>e.id!==t);if(!r)return null;let a=new Date(s.lastMessageTimestamp).toLocaleDateString();return(0,i.jsxs)("div",{className:"flex items-center gap-4 p-4 hover:bg-zinc-800 cursor-pointer transition-colors",onClick:()=>l(s),children:[r.profileImage?.profileImageURL?(0,i.jsx)("img",{src:r.profileImage.profileImageURL,alt:r.username,className:"w-12 h-12 rounded-full object-cover"}):(0,i.jsx)("div",{className:"w-12 h-12 bg-zinc-700 rounded-full flex items-center justify-center",children:(0,i.jsx)(C.Z,{className:"w-8 h-8 text-zinc-400"})}),(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsxs)("div",{className:"flex justify-between items-start",children:[(0,i.jsxs)("h3",{className:"text-white font-medium truncate",children:["@",r.username]}),(0,i.jsx)("span",{className:"text-xs text-zinc-400 flex-shrink-0",children:a})]}),(0,i.jsx)("p",{className:`text-sm truncate ${s.unreadCount?"text-white font-medium":"text-zinc-400"}`,children:s.lastMessage})]})]})};var F=()=>{let[e,s]=a.useState([]),[t,l]=a.useState(!0),r={id:"current-user-id"};a.useEffect(()=>{(async()=>{try{l(!0);let e=await fetch("/api/messages"),t=await e.json();s(t.messages)}catch(e){console.error("Failed to fetch messages:",e),s([])}finally{l(!1)}})()},[]);let n=async()=>{try{navigator.share?await navigator.share({title:"Join me on Pulse",text:"Hey! Let's workout together using Pulse.",url:"https://fitwithpulse.ai"}):console.log("Share not supported")}catch(e){console.error("Error sharing:",e)}},c=e=>{console.log("Selected message:",e)};return t?(0,i.jsx)("div",{className:"min-h-screen bg-zinc-900 flex items-center justify-center",children:(0,i.jsx)("div",{className:"text-zinc-400",children:"Loading..."})}):(0,i.jsxs)("div",{className:"min-h-screen bg-zinc-900",children:[(0,i.jsx)("div",{className:"sticky top-0 z-10 bg-zinc-900/80 backdrop-blur-sm border-b border-zinc-800",children:(0,i.jsx)("div",{className:"px-4 py-4 flex justify-center relative",children:(0,i.jsx)("h1",{className:"text-lg font-semibold text-white",children:"Direct Messages"})})}),(0,i.jsxs)("div",{className:"pt-4",children:[(0,i.jsx)(S,{onShare:n}),e.length>0&&(0,i.jsx)("div",{className:"divide-y divide-zinc-800",children:e.map(e=>(0,i.jsx)(z,{message:e,currentUserId:r.id,onSelect:c},e.id))})]})]})},I=t(9586),D=t(927),W=t(6019),U=t(8354),L=t(7014),T=t(3308),P=t(699),R=t(359),$=t(341);let A=e=>{let{stacks:s,onSelectStack:t}=e,l=(0,m.useRouter)();return(0,i.jsx)("div",{className:"grid grid-cols-1 gap-4",children:s.map((e,s)=>(0,i.jsx)("button",{onClick:()=>t(e),className:"w-full text-left",children:(0,i.jsx)(R.kg,{workout:e,gifUrls:e.exercises?.map(e=>e.exercise.videos?.[0]?.gifURL||"")||[],maxOrder:s,showArrows:!1,showCalendar:!0,onPrimaryAction:()=>{let s=c.W4.currentUser?.username;l.push(`/workout/${s}/${e.id}`)}})},e.id))})},Z={ACTIVITY:"activity",EXERCISES:"moves",STACKS:"stacks",CHALLENGES:"rounds"};var M=()=>{let[e,s]=(0,a.useState)(Z.EXERCISES),[t,l]=(0,a.useState)([]),[r,n]=(0,a.useState)([]),[o,d]=(0,a.useState)([]),[x,u]=(0,a.useState)([]),[m,h]=(0,a.useState)([]),[g,f]=(0,a.useState)([]),[p,b]=(0,a.useState)([]),[j,N]=(0,a.useState)(null),w=c.W4.currentUser,[y,k]=(0,a.useState)(!1),E=(0,a.useRef)(null),C=async e=>{let s=e.target.files?.[0];if(s)try{k(!0);let e=await v.kf.uploadImage(s,v.$5.Profile);if(w){let s=new c.n5({...w.toDictionary(),profileImage:{profileImageURL:e.downloadURL,imageOffsetWidth:0,imageOffsetHeight:0},updatedAt:new Date});await c.W4.updateUser(w.id,s),c.W4.currentUser=s}}catch(e){console.error("Profile image upload failed",e)}finally{k(!1)}};if(!w)return(0,i.jsx)("div",{children:"Loading..."});(0,a.useEffect)(()=>{(async()=>{if(w?.id)try{let[e,s,l,r]=await Promise.all([c.W4.fetchFollowers(),c.W4.fetchFollowing(),I.G.fetchUserChallenges(),I.G.fetchAllWorkoutSummaries()]);f(e),b(s);let i=l.map(e=>e.challenge).filter(e=>void 0!==e);n(i),d(r);let a=(0,P.o)(r,t,[...e,...s],w.id);console.log("Parsed Activities"+JSON.stringify(a)),h(a)}catch(e){console.error("Error fetching user data:",e)}})()},[w?.id]),(0,a.useEffect)(()=>{(async()=>{if(w?.id)try{let e=await c.W4.fetchUserStacks();u(e)}catch(e){console.error("Error fetching stacks:",e)}})()},[w?.id]),(0,a.useEffect)(()=>{(async()=>{if(w?.id)try{let e=await c.W4.fetchUserVideos();l(e)}catch(e){console.error("Error fetching user videos:",e)}})()},[w?.id]);let S={instagram:w.creator?.instagramHandle,twitter:w.creator?.twitterHandle,youtube:w.creator?.youtubeUrl};return(0,i.jsx)("div",{className:"min-h-screen bg-zinc-900",children:(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("div",{className:"h-48 bg-gradient-to-b from-zinc-800 to-zinc-900"}),(0,i.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,i.jsxs)("div",{className:"relative -mt-24",children:[(0,i.jsxs)("div",{className:"relative inline-block",children:[(0,i.jsx)("input",{type:"file",ref:E,accept:"image/jpeg,image/png,image/webp",onChange:C,className:"hidden"}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("img",{src:w.profileImage?.profileImageURL||"/api/placeholder/96/96",alt:w.displayName,className:`w-24 h-24 rounded-full border-4 border-zinc-900 ${y?"opacity-50":""}`}),y&&(0,i.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,i.jsx)("div",{className:"loader border-t-transparent border-4 border-white rounded-full w-8 h-8 animate-spin"})}),(0,i.jsx)("button",{onClick:()=>E.current?.click(),className:"absolute bottom-0 right-0 bg-[#E0FE10] text-black p-1 rounded-full shadow-lg hover:bg-[#c8e60e] transition-colors",disabled:y,children:(0,i.jsx)($.Z,{size:16})})]})]}),(0,i.jsxs)("div",{className:"mt-4 text-white",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold",children:w.displayName}),(0,i.jsxs)("p",{className:"text-zinc-400",children:["@",w.username]}),(0,i.jsxs)("div",{className:"mt-2 flex items-center gap-4 text-sm text-zinc-400",children:[(0,i.jsxs)("span",{children:[g.length," followers"]}),(0,i.jsx)("span",{className:"w-1 h-1 bg-zinc-600 rounded-full"}),(0,i.jsxs)("span",{children:[p.length," following"]})]}),(0,i.jsx)("p",{className:"mt-4 text-zinc-300",children:w.bio}),(0,i.jsx)("div",{className:"mt-4 flex gap-6",children:Object.entries(S).map(e=>{let[s,t]=e;return t?(0,i.jsx)("a",{href:function(e,s){switch(e){case"instagram":return`https://instagram.com/${s}`;case"twitter":return`https://twitter.com/${s}`;case"youtube":return s;default:return"#"}}(s,t),target:"_blank",rel:"noopener noreferrer",className:"text-zinc-400 hover:text-white transition-colors",children:(0,i.jsx)("img",{src:`/${s}.svg`,alt:s,className:"w-6 h-6 hover:opacity-80"})},s):null})})]}),(0,i.jsx)("div",{className:"mt-8 border-b border-zinc-700 overflow-x-auto",children:(0,i.jsx)("nav",{className:"flex whitespace-nowrap min-w-full sm:min-w-0 px-4 sm:px-0",children:(0,i.jsx)("div",{className:"flex gap-8 pb-2 sm:pb-0",children:Object.values(Z).map(t=>(0,i.jsxs)("button",{onClick:()=>s(t),className:`pb-4 px-2 text-sm font-medium transition-colors relative flex-shrink-0
                        ${e===t?"text-white":"text-zinc-400 hover:text-zinc-300"}`,children:[t.charAt(0).toUpperCase()+t.slice(1),e===t&&(0,i.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white"})]},t))})})}),(0,i.jsxs)("div",{className:"mt-8",children:[e===Z.ACTIVITY&&(0,i.jsx)("div",{className:"px-5",children:0===m.length?(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center p-8",children:[(0,i.jsx)(D.Z,{className:"w-12 h-12 text-white/20"}),(0,i.jsx)("h3",{className:"mt-4 text-white font-medium",children:"No activities yet"})]}):(0,i.jsx)(W.Z,{activities:m,workoutSummaries:o,userVideos:t,username:w.username,isPublicProfile:!1,onWorkoutSelect:e=>{console.log("Selected workout summary:",e)},onVideoSelect:e=>{console.log("Selected exercise:",e),N(e)},onProfileSelect:e=>{console.log("Selected user profile:",e)}})}),e===Z.STACKS&&(0,i.jsxs)("div",{className:"px-5",children:[(0,i.jsxs)("h2",{className:"text-xl text-white font-semibold mb-4",children:["Your Stacks (",x.length,")"]}),(0,i.jsx)(A,{stacks:x,onSelectStack:e=>{console.log("Selected stack:",e)}})]}),e===Z.EXERCISES&&(0,i.jsxs)("div",{className:"px-5",children:[(0,i.jsxs)("h2",{className:"text-xl text-white font-semibold mb-4",children:["Your Videos (",t.length,")"]}),(0,i.jsx)(L.Z,{userVideos:t,onSelectVideo:e=>{N(e)}})]}),e===Z.CHALLENGES&&(0,i.jsx)(U.M,{activeChallenges:r,onSelectChallenge:e=>{console.log("Selected challenge:",e)}})]})]})}),j&&(0,i.jsx)(T.default,{exercise:j,user:w,onBack:()=>N(null),onProfileClick:()=>{console.log("Profile clicked")}})]})})},V=t(2190),H=t(39),B=t(4307),G=t(4454),O=t(8381),q=e=>{let{workout:s,onClose:t,onStartWorkout:l}=e,[r,c]=(0,a.useState)(!1);(0,m.useRouter)();let o=(0,n.I0)(),d=(0,n.v9)(e=>e.user.currentUser?.id),x=(0,n.v9)(e=>e.workout.currentWorkout),u=async()=>{l&&l()},h=async()=>{if(!d||!x){console.error("No user ID or current workout session found");return}try{await I.G.cancelWorkout(x,I.G.currentWorkoutSummary),o((0,O.q1)(null)),o((0,O.HX)([])),console.log("Workout session canceled successfully")}catch(e){console.error("Error canceling workout session:",e)}},g=e=>{let{icon:s,title:t,value:l}=e;return(0,i.jsxs)("div",{className:"flex items-center bg-zinc-800 rounded-xl p-4",children:[(0,i.jsx)(s,{className:"text-[#E0FE10] w-6 h-6 mr-4"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-zinc-400 text-sm",children:t}),(0,i.jsx)("p",{className:"text-white font-semibold",children:l})]})]})};return(0,i.jsxs)("div",{className:"min-h-screen bg-black flex flex-col",children:[(0,i.jsx)("div",{className:"absolute top-0 left-0 right-0 z-10 p-4",children:(0,i.jsx)("button",{onClick:t,className:"ml-auto block",children:(0,i.jsx)(V.Z,{className:"text-white w-6 h-6"})})}),(0,i.jsxs)("div",{className:"flex-grow container mx-auto px-4 pt-20",children:[(0,i.jsxs)("div",{className:"text-center mb-8",children:[(0,i.jsx)(p.Z,{className:"mx-auto text-[#E0FE10] w-20 h-20 mb-4"}),(0,i.jsx)("h1",{className:"text-3xl font-bold text-white mb-4",children:s.title}),(0,i.jsx)("p",{className:"text-zinc-400 mb-8",children:"Once you hit start, your workout will begin. Get ready to crush it! \uD83D\uDCAA"})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)(g,{icon:H.Z,title:"Estimated Duration",value:`${G.oQ.estimatedDuration(s.exercises)} min`}),(0,i.jsxs)("div",{className:"bg-zinc-800 rounded-xl",children:[(0,i.jsxs)("button",{onClick:()=>c(!r),className:"w-full flex items-center justify-between p-4",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(p.Z,{className:"text-[#E0FE10] w-6 h-6 mr-4"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-zinc-400 text-sm",children:"Exercise Count"}),(0,i.jsxs)("p",{className:"text-white font-semibold",children:[s.exercises.length," exercises"]})]})]}),(0,i.jsx)(B.Z,{className:`text-[#E0FE10] transform transition-transform ${r?"rotate-90":""}`})]}),r&&(0,i.jsx)("div",{className:"border-t border-zinc-700 p-4",children:s.exercises.map((e,s)=>(0,i.jsxs)("div",{className:"flex items-center mb-3 last:mb-0",children:[(0,i.jsx)("div",{className:"bg-zinc-700 rounded-full w-6 h-6 flex items-center justify-center mr-4",children:(0,i.jsx)("span",{className:"text-zinc-400 text-xs",children:s+1})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-white",children:e.exercise.name}),(0,i.jsxs)("p",{className:"text-zinc-400 text-sm",children:[e.exercise.sets," sets • ",e.exercise.reps," reps"]})]})]},e.exercise.id))})]}),(0,i.jsx)(g,{icon:p.Z,title:"Workout Type",value:s.zone})]}),(0,i.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black to-transparent",children:[(0,i.jsx)("button",{onClick:h,className:"w-full text-white py-3 rounded-full font-bold text-lg mb-4",children:"Cancel"}),(0,i.jsx)("button",{onClick:u,className:"w-full bg-[#E0FE10] text-black py-3 rounded-full font-bold text-lg",children:"Start Workout"})]})]})]})},_=e=>{let{isOpen:s,onClose:t,title:l,message:r,primaryButtonText:a,secondaryButtonText:n,onPrimaryAction:c,onSecondaryAction:o,theme:d="dark"}=e;return s?(0,i.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,i.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),(0,i.jsx)("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md",children:(0,i.jsxs)("div",{className:`
          relative mx-4 p-6 rounded-2xl shadow-lg 
          ${"dark"===d?"bg-zinc-900":"bg-white"}
        `,children:[(0,i.jsx)("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-500",children:(0,i.jsx)(V.Z,{size:20})}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("h3",{className:`text-lg font-bold mb-2 
              ${"dark"===d?"text-white":"text-black"}`,children:l}),r&&(0,i.jsx)("p",{className:`mb-6 
                ${"dark"===d?"text-zinc-400":"text-gray-600"}`,children:r}),(0,i.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,i.jsx)("button",{onClick:c,className:"w-full bg-[#E0FE10] text-black px-4 py-2 rounded-full font-medium  hover:bg-[#E0FE10]/90 transition-colors",children:a}),n&&(0,i.jsx)("button",{onClick:o,className:`w-full px-4 py-2 rounded-full font-medium border 
                    ${"dark"===d?"border-zinc-700 text-white hover:bg-zinc-800":"border-gray-300 text-gray-700 hover:bg-gray-50"} transition-colors`,children:n})]})]})]})})]}):null};let X=e=>e?.category?.details?.screenTime??60;var Q=e=>{let{exercises:s,currentExerciseLogs:t,currentExerciseIndex:l,onComplete:r,onClose:n,onExerciseSelect:c}=e;if(!s||0===s.length)return console.error("No exercises provided"),(0,i.jsxs)("div",{className:"fixed inset-0 bg-zinc-900 flex items-center justify-center",children:[(0,i.jsx)("p",{className:"text-white",children:"No exercises available"}),(0,i.jsx)("button",{onClick:n,className:"mt-4 bg-[#E0FE10] text-black px-4 py-2 rounded",children:"Close Workout"})]});if(l<0||l>=s.length)return console.error("Invalid exercise index",{currentExerciseIndex:l,exercisesLength:s.length}),(0,i.jsxs)("div",{className:"fixed inset-0 bg-zinc-900 flex items-center justify-center",children:[(0,i.jsx)("p",{className:"text-white",children:"Invalid exercise selection"}),(0,i.jsx)("button",{onClick:n,className:"mt-4 bg-[#E0FE10] text-black px-4 py-2 rounded",children:"Close Workout"})]});let o=t[l],d=o?.exercise;if(!d)return console.error("No exercise found at current index",{currentExerciseIndex:l,exerciseLog:o}),(0,i.jsxs)("div",{className:"fixed inset-0 bg-zinc-900 flex items-center justify-center",children:[(0,i.jsx)("p",{className:"text-white",children:"Exercise data is missing"}),(0,i.jsx)("button",{onClick:n,className:"mt-4 bg-[#E0FE10] text-black px-4 py-2 rounded",children:"Close Workout"})]});let x=X(d),[u,m]=(0,a.useState)(x),[h,g]=(0,a.useState)(!1),[f,p]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{m(X(d))},[d]),(0,a.useEffect)(()=>{if(x<=0)return;if(u<=0){r();return}if(h)return;let e=setInterval(()=>{m(e=>e-1)},1e3);return()=>clearInterval(e)},[u,h,r,x]),(0,i.jsxs)("div",{className:"fixed inset-0 bg-zinc-900 flex flex-col",children:[(0,i.jsxs)("div",{className:"relative flex h-full",children:[(0,i.jsxs)("div",{className:"w-full lg:w-2/3 relative bg-black",children:[(0,i.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",children:(0,i.jsxs)("div",{className:"w-[700px] h-[900px] relative rounded-2xl overflow-hidden",children:[(0,i.jsx)("video",{src:(()=>{let e=d?.videos||[];if(0===e.length)return console.warn(`No videos found for exercise: ${d?.name}`),"";let s=Math.min(d?.currentVideoPosition??0,e.length-1),t=e[s]?.videoURL||"";return t||console.warn(`No video URL for exercise ${d?.name}`),t})(),className:"absolute inset-0 w-full h-full object-cover",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,onError:e=>console.error("Video error:",e)}),(0,i.jsx)("div",{className:"hidden lg:block absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 to-transparent",children:(0,i.jsxs)("div",{className:"p-8",children:[(0,i.jsx)("h2",{className:"text-white text-3xl font-bold mb-4",children:d?.name||"Exercise"}),(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("span",{className:"text-[#E0FE10] text-lg font-bold",children:[Math.floor((x-u)/60),"m"]}),(0,i.jsx)("p",{className:"text-zinc-400 text-sm",children:"elapsed"})]}),x>0&&(0,i.jsx)("button",{onClick:()=>g(!h),className:"bg-black/30 hover:bg-black/50 p-4 rounded-xl border border-[#E0FE10]/20 backdrop-blur-sm transition-all duration-200 group",children:h?(0,i.jsxs)("svg",{className:"w-6 h-6 text-[#E0FE10] group-hover:scale-110 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}):(0,i.jsx)("svg",{className:"w-6 h-6 text-[#E0FE10] group-hover:scale-110 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("span",{className:"text-[#E0FE10] text-lg font-bold",children:[l+1,"/",t.length]}),(0,i.jsx)("p",{className:"text-zinc-400 text-sm",children:"exercises"})]})]})]})}),(0,i.jsx)("div",{className:"lg:hidden absolute top-0 left-0 right-0 bg-gradient-to-b from-black/90 to-transparent",children:(0,i.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("span",{className:"text-[#E0FE10] text-lg font-bold",children:[Math.floor((x-u)/60),"m"]}),(0,i.jsx)("p",{className:"text-zinc-400 text-xs",children:"elapsed"})]}),x>0&&(0,i.jsx)("button",{onClick:()=>g(!h),className:"bg-black/30 hover:bg-black/50 p-3 rounded-xl border border-[#E0FE10]/20 backdrop-blur-sm"}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("span",{className:"text-[#E0FE10] text-lg font-bold",children:[l+1,"/",t.length]}),(0,i.jsx)("p",{className:"text-zinc-400 text-xs",children:"exercises"})]})]})})]})}),(0,i.jsx)("button",{onClick:()=>p(!0),className:"absolute top-4 right-4 w-10 h-10 rounded-full bg-black/50 flex items-center justify-center",children:(0,i.jsx)(V.Z,{className:"text-white",size:20})})]}),(0,i.jsx)("div",{className:"hidden lg:flex lg:w-1/3 p-6",children:(0,i.jsxs)("div",{className:"w-full bg-black/50 rounded-2xl p-6 flex flex-col",children:[(0,i.jsx)("h2",{className:"text-white text-2xl font-bold mb-6",children:"Workout Progress"}),(0,i.jsx)("div",{className:"flex-1 overflow-y-auto pr-2",children:t.map((e,s)=>(0,i.jsx)("div",{onClick:()=>c(s),className:`mb-4 p-4 rounded-lg cursor-pointer hover:bg-zinc-700/50 transition-colors ${s===l?"bg-[#E0FE10]/10 border border-[#E0FE10]":"bg-zinc-800/50"}`,children:(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsx)("div",{className:`w-12 h-12 rounded-full overflow-hidden border-2 
                      ${s===l?"border-[#E0FE10]":s<l?"border-zinc-600":"border-zinc-400"}`,children:e.logSubmitted?(0,i.jsx)("div",{className:"bg-[#E0FE10] w-full h-full flex items-center justify-center",children:(0,i.jsx)("span",{className:"text-black",children:"✓"})}):(0,i.jsx)("img",{src:e.exercise?.videos?.[0]?.gifURL||"/placeholder-exercise.gif",alt:e.exercise?.name||"Exercise",className:"w-full h-full object-cover",onError:e=>{e.target.src="/placeholder-exercise.gif"}})}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("p",{className:"text-white font-medium",children:e.exercise?.name}),(0,i.jsx)("p",{className:"text-zinc-400 text-sm",children:e.logSubmitted?"Completed":"Pending"})]})]})},e.id||s))}),(0,i.jsx)("button",{onClick:r,className:"w-full bg-[#E0FE10] text-black px-8 py-3 rounded-full font-medium hover:bg-[#E0FE10]/90 transition-colors mt-4",children:"Complete Move"})]})}),(0,i.jsxs)("div",{className:"lg:hidden absolute bottom-0 left-0 right-0 flex flex-col items-center py-10 space-y-4 z-20",children:[(0,i.jsx)("h2",{className:"text-white text-2xl font-bold mb-2",children:d?.name||""}),(0,i.jsx)("div",{className:"px-4 overflow-x-auto",children:(0,i.jsx)("div",{className:"flex gap-2 w-fit",children:t.map((e,s)=>(0,i.jsx)("div",{onClick:()=>c(s),className:`flex-shrink-0 relative w-10 h-10 rounded-full overflow-hidden border-2 
                    ${s===l?"border-[#E0FE10]":s<l?"border-zinc-600":"border-zinc-400"}`,children:e.logSubmitted?(0,i.jsx)("div",{className:"bg-[#E0FE10] w-full h-full flex items-center justify-center",children:(0,i.jsx)("span",{className:"text-black",children:"✓"})}):(0,i.jsx)("img",{src:e.exercise?.videos?.[0]?.gifURL||"/placeholder-exercise.gif",alt:e.exercise?.name||"Exercise",className:"w-full h-full object-cover",onError:e=>{e.target.src="/placeholder-exercise.gif"}})},e.id||s))})}),(0,i.jsx)("button",{onClick:r,className:"bg-[#E0FE10] text-black px-8 py-3 rounded-full font-medium hover:bg-[#E0FE10]/90 transition-colors",children:"Complete Move"})]})]}),(0,i.jsx)(_,{isOpen:f,onClose:()=>p(!1),title:"Cancel Workout",message:"Are you sure you want to cancel this workout? All progress will be lost.",primaryButtonText:"Yes, Cancel Workout",secondaryButtonText:"No, Continue",onPrimaryAction:()=>{n(),p(!1)},onSecondaryAction:()=>p(!1),theme:"dark"})]})},Y=t(8865),K=e=>{let{onClose:s,onCreateWorkout:t}=e,[l,r]=(0,a.useState)([]),n=e=>{r(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])};return(0,i.jsxs)("div",{className:"fixed inset-0 bg-zinc-900 flex flex-col min-h-screen",children:[(0,i.jsxs)("div",{className:"p-6 pb-2",children:[(0,i.jsx)("button",{onClick:s,className:"w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center",children:(0,i.jsx)(V.Z,{className:"text-white",size:20})}),(0,i.jsx)("h1",{className:"text-4xl font-bold text-white mt-6 mb-2",children:"Choose the body parts you want to workout."}),(0,i.jsx)("p",{className:"text-zinc-400 text-lg",children:"You can choose multiple body parts"})]}),(0,i.jsxs)("div",{className:"flex-1 p-6 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 overflow-y-auto max-w-6xl mx-auto scrollbar-hide",children:[(0,i.jsx)(J,{id:"body-parts/bicep",name:"Biceps",isSelected:l.includes("bicep"),onToggle:n}),(0,i.jsx)(J,{id:"body-parts/tricep",name:"Triceps",isSelected:l.includes("triceps"),onToggle:n}),(0,i.jsx)(J,{id:"body-parts/chest",name:"Chest",isSelected:l.includes("chest"),onToggle:n}),(0,i.jsx)(J,{id:"body-parts/calves",name:"Calves",isSelected:l.includes("calves"),onToggle:n}),(0,i.jsx)(J,{id:"body-parts/abs",name:"Abs",isSelected:l.includes("abs"),onToggle:n}),(0,i.jsx)(J,{id:"body-parts/hamstrings",name:"Hamstrings",isSelected:l.includes("hamstrings"),onToggle:n}),(0,i.jsx)(J,{id:"body-parts/back",name:"Back",isSelected:l.includes("back"),onToggle:n}),(0,i.jsx)(J,{id:"body-parts/deltoids",name:"Deltoids",isSelected:l.includes("deltoids"),onToggle:n}),(0,i.jsx)(J,{id:"body-parts/glutes",name:"Glutes",isSelected:l.includes("glutes"),onToggle:n}),(0,i.jsx)(J,{id:"body-parts/lats",name:"Lats",isSelected:l.includes("lats"),onToggle:n}),(0,i.jsx)(J,{id:"body-parts/lowerback",name:"Lower Back",isSelected:l.includes("lowerback"),onToggle:n}),(0,i.jsx)(J,{id:"body-parts/quadriceps",name:"Quadriceps",isSelected:l.includes("quadriceps"),onToggle:n}),(0,i.jsx)(J,{id:"body-parts/rhomboids",name:"Rhomboids",isSelected:l.includes("rhomboids"),onToggle:n})]}),l.length>0&&(0,i.jsx)("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-zinc-900/80 backdrop-blur-sm border-t border-zinc-800",children:(0,i.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,i.jsx)("button",{onClick:()=>t(l),className:"w-full py-4 rounded-full bg-[#E0FE10] text-black font-semibold text-lg",children:"Create workout"})})})]})};let J=e=>{let{id:s,name:t,isSelected:l,onToggle:r}=e;return(0,i.jsxs)("button",{onClick:()=>r(s),className:`relative aspect-square rounded-2xl bg-zinc-800/50 flex flex-col items-center justify-end
        ${l?"ring-2 ring-[#E0FE10]":""}
        max-w-[250px] w-full mx-auto`,children:[(0,i.jsx)("img",{src:`${s}.svg`,alt:t,className:"w-full h-full object-contain opacity-75"}),l&&(0,i.jsx)("div",{className:"absolute top-4 right-4 w-6 h-6 rounded-full bg-[#E0FE10] flex items-center justify-center",children:(0,i.jsx)(Y.Z,{className:"text-black",size:16})})]})};var ee=t(3967),es=t.n(ee),et=t(8496),el=t(5062);let er=e=>{let{icon:s,value:t,label:l}=e;return(0,i.jsxs)("div",{className:"flex items-center gap-2 text-zinc-400",children:[s,(0,i.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,i.jsx)("span",{className:"text-sm font-medium",children:t}),(0,i.jsx)("span",{className:"text-xs",children:l})]})]})};var ei=e=>{let{workout:s,onResume:t,onCancel:l}=e;return(0,i.jsxs)("div",{className:"bg-zinc-900 rounded-xl overflow-hidden",children:[(0,i.jsx)("div",{className:"p-4",children:(0,i.jsx)("div",{className:"flex justify-between items-start",children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("h3",{className:"text-white font-bold",children:s.title}),(0,i.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,i.jsx)(er,{icon:(0,i.jsx)("span",{className:"text-lg",children:"\uD83C\uDFC3"}),value:s.logs?.length.toString()||"0",label:"moves"}),(0,i.jsx)(er,{icon:(0,i.jsx)("span",{className:"text-lg",children:"⏰"}),value:s.duration.toString(),label:"min"}),(0,i.jsx)("span",{className:"px-3 py-1.5 text-xs bg-[#E0FE10]/20 text-[#E0FE10] rounded-full",children:s.zone})]})]})})}),(0,i.jsx)("div",{className:"px-4 py-2 flex gap-2",children:s.logs?.slice(0,3).map((e,s)=>i.jsx("div",{className:"w-[70px] h-[80px] rounded-xl overflow-hidden bg-zinc-800",children:i.jsx("img",{src:e.exercise.videos?.[0]?.gifURL||"/placeholder-exercise.gif",alt:e.exercise.name,className:"w-full h-full object-cover"})},s))}),(0,i.jsxs)("div",{className:"p-4 flex gap-3",children:[(0,i.jsxs)("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-red-500/20 text-red-500 font-medium text-sm",children:[(0,i.jsx)(V.Z,{size:16}),"Cancel"]}),(0,i.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-[#E0FE10]/20 text-[#E0FE10] font-medium text-sm",children:[(0,i.jsx)(el.Z,{size:16}),"Resume"]})]})]})};let ea=e=>{let{icon:s,value:t,label:l}=e;return(0,i.jsxs)("div",{className:"flex items-center gap-2 text-zinc-400",children:[s,(0,i.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,i.jsx)("span",{className:"text-sm font-medium",children:t}),(0,i.jsx)("span",{className:"text-xs",children:l})]})]})};var en=e=>{let{workout:s,onStart:t,onCancel:l}=e;return(0,i.jsxs)("div",{className:"bg-zinc-900 rounded-xl overflow-hidden",children:[(0,i.jsx)("div",{className:"p-4",children:(0,i.jsx)("div",{className:"flex justify-between items-start",children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("div",{className:"text-[#E0FE10] text-sm font-medium",children:"Ready to start"}),(0,i.jsx)("h3",{className:"text-white font-bold text-xl",children:s.title})]}),(0,i.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,i.jsx)(ea,{icon:(0,i.jsx)(p.Z,{className:"w-4 h-4 text-zinc-400"}),value:s.logs?.length.toString()||"0",label:"exercises"}),(0,i.jsx)(ea,{icon:(0,i.jsx)(H.Z,{className:"w-4 h-4 text-zinc-400"}),value:s.duration.toString(),label:"min"}),(0,i.jsx)("span",{className:"px-3 py-1.5 text-xs bg-[#E0FE10]/20 text-[#E0FE10] rounded-full",children:s.zone})]})]})})}),(0,i.jsx)("div",{className:"px-4 py-2 flex gap-2",children:s.logs?.slice(0,3).map((e,s)=>i.jsxs("div",{className:"w-[70px] h-[80px] rounded-xl overflow-hidden bg-zinc-800 relative group",children:[i.jsx("img",{src:e.exercise.videos?.[0]?.gifURL||"/placeholder-exercise.gif",alt:e.exercise.name,className:"w-full h-full object-cover"}),i.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx("span",{className:"text-xs text-white text-center px-2",children:e.exercise.name})})]},s))}),(0,i.jsxs)("div",{className:"p-4 flex gap-3",children:[(0,i.jsxs)("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-red-500/20 text-red-500 font-medium text-sm hover:bg-red-500/30 transition-colors",children:[(0,i.jsx)(V.Z,{size:16}),"Cancel"]}),(0,i.jsxs)("button",{onClick:t,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-xl bg-[#E0FE10] text-black font-medium text-sm hover:bg-[#E0FE10]/90 transition-colors",children:[(0,i.jsx)(el.Z,{size:16}),"Start Workout"]})]})]})},ec=e=>{let{isVisible:s,onClose:t,onStartWorkout:l}=e,r=(0,n.I0)(),o=(0,n.v9)(e=>e.workout.currentWorkout);(0,n.v9)(e=>e.workout.currentExerciseLogs);let[d,x]=(0,a.useState)(!0),[u,h]=(0,a.useState)([]),[g,f]=(0,a.useState)("today"),[p,b]=(0,a.useState)(!1),[j,v]=(0,a.useState)([]),N=(0,m.useRouter)();(0,a.useEffect)(()=>{s&&(console.log("We are visible!: "+o),y(),k(),E())},[s]);let w=e=>{if(!e)return 0;let s=new Date(e),t=new Date;return Math.max(0,Math.ceil((s.getTime()-t.getTime())/864e5))},y=async()=>{x(!0);try{let e=await et.G_.fetchCurrentWorkoutSession(c.W4.currentUser?.id||"");e&&(r((0,O.q1)(e.workout)),r((0,O.HX)(e.logs||[])))}catch(e){console.error("Error fetching workout:",e)}finally{x(!1)}},k=async()=>{try{let e=await C();h(e)}catch(e){console.error("Error fetching challenges:",e)}},E=async()=>{try{let e=await S();v(e)}catch(e){console.error("Error fetching recent workouts:",e)}},C=async()=>{try{let e=await et.G_.fetchActiveChallenges();console.log("User Challenges:",e);let s=e.length>0?e[0]:null;return s?console.log("Active Challenge:",s):console.log("No active challenges found."),e}catch(e){return console.error("Error fetching user challenges:",e),[]}},S=async()=>{try{let e=new Date;console.log("Fetching workouts for date:",e);let s=await et.G_.fetchAllWorkoutSummaries();return console.log("Here are the summaries:",s),s.slice(0,3).map(e=>G.P7.fromFirebase({id:e.id,workoutId:e.workoutId||"",exercises:e.exercises||[],bodyParts:e.bodyParts||[],secondaryBodyParts:e.secondaryBodyParts||[],workoutTitle:e.workoutTitle||"Untitled Workout",caloriesBurned:e.caloriesBurned||0,workoutRating:e.workoutRating,exercisesCompleted:e.exercisesCompleted||[],aiInsight:e.aiInsight||"",recommendations:e.recommendations||[],gifURLs:e.gifURLs||[],recommendedWork:e.recommendedWork,isCompleted:e.isCompleted||!1,createdAt:e.createdAt,updatedAt:e.updatedAt,completedAt:e.completedAt,duration:e.duration||""}))}catch(e){return console.error("Error fetching recent workouts:",e),[]}},z=()=>{b(!0)},F=async()=>{if(o)try{l&&await l(o),t()}catch(e){console.error("Error starting workout:",e)}},I=()=>{console.log("Workout canceled")},D=e=>{t(),N.push(`/round/${e.challengeId}`)},W=e=>e.toLocaleDateString(void 0,{month:"short",day:"numeric"}),U=e=>{console.log("Open summary for workout:",e)};return s?(0,i.jsx)(i.Fragment,{children:s&&(0,i.jsxs)("div",{className:"fixed inset-0 z-50 flex flex-col bg-[#E0FE10] overflow-hidden",children:[(0,i.jsx)("button",{onClick:t,className:"self-end m-4",children:(0,i.jsx)(V.Z,{size:24,className:"text-black"})}),(0,i.jsxs)("div",{className:"flex bg-black/10",children:[(0,i.jsx)("button",{onClick:()=>f("today"),className:es()("flex-1 py-3 text-center","today"===g?"border-b-2 border-black font-bold":""),children:"Today"}),(0,i.jsx)("button",{onClick:()=>f("rounds"),className:es()("flex-1 py-3 text-center","rounds"===g?"border-b-2 border-black font-bold":""),children:"Rounds"})]}),(0,i.jsx)("div",{className:"flex-1 overflow-y-auto",children:p?(0,i.jsx)(K,{onClose:()=>b(!1),onCreateWorkout:e=>{console.log("Creating workout with parts:",e),b(!1)}}):(0,i.jsxs)(i.Fragment,{children:["today"===g&&(()=>{if(d)return(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,i.jsx)("div",{className:"text-black",children:"Loading..."})});if(!et.G_.currentWorkout)return(0,i.jsxs)("div",{className:"flex flex-col p-8 bg-[#E0FE10] rounded-lg",children:[(0,i.jsx)("h3",{className:"text-2xl font-bold text-black mb-4",children:"You don't have your workout for today yet."}),(0,i.jsxs)("button",{onClick:z,className:"mt-2 flex items-center text-lg font-medium text-black",children:["Get a workout",(0,i.jsx)("svg",{className:"ml-2 w-6 h-6",viewBox:"0 0 24 24",fill:"none",children:(0,i.jsx)("path",{d:"M5 12h14m-7-7l7 7-7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),u.length>0&&(0,i.jsx)("div",{className:"mt-auto pt-8",children:(0,i.jsxs)("div",{className:"bg-black/10 rounded-full py-3 px-6 inline-flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-black",children:"Swipe to see"}),(0,i.jsxs)("span",{className:"font-bold text-black",children:[u.length," Active Rounds"]}),(0,i.jsx)("svg",{className:"w-4 h-4 text-black",viewBox:"0 0 24 24",fill:"none",children:(0,i.jsx)("path",{d:"M9 5l7 7-7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})})]});switch(et.G_.currentWorkout.workoutStatus){case G.Z0.QueuedUp:return(0,i.jsx)("div",{className:"p-6",children:(0,i.jsx)(en,{workout:et.G_.currentWorkout,onStart:F,onCancel:I})});case G.Z0.InProgress:return(0,i.jsx)("div",{className:"p-6",children:(0,i.jsx)(ei,{workout:et.G_.currentWorkout,onResume:F,onCancel:I})});default:return null}})(),"rounds"===g&&(()=>{let e=e=>{if(!e.challenge?.startDate||!e.challenge?.endDate)return 0;let s=new Date(e.challenge.startDate),t=new Date(e.challenge.endDate),l=new Date,r=t.getTime()-s.getTime();return Math.min(Math.max((l.getTime()-s.getTime())/r,0),1)};return(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsx)("h2",{className:"text-2xl font-bold text-black mb-4",children:"Active Rounds"}),0===u.length?(0,i.jsx)("p",{className:"text-black",children:"No active rounds"}):(0,i.jsx)("div",{className:"space-y-4",children:u.map(s=>(0,i.jsx)("button",{onClick:()=>D(s),className:"w-full text-left",children:(0,i.jsxs)("div",{className:"p-4 space-y-3 bg-zinc-800 rounded-xl",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("h3",{className:"text-white font-semibold",children:s.challenge?.title}),(0,i.jsxs)("span",{className:"text-[#E0FE10] text-sm",children:[w(s.challenge?.endDate),"d left"]})]}),(0,i.jsx)("div",{className:"h-2 bg-zinc-700 rounded-full overflow-hidden",children:(0,i.jsx)("div",{className:"h-full bg-[#E0FE10] rounded-full",style:{width:`${100*e(s)}%`}})}),(0,i.jsx)("div",{className:"flex justify-between text-sm text-white/70",children:(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,i.jsx)("path",{d:"M15.45 22c1.95.31 3.5-1.24 3.5-3.19V5.19c0-1.95-1.55-3.5-3.5-3.19m0 20H8.55c-1.95.31-3.5-1.24-3.5-3.19V5.19c0-1.95 1.55-3.5 3.5-3.19"})}),(0,i.jsxs)("span",{children:[s.currentStreak," day streak"]})]})})]},s.id)},s.id))})]})})(),"today"===g&&(0===j.length?null:(0,i.jsxs)("div",{className:"p-6 bg-[#E0FE10] rounded-lg mt-4",children:[(0,i.jsx)("h2",{className:"text-xl font-bold text-black mb-4",children:"Recent Workouts"}),(0,i.jsx)("div",{className:"space-y-4",children:j.slice(0,3).map(e=>(0,i.jsxs)("button",{onClick:()=>U(e),className:"w-full p-4 bg-black rounded-lg text-white flex justify-between items-center hover:bg-black/80 transition",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"font-bold",children:e.workoutTitle}),(0,i.jsxs)("p",{className:"text-sm",children:[W(e.createdAt)," \xb7 ",e.duration," min"]})]}),(0,i.jsxs)("span",{className:"font-bold",children:["Score: ",e.duration]})]},e.id))})]}))]})})]})}):null},eo=t(2171),ed=t(3859),ex=t(6605),eu=()=>{let[e,s]=(0,a.useState)(!1),t=(0,a.useRef)(null),l=(0,n.I0)(),r=(0,ed.v0)();(0,a.useEffect)(()=>{let e=e=>{t.current&&!t.current.contains(e.target)&&s(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let c=async()=>{try{await (0,ed.w7)(r),l((0,ex.av)(null))}catch(e){console.error("Error signing out:",e)}};return(0,i.jsxs)("div",{className:"relative",ref:t,children:[(0,i.jsx)("button",{onClick:()=>s(!e),className:"flex items-center justify-center hover:bg-zinc-800 rounded-full p-2 transition-colors duration-200",children:(0,i.jsx)(eo.Z,{className:`text-white w-6 h-6 transition-transform duration-200 ${e?"rotate-180":""}`})}),e&&(0,i.jsx)("div",{className:"absolute top-full right-0 mt-2 w-48 bg-zinc-800 rounded-lg shadow-lg border border-zinc-700 z-50 overflow-hidden",style:{transform:"translateX(-50%)"},children:(0,i.jsx)("div",{className:"px-4 py-2 hover:bg-zinc-700 transition-colors duration-200 cursor-pointer",onClick:c,children:(0,i.jsx)("span",{className:"text-white",children:"Sign Out"})})})]})},em=()=>{let[e,s]=(0,a.useState)(r.Discover),[t,l]=(0,a.useState)(!1),[c,x]=(0,a.useState)(0),{currentUser:u}=(0,n.v9)(e=>e.user),m=u?.id,g=(0,n.v9)(e=>e.workout.currentWorkout),f=(0,n.v9)(e=>e.workout.currentExerciseLogs),p=(0,n.v9)(e=>e.workout.workoutSummary),b=(0,n.I0)();(0,a.useEffect)(()=>{m&&(async()=>{try{let e=await I.G.fetchAllWorkoutSessions(m),s=e.filter(e=>e.workout?.workoutStatus===G.Z0.QueuedUp),t=e.filter(e=>e.workout?.workoutStatus===G.Z0.InProgress);if(t.length>0){let e=t[0],s=e.logs?.findIndex(e=>!e.logSubmitted)??0;b((0,O.q1)(e.workout)),b((0,O.HX)(e.logs||[])),x(s>=0?s:0)}else if(s.length>0){let e=s[0];b((0,O.q1)(e.workout)),b((0,O.HX)(e.logs||[]))}else b((0,O.q1)(null)),b((0,O.HX)([]))}catch(e){console.error("Error fetching workout sessions:",e)}})()},[m,b]);let v=(e,s)=>{b((0,O.q1)(e)),b((0,O.HX)(s))},N=()=>{if(g){let e=new G.oQ({...g,workoutStatus:G.Z0.InProgress});b((0,O.q1)(e))}},w=async()=>{if(!g||!f.length){console.error("No active workout or logs");return}f[c]?.exercise;let e=f[c]?.isBodyWeight,s=[...f];s[c]=new d.lg({...s[c],logSubmitted:!0,completedAt:new Date,updatedAt:new Date});try{if(g&&m){await I.G.updateWorkoutLogs({userId:m,workoutId:g.id,logs:s});let e=new G.P7({id:g.id,workoutId:g.id,userId:m,exercises:s.map(e=>e.toDictionary()),bodyParts:g.fetchPrimaryBodyParts(),secondaryBodyParts:g.fetchSecondaryBodyParts(),workoutTitle:g.title,exercisesCompleted:s.filter(e=>e.logSubmitted).map(e=>e.toDictionary()),isCompleted:!1,startTime:g.startTime||new Date,createdAt:g.createdAt||new Date,updatedAt:new Date});b((0,O.QU)(e)),await I.G.updateWorkoutLogs({userId:m,workoutId:g.id,logs:s})}e?await y(s):await k(s),b((0,O.HX)(s));let t=s.findIndex(e=>!e.logSubmitted);-1!==t?x(t):await C()}catch(e){console.error("Error submitting exercise:",e)}},y=e=>k(e.map(e=>new d.lg({...e,logs:e.logs.map(e=>new G.c_({...e,weight:0,isBodyWeight:!0,reps:e.reps||0}))}))),k=async e=>{try{g&&m&&await I.G.updateWorkoutLogs({userId:m,workoutId:g.id,logs:e}),b((0,O.HX)(e)),c<e.length-1?x(e=>e+1):await C()}catch(e){console.error("Error submitting exercise:",e)}},C=async()=>{},S=async()=>{if(g&&m)try{await I.G.cancelWorkout(g,p),x(0)}catch(e){console.error("Error canceling workout:",e)}},z=async e=>{try{if(m){let s=await I.G.saveWorkoutSession({userId:m,workout:e,logs:e.logs||[]});s&&(v(s,s.logs||[]),l(!1))}}catch(e){console.error("Error starting workout:",e)}};return(0,i.jsx)("div",{className:"min-h-screen bg-zinc-900",children:g?(()=>{if(!g)return null;switch(g.workoutStatus){case G.Z0.QueuedUp:return(0,i.jsx)(q,{workout:g,onClose:S,onStartWorkout:N});case G.Z0.InProgress:return(0,i.jsx)(Q,{exercises:g.logs||[],currentExerciseLogs:f,currentExerciseIndex:c,onComplete:w,onClose:S,onExerciseSelect:x});default:return null}})():(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("nav",{className:"px-4 py-4 bg-zinc-900/80 backdrop-blur-sm border-b border-zinc-800 sticky top-0 z-10 flex justify-between items-center",children:[(0,i.jsx)("div",{className:"flex items-center",children:(0,i.jsx)("img",{src:"/pulse-logo-white.svg",alt:"Pulse",className:"h-8"})}),(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("button",{className:"bg-[#E0FE10] text-black px-4 py-2 rounded-lg",onClick:()=>l(!0),children:"Start Workout"}),(0,i.jsx)(eu,{})]})]}),(0,i.jsx)("div",{className:"w-full",children:(()=>{switch(e){case r.Discover:return(0,i.jsx)(h,{});case r.Search:return(0,i.jsx)(j,{});case r.Create:return(0,i.jsx)(E,{});case r.Messages:return(0,i.jsx)(F,{});case r.Profile:return(0,i.jsx)(M,{});default:return null}})()}),(0,i.jsx)(o,{selectedTab:e,onTabChange:s}),(0,i.jsx)(ec,{isVisible:t,onClose:()=>l(!1),onStartWorkout:z})]})})}}}]);
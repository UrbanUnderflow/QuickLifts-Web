(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[390],{4433:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/CollectionView",function(){return a(9612)}])},8496:function(e,t,a){"use strict";a.d(t,{Bc:function(){return s.Bc},G_:function(){return l.G},P7:function(){return s.P7}});var l=a(8662),s=a(4454)},9612:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var l,s,r=a(5893),i=a(7294),o=a(1163),n=a(7066),u=a(8496),d=a(4454),c=a(1402);(l=s||(s={})).Together="together",l.Solo="solo",l.Locked="locked";class p{constructor(){console.log("WorkoutService instance created")}static get sharedInstance(){return p.instance||(p.instance=new p),p.instance}async fetchSavedWorkout(e,t){console.log(`Fetching saved workout. UserID: ${e}, WorkoutID: ${t}`);let a="https://firestore.googleapis.com/v1/projects/quicklifts-dd3f1/databases/(default)/documents",l=`${a}/users/${e}/MyCreatedWorkouts/${t}`;try{let s=await n.Z.get(l);if(200!==s.status)return console.error("Error response from server:",s.status,s.statusText),[null,null];let r=s.data.fields,i=this.parseWorkout(r),o=`${a}/users/${e}/MyCreatedWorkouts/${t}/logs`,u=await n.Z.get(o);if(200!==u.status)return[i,null];let d=(u.data.documents||[]).map(e=>this.parseExerciseLog(e.fields));return[i,d]}catch(e){return n.Z.isAxiosError(e)&&console.error("Axios error details:",e.response?.data),[null,null]}}async fetchCollectionWithSweatLists(e){let t=`https://firestore.googleapis.com/v1/projects/quicklifts-dd3f1/databases/(default)/documents/sweatlist-collection/${e}`;try{let e=await n.Z.get(t);if(200!==e.status)throw console.error("Error response from server:",e.status,e.statusText),Error("Failed to fetch collection");let a=e.data.fields,l=this.parseCollection(a),s=[];for(let e of l.sweatlistIds)try{let[t]=await this.fetchSavedWorkout(e.sweatlistAuthorId,e.id);t&&s.push(t)}catch(t){console.error(`Error fetching workout with ID ${e.id}:`,t)}return{collection:l,sweatLists:s}}catch(e){throw console.error("Error fetching collection with sweat lists:",e),e}}parseCollection(e){let t;let a=e.id?.stringValue||"",l=e.title?.stringValue||"",r=e.subtitle?.stringValue||"",i=e.challenge?.mapValue?.fields?this.parseChallenge(e.challenge.mapValue.fields):void 0,o=(e.sweatlistIds?.arrayValue?.values||[]).map(e=>({id:e.mapValue?.fields?.id?.stringValue||"",sweatlistAuthorId:e.mapValue?.fields?.sweatlistAuthorId?.stringValue||"",order:parseInt(e.mapValue?.fields?.order?.integerValue||"0")})),n=e.ownerId?.stringValue||"",u=parseFloat(e.createdAt?.doubleValue||"0"),d=parseFloat(e.updatedAt?.doubleValue||"0"),c=(e.participants?.arrayValue?.values||[]).map(e=>e.stringValue||"");return t=i?s.Together:e.privacy?.stringValue||s.Solo,{id:a,title:l,subtitle:r,challenge:i,sweatlistIds:o,ownerId:n,privacy:t,participants:c,createdAt:new Date(1e3*u),updatedAt:new Date(1e3*d)}}parseChallenge(e){if(!e)return;let t=e.status?.stringValue||"draft",a=this.parseParticipants(e.participants?.arrayValue?.values||[]),l=new Date(1e3*parseFloat(e.startDate?.doubleValue||"0")),s=new Date(1e3*parseFloat(e.endDate?.doubleValue||"0")),r=new Date(1e3*parseFloat(e.createdAt?.doubleValue||"0")),i=new Date(1e3*parseFloat(e.updatedAt?.doubleValue||"0"));return new c.t({id:e.id?.stringValue||"",title:e.title?.stringValue||"",subtitle:e.subtitle?.stringValue||"",status:t,participants:a,startDate:l,endDate:s,createdAt:r,updatedAt:i,introVideoURL:e.introVideoURL?.stringValue||void 0})}parseParticipants(e){return e.map(e=>{let t=e.mapValue?.fields||{};return{id:t.id?.stringValue||"",challengeId:t.challengeId?.stringValue||"",userId:t.userId?.stringValue||"",username:t.username?.stringValue||"",profileImage:this.parseProfileImage(t.profileImage?.mapValue?.fields||{}),progress:parseFloat(t.progress?.doubleValue||"0"),completedWorkouts:t.completedWorkouts?.arrayValue?.values?.map(e=>e.stringValue)||[],isCompleted:t.isCompleted?.booleanValue||!1,location:t.location?{latitude:parseFloat(t.location.mapValue?.fields?.latitude?.doubleValue||"0"),longitude:parseFloat(t.location.mapValue?.fields?.longitude?.doubleValue||"0")}:void 0,city:t.city?.stringValue||"",country:t.country?.stringValue,timezone:t.timezone?.stringValue,joinDate:new Date(1e3*parseFloat(t.joinDate?.doubleValue||"0")),createdAt:new Date(1e3*parseFloat(t.createdAt?.doubleValue||"0")),updatedAt:new Date(1e3*parseFloat(t.updatedAt?.doubleValue||"0")),pulsePoints:{baseCompletion:parseFloat(t.pulsePoints?.mapValue?.fields?.baseCompletion?.doubleValue||"0"),firstCompletion:parseFloat(t.pulsePoints?.mapValue?.fields?.firstCompletion?.doubleValue||"0"),streakBonus:parseFloat(t.pulsePoints?.mapValue?.fields?.streakBonus?.doubleValue||"0"),checkInBonus:parseFloat(t.pulsePoints?.mapValue?.fields?.checkInBonus?.doubleValue||"0"),effortRating:parseFloat(t.pulsePoints?.mapValue?.fields?.effortRating?.doubleValue||"0"),chatParticipation:parseFloat(t.pulsePoints?.mapValue?.fields?.chatParticipation?.doubleValue||"0"),locationCheckin:parseFloat(t.pulsePoints?.mapValue?.fields?.locationCheckin?.doubleValue||"0"),contentEngagement:parseFloat(t.pulsePoints?.mapValue?.fields?.contentEngagement?.doubleValue||"0"),encouragementSent:parseFloat(t.pulsePoints?.mapValue?.fields?.encouragementSent?.doubleValue||"0"),encouragementReceived:parseFloat(t.pulsePoints?.mapValue?.fields?.encouragementReceived?.doubleValue||"0")},currentStreak:parseInt(t.currentStreak?.integerValue||"0"),encouragedUsers:t.encouragedUsers?.arrayValue?.values?.map(e=>e.stringValue)||[],encouragedByUsers:t.encouragedByUsers?.arrayValue?.values?.map(e=>e.stringValue)||[],checkIns:(t.checkIns?.arrayValue?.values||[]).map(e=>new Date(1e3*parseFloat(e.doubleValue||"0")))}})}parseWorkout(e){let t=(e.exercises?.arrayValue?.values||[]).map(e=>{let t=e.mapValue?.fields?.exercise?.mapValue?.fields||{};return{exercise:this.parseExercise(t),groupId:parseInt(e.mapValue?.fields?.groupId?.integerValue||"0")}}),a=(e.logs?.arrayValue?.values||[]).map(e=>this.parseExerciseLog(e.mapValue?.fields||{}));return new d.oQ({id:e.id?.stringValue||"",collectionId:e.collectionId?.arrayValue?.values?.map(e=>e.stringValue)||[],roundWorkoutId:e.roundWorkoutId?.stringValue||"",exercises:t,challenge:e.challenge?.mapValue?.fields?this.parseChallenge(e.challenge.mapValue.fields):void 0,logs:a,title:e.title?.stringValue||"",description:e.description?.stringValue||"",duration:parseInt(e.duration?.integerValue||"0"),workoutRating:e.workoutRating?.stringValue,useAuthorContent:e.useAuthorContent?.booleanValue||!1,isCompleted:e.isCompleted?.booleanValue||!1,workoutStatus:e.workoutStatus?.stringValue||d.Z0.QueuedUp,startTime:e.startTime?.timestampValue?new Date(e.startTime.timestampValue):void 0,order:parseInt(e.order?.integerValue||"0"),author:e.author?.stringValue||"",createdAt:new Date(1e3*parseFloat(e.createdAt?.doubleValue||"0")),updatedAt:new Date(1e3*parseFloat(e.updatedAt?.doubleValue||"0")),zone:e.zone?.stringValue||u.Bc.FullBody,estimatedDuration:()=>parseInt(e.duration?.integerValue||"0"),determineWorkoutZone:()=>e.zone?.stringValue||u.Bc.FullBody,toDictionary:()=>({})})}parseExerciseLog(e){let t=e.id?.stringValue||"",a=e.workoutId?.stringValue||"",l=e.userId?.stringValue||"",s=e.feedback?.stringValue||"",r=e.note?.stringValue||"",i=e.recommendedWeight?.stringValue,o=e.isSplit?.booleanValue||!1,n=e.isBodyWeight?.booleanValue||!1,u=e.logSubmitted?.booleanValue||!1,d=e.logIsEditing?.booleanValue||!1,c=e.isCompleted?.booleanValue||!1,p=parseFloat(e.createdAt?.doubleValue||"0"),V=parseFloat(e.updatedAt?.doubleValue||"0");return{id:t,workoutId:a,userId:l,exercise:this.parseExercise(e.exercise?.mapValue?.fields||{}),logs:(e.log?.arrayValue?.values||[]).map(e=>{let t=e.mapValue?.fields||{};return{reps:parseInt(t.reps?.integerValue||"0"),weight:parseFloat(t.weight?.doubleValue||"0"),leftReps:parseInt(t.leftReps?.integerValue||"0"),leftWeight:parseFloat(t.leftWeight?.doubleValue||"0"),isSplit:t.isSplit?.booleanValue||!1,isBodyWeight:t.isBodyWeight?.booleanValue||!1,isCompleted:t.isCompleted?.booleanValue||!1,duration:parseInt(t.duration?.integerValue||"0"),calories:parseInt(t.calories?.integerValue||"0"),bpm:parseInt(t.bpm?.integerValue||"0")}}),feedback:s,note:r,recommendedWeight:i,isSplit:o,isBodyWeight:n,logSubmitted:u,logIsEditing:d,isCompleted:c,createdAt:new Date(1e3*p),updatedAt:new Date(1e3*V)}}parseExercise(e){return{id:e.id?.stringValue||"",name:e.name?.stringValue||"",category:this.parseExerciseCategory(e.category?.mapValue?.fields||{}),primaryBodyParts:this.parseBodyParts(e.primaryBodyParts),secondaryBodyParts:this.parseBodyParts(e.secondaryBodyParts),tags:e.tags?.arrayValue?.values?.map(e=>e.stringValue)||[],description:e.description?.stringValue||"",visibility:e.visibility?.arrayValue?.values?.map(e=>e.stringValue)||[],steps:e.steps?.arrayValue?.values?.map(e=>e.stringValue)||[],videos:this.parseVideos(e.videos),currentVideoPosition:parseInt(e.currentVideoPosition?.integerValue||"0"),reps:e.reps?.stringValue||"",sets:parseInt(e.sets?.integerValue||"0"),weight:parseFloat(e.weight?.doubleValue||"0"),author:this.parseExerciseAuthor(e.author?.mapValue?.fields||{}),createdAt:new Date(1e3*parseFloat(e.createdAt?.doubleValue||"0")),updatedAt:new Date(1e3*parseFloat(e.updatedAt?.doubleValue||"0"))}}parseExerciseCategory(e){return"cardio"===(e.id?.stringValue||"")?{type:"cardio",details:{duration:parseInt(e.duration?.integerValue||"0"),bpm:parseInt(e.bpm?.integerValue||"0"),calories:parseInt(e.calories?.integerValue||"0"),screenTime:parseInt(e.screenTime?.integerValue||"0"),selectedVideo:this.parseExerciseVideo(e.selectedVideo?.mapValue?.fields)}}:{type:"weightTraining",details:{reps:e.reps?.stringValue||"",sets:parseInt(e.sets?.integerValue||"0"),weight:parseFloat(e.weight?.doubleValue||"0"),screenTime:parseInt(e.screenTime?.integerValue||"0"),selectedVideo:this.parseExerciseVideo(e.selectedVideo?.mapValue?.fields)}}}parseBodyParts(e){return(e?.arrayValue?.values||[]).map(e=>e.stringValue)}parseVideos(e){return(e?.arrayValue?.values||[]).map(e=>this.parseExerciseVideo(e.mapValue?.fields||{}))}parseExerciseVideo(e){return{id:e.id?.stringValue||"",exerciseId:e.exerciseId?.stringValue||"",username:e.username?.stringValue||"",userId:e.userId?.stringValue||"",videoURL:e.videoURL?.stringValue||"",fileName:e.fileName?.stringValue||"",exercise:e.exercise?.stringValue||"",profileImage:this.parseProfileImage(e.profileImage?.mapValue?.fields||{}),caption:e.caption?.stringValue||"",gifURL:e.gifURL?.stringValue||"",thumbnail:e.thumbnail?.stringValue||"",visibility:e.visibility?.stringValue||"open",totalAccountsReached:parseInt(e.totalAccountsReached?.integerValue||"0"),totalAccountLikes:parseInt(e.totalAccountLikes?.integerValue||"0"),totalAccountBookmarked:parseInt(e.totalAccountBookmarked?.integerValue||"0"),totalAccountUsage:parseInt(e.totalAccountUsage?.integerValue||"0"),isApproved:e.isApproved?.booleanValue||!1,liked:e.liked?.booleanValue,bookmarked:e.bookmarked?.booleanValue,createdAt:new Date(1e3*parseFloat(e.createdAt?.doubleValue||"0")),updatedAt:new Date(1e3*parseFloat(e.updatedAt?.doubleValue||"0"))}}parseProfileImage(e){return{profileImageURL:e.profileImageURL?.stringValue||"",imageOffsetWidth:parseFloat(e.imageOffsetWidth?.doubleValue||"0"),imageOffsetHeight:parseFloat(e.imageOffsetHeight?.doubleValue||"0")}}parseComments(e){return(e?.arrayValue?.values||[]).map(e=>this.parseComment(e.mapValue?.fields||{}))}parseComment(e){return{id:e.id?.stringValue||"",username:e.username?.stringValue||"",text:e.text?.stringValue||"",createdAt:new Date(1e3*parseFloat(e.createdAt?.doubleValue||"0")),updatedAt:new Date(1e3*parseFloat(e.updatedAt?.doubleValue||"0"))}}parseExerciseAuthor(e){return{userId:e.userId?.stringValue||"",username:e.username?.stringValue||""}}}var V=e=>{let{workout:t}=e,a=t.exercises.slice(0,3);return(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-white",children:t.title}),(0,r.jsx)("div",{className:"flex space-x-2 mt-2",children:a.map((e,t)=>{let{exercise:a}=e,l=a.videos[a.currentVideoPosition]?.videoURL;return(0,r.jsx)("div",{className:"w-1/3 h-24 relative",children:l?(0,r.jsx)("video",{src:l,className:"object-cover w-full h-full rounded-lg",muted:!0,autoPlay:!0,loop:!0}):(0,r.jsx)("div",{className:"w-full h-full bg-gray-600 flex items-center justify-center rounded-lg",children:(0,r.jsx)("span",{className:"text-white text-xs",children:"No video"})})},t)})})]})},g=()=>{let e=(0,o.useRouter)(),[t,a]=(0,i.useState)(null),[l,s]=(0,i.useState)([]),[n,u]=(0,i.useState)(null),[d,c]=(0,i.useState)(!0),g=e.query.collectionId||"57D465B8-A48B-46BF-A76A-3B4EC8D52470";return((0,i.useEffect)(()=>{(async()=>{try{c(!0);let e=await p.sharedInstance.fetchCollectionWithSweatLists(g);console.log(`There are ${e.sweatLists.length} sweatlists in this collection`),e?(a(e.collection),s(e.sweatLists||[])):u("No collection data returned")}catch(e){u(e instanceof Error?e.message:"An unknown error occurred")}finally{c(!1)}})()},[g]),d)?(0,r.jsx)("div",{className:"text-white text-center pt-20",children:"Loading collection..."}):n||!t?(0,r.jsxs)("div",{className:"text-white text-center pt-20",children:["Error loading collection: ",n||"Unknown error"]}):(0,r.jsxs)("div",{className:"relative h-screen bg-black",children:[(0,r.jsx)("div",{className:"fixed top-0 left-0 right-0 bg-[#E0FE10] text-black py-2 px-4 text-center z-50",children:(0,r.jsxs)("p",{className:"font-bold",children:["Download the Pulse app for full access to this collection",(0,r.jsx)("button",{onClick:()=>window.open("https://apps.apple.com/us/app/pulse-the-fitness-collective/id6451497729","_blank"),className:"underline ml-2 font-bold bg-transparent border-none cursor-pointer",children:"Get App"})]})}),(0,r.jsx)("div",{className:"absolute inset-0 mt-80 overflow-y-auto bg-gradient-to-b from-transparent via-[#192126] via-25% to-[#192126] to-50%",children:(0,r.jsx)("div",{className:"flex flex-col min-h-full p-4 pb-20 pt-12",children:(0,r.jsxs)("div",{className:"flex-grow",children:[(0,r.jsxs)("div",{className:"text-center text-white mt-10 mb-1",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Your collection for today:"}),(0,r.jsx)("p",{className:"text-xl font-bold text-[#E0FE10]",children:t.title}),(0,r.jsx)("p",{className:"text-m text-white mt-2",children:t.subtitle||""})]}),(0,r.jsx)("div",{className:"flex justify-around my-10",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-2xl font-bold text-[#E0FE10]",children:l.length}),(0,r.jsx)("p",{className:"text-m text-white",children:"Sweat Lists"})]})}),(0,r.jsx)("div",{className:"mt-6 mb-28",children:l.map(e=>(0,r.jsx)(V,{workout:e},e.id))})]})})}),(0,r.jsx)("div",{className:"fixed bottom-0 left-0 right-0 p-10 bg-gradient-to-t from-black to-transparent",children:(0,r.jsx)("button",{onClick:()=>window.open("https://apps.apple.com/us/app/pulse-the-fitness-collective/id6451497729","_blank"),className:"w-full py-3 bg-[#E0FE10] text-black font-bold rounded-full text-lg",children:"Track this Collection"})})]})}}},function(e){e.O(0,[16,693,311,376,66,662,888,774,179],function(){return e(e.s=4433)}),_N_E=e.O()}]);
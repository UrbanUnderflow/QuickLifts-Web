(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[554],{6766:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/join-challenge",function(){return s(816)}])},3530:function(e,t,s){"use strict";s.d(t,{cd:function(){return d},lg:function(){return a},mn:function(){return r}});var i,r,o=s(4454),n=s(1316);(i=r||(r={})).Biceps="biceps",i.Triceps="triceps",i.Chest="chest",i.Calves="calves",i.Abs="abs",i.Hamstrings="hamstrings",i.Back="back",i.Glutes="glutes",i.Quadriceps="quadriceps",i.Forearms="forearms",i.Shoulders="shoulders",i.Lowerback="lowerback",i.Lats="lats",i.Traps="traps",i.Rhomboids="rhomboids",i.Deltoids="deltoids",i.Fullbody="fullbody";class a{constructor(e){this.id=e.id||"",this.workoutId=e.workoutId||"",this.userId=e.userId||"",this.exercise=d.fromFirebase(e.exercise||{}),this.logs=(e.logs||[]).map(e=>o.c_.fromFirebase(e)),this.feedback=e.feedback||"",this.note=e.note||"",this.recommendedWeight=e.recommendedWeight,this.isSplit=e.isSplit||!1,this.isBodyWeight=e.isBodyWeight||!1,this.logSubmitted=e.logSubmitted||!1,this.logIsEditing=e.logIsEditing||!1,this.isCompleted=e.isCompleted||!1,this.order=e.order,this.createdAt=e.createdAt?new Date(e.createdAt):new Date,this.updatedAt=e.updatedAt?new Date(e.updatedAt):new Date}static fromFirebase(e){return new a({id:e.id||"",workoutId:e.workoutId||"",userId:e.userId||"",exercise:e.exercise||{},logs:e.logs||[],feedback:e.feedback||"",note:e.note||"",recommendedWeight:e.recommendedWeight,isSplit:e.isSplit||!1,isBodyWeight:e.isBodyWeight||!1,logSubmitted:e.logSubmitted||!1,logIsEditing:e.logIsEditing||!1,isCompleted:e.isCompleted||!1,order:e.order,createdAt:e.createdAt,updatedAt:e.updatedAt})}}class d{constructor(e){this.id=e.id||"",this.name=e.name||"",this.description=e.description||"",this.category=e.category,this.primaryBodyParts=e.primaryBodyParts||[],this.secondaryBodyParts=e.secondaryBodyParts||[],this.tags=e.tags||[],this.videos=(e.videos||[]).map(e=>c.fromFirebase(e)),this.steps=e.steps||[],this.visibility=e.visibility||[],this.currentVideoPosition=e.currentVideoPosition||0,this.sets=e.sets||0,this.reps=e.reps||"",this.weight=e.weight||0,this.author=u.fromFirebase(e.author||{}),this.createdAt=e.createdAt?new Date(e.createdAt):new Date,this.updatedAt=e.updatedAt?new Date(e.updatedAt):new Date}static fromFirebase(e){return new d({id:e.id||"",name:e.name||"",description:e.description||"",category:e.category||{},primaryBodyParts:e.primaryBodyParts||[],secondaryBodyParts:e.secondaryBodyParts||[],tags:e.tags||[],videos:e.videos||[],steps:e.steps||[],visibility:e.visibility||[],currentVideoPosition:e.currentVideoPosition||0,sets:e.sets||0,reps:e.reps||"",weight:e.weight||0,author:e.author||{},createdAt:e.createdAt,updatedAt:e.updatedAt})}}class c{constructor(e){this.id=e.id||"",this.exerciseId=e.exerciseId||"",this.username=e.username||"",this.userId=e.userId||"",this.videoURL=e.videoURL||"",this.fileName=e.fileName||"",this.exercise=e.exercise||"",this.profileImage=n.m1.fromFirebase(e.profileImage||{}),this.caption=e.caption,this.gifURL=e.gifURL,this.thumbnail=e.thumbnail,this.visibility=e.visibility||"private",this.totalAccountsReached=e.totalAccountsReached||0,this.totalAccountLikes=e.totalAccountLikes||0,this.totalAccountBookmarked=e.totalAccountBookmarked||0,this.totalAccountUsage=e.totalAccountUsage||0,this.isApproved=e.isApproved||!1,this.liked=e.liked||!1,this.bookmarked=e.bookmarked||!1,this.createdAt=e.createdAt?new Date(e.createdAt):new Date,this.updatedAt=e.updatedAt?new Date(e.updatedAt):new Date}static fromFirebase(e){return new c({id:e.id||"",exerciseId:e.exerciseId||"",username:e.username||"",userId:e.userId||"",videoURL:e.videoURL||"",fileName:e.fileName||"",exercise:e.exercise||"",profileImage:e.profileImage||{},caption:e.caption,gifURL:e.gifURL,thumbnail:e.thumbnail,visibility:e.visibility||"private",totalAccountsReached:e.totalAccountsReached||0,totalAccountLikes:e.totalAccountLikes||0,totalAccountBookmarked:e.totalAccountBookmarked||0,totalAccountUsage:e.totalAccountUsage||0,isApproved:e.isApproved||!1,liked:e.liked||!1,bookmarked:e.bookmarked||!1,createdAt:e.createdAt,updatedAt:e.updatedAt})}}class u{static fromFirebase(e){return{userId:e.userId||"",username:e.username||""}}}},4454:function(e,t,s){"use strict";s.d(t,{Z0:function(){return o},c_:function(){return c},oQ:function(){return u}});var i,r,o,n,a=s(6928),d=s(3530);(i=o||(o={})).QueuedUp="queuedUp",i.InProgress="inProgress",i.Complete="complete",i.Archived="archived",(r=n||(n={})).TooHard="Too Hard",r.TooEasy="Too Easy",r.JustRight="Just Right";class c{static fromFirebase(e){return{reps:e.reps||0,weight:e.weight||0,leftReps:e.leftReps||0,leftWeight:e.leftWeight||0,isSplit:e.isSplit||!1,isBodyWeight:e.isBodyWeight||!1,duration:e.duration||0,calories:e.calories||0,bpm:e.bpm||0}}}class u{constructor(e){this.id=e.id,this.collectionId=e.collectionId,this.roundWorkoutId=e.roundWorkoutId,this.exercises=e.exercises,this.challenge=e.challenge,this.logs=e.logs,this.title=e.title,this.description=e.description,this.duration=e.duration,this.workoutRating=e.workoutRating,this.useAuthorContent=e.useAuthorContent,this.isCompleted=e.isCompleted,this.workoutStatus=e.workoutStatus,this.startTime=e.startTime,this.order=e.order,this.author=e.author,this.createdAt=e.createdAt,this.updatedAt=e.updatedAt,this.zone=this.determineWorkoutZone()}estimatedDuration(){return this.duration}determineWorkoutZone(){let e=new Set;for(let t of this.exercises)for(let s of t.exercise.primaryBodyParts||[t.exercise.primaryBodyParts])e.add(s);let t=new Set([d.mn.Chest,d.mn.Shoulders,d.mn.Biceps,d.mn.Triceps,d.mn.Traps,d.mn.Lats,d.mn.Forearms]),s=new Set([d.mn.Hamstrings,d.mn.Glutes,d.mn.Quadriceps,d.mn.Calves]),i=new Set([d.mn.Abs,d.mn.Lowerback]),r=(e,t)=>Array.from(e).some(e=>t.has(e)),o=r(e,t),n=r(e,s),c=r(e,i);return o&&n&&c||o&&n?a.B.FullBody:o&&c||o?a.B.UpperBody:n&&c||n?a.B.LowerBody:c?a.B.Core:a.B.FullBody}toDictionary(){return{id:this.id,collectionId:this.collectionId,roundWorkoutId:this.roundWorkoutId,exercises:this.exercises,challenge:this.challenge,logs:this.logs,title:this.title,description:this.description,duration:this.duration,workoutRating:this.workoutRating,useAuthorContent:this.useAuthorContent,isCompleted:this.isCompleted,workoutStatus:this.workoutStatus,startTime:this.startTime,order:this.order,author:this.author,createdAt:this.createdAt,updatedAt:this.updatedAt}}}},816:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var i=s(5893),r=s(7294),o=s(1163),n=s(9828),a=s(6718),d=s(7705),c=s(4454);class u{async fetchCurrentWorkout(){return(await this.fetchCurrentWorkoutSession()).workout}async fetchCurrentWorkoutSession(){let e=d.W4.currentUser;if(!e?.id)throw Error("No user is signed in");let t=(0,n.hJ)(a.db,"users",e.id,"workoutSessions"),s=(0,n.IO)(t,(0,n.ar)("status","==",c.Z0.QueuedUp)),i=await (0,n.PL)(s);return i.empty&&(s=(0,n.IO)(t,(0,n.ar)("status","==",c.Z0.InProgress)),(i=await (0,n.PL)(s)).empty)?{workout:null,logs:null}:this.processWorkoutSessionDocument(i.docs[0])}async processWorkoutSessionDocument(e){let t=e.data();return{workout:{id:e.id,...t,createdAt:t.createdAt?.toDate()??new Date,updatedAt:t.updatedAt?.toDate()??new Date},logs:[]}}async joinChallenge(e){let{username:t,challengeId:s}=e;if(!d.W4.currentUser)throw Error("No user is signed in");let i=(0,n.hJ)(a.db,"users"),r=(0,n.IO)(i,(0,n.ar)("username","==",t)),o=await (0,n.PL)(r);if(o.empty)throw Error("User not found");let c=o.docs[0],u=c.data(),l=c.id,h=(0,n.JU)(a.db,"sweatlist-collection",s),m=await (0,n.QT)(h);if(!m.exists())throw Error("Challenge not found");let p=m.data(),g=`${s}-${l}-${Date.now()}`,f={id:g,challenge:p,challengeId:s,userId:l,fcmToken:u.fcmToken||"",profileImage:u.profileImage||{},progress:0,completedWorkouts:[],isCompleted:!1,uid:l,location:u.location||null,city:"",country:"",timezone:"",username:t,joinDate:new Date,createdAt:new Date,updatedAt:new Date,pulsePoints:{baseCompletion:0,firstCompletion:0,streakBonus:0,checkInBonus:0,effortRating:0,chatParticipation:0,locationCheckin:0,contentEngagement:0,encouragementSent:0,encouragementReceived:0},currentStreak:0,encouragedUsers:[],encouragedByUsers:[],checkIns:[]};await (0,n.pl)((0,n.JU)(a.db,"user-challenge",g),f)}constructor(){this.currentWorkout=null}}let l=new u;var h=s(1259),m=s(5612);function p(){let[e,t]=(0,r.useState)(""),[s,n]=(0,r.useState)(!1),[c,u]=(0,r.useState)(""),[p,g]=(0,r.useState)(!1),[f,k]=(0,r.useState)(!1),y=(0,o.useRouter)();(0,r.useEffect)(()=>{let e=(0,h.Aj)(a.I,async e=>{if(e)try{let t=await d.W4.fetchUserFromFirestore(e.uid);d.W4.currentUser=t,console.log("User data fetched and set:",t),g(!0),k(!1)}catch(e){console.error("Error fetching user data:",e),u("Error loading user data")}else d.W4.currentUser=null,g(!1),k(!0)});return()=>e()},[]);let b=async t=>{if(t.preventDefault(),!e.trim()){u("Username is required");return}try{n(!0),u(""),await l.joinChallenge({username:e,challengeId:"cevWHBlBk7VobANRUsmC"}),y.push("/challenge-joined")}catch(e){console.error(e),u(e instanceof Error?e.message:"Failed to join challenge")}finally{n(!1)}};return p?(0,i.jsx)("div",{className:"min-h-screen bg-zinc-900 flex flex-col items-center justify-center p-4",children:(0,i.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("h1",{className:"text-4xl sm:text-5xl font-bold text-white font-['Thunder'] mb-4",children:"Join Jaidus's Challenge"}),(0,i.jsx)("p",{className:"text-zinc-400 text-lg",children:"30 Days of Shared Progress"})]}),(0,i.jsxs)("form",{onSubmit:b,className:"mt-8 space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-zinc-300 mb-2 font-['HK Grotesk']",children:"Username"}),(0,i.jsx)("input",{id:"username",type:"text",value:e,onChange:e=>t(e.target.value),className:"w-full bg-zinc-800 border border-zinc-600 rounded-lg p-3 text-white placeholder-zinc-400 focus:outline-none focus:border-[#E0FE10] focus:ring-1 focus:ring-[#E0FE10] transition-colors",placeholder:"Enter your username"}),c&&(0,i.jsx)("p",{className:"mt-2 text-red-400 text-sm",children:c})]}),(0,i.jsx)("button",{type:"submit",disabled:s,className:`w-full bg-[#E0FE10] text-black font-semibold py-4 px-4 rounded-lg
              hover:bg-[#c8e60e] transition-colors font-['HK Grotesk'] flex items-center justify-center
              ${s?"opacity-50 cursor-not-allowed":""}`,children:s?(0,i.jsx)("div",{className:"w-6 h-6 border-2 border-black border-t-transparent rounded-full animate-spin"}):"Join Challenge"})]}),(0,i.jsx)("div",{className:"text-center mt-4",children:(0,i.jsx)("button",{onClick:()=>y.back(),className:"text-zinc-400 hover:text-[#E0FE10] transition-colors text-sm",children:"← Back"})})]})}):(0,i.jsx)(m.Z,{isVisible:f,onClose:()=>k(!1),onSignInSuccess:e=>{console.log("Sign-in successful:",e),g(!0),k(!1)},onSignInError:e=>{console.error("Sign-in error:",e),alert("Sign-in failed. Please try again.")},onSignUpSuccess:e=>{console.log("Sign-up successful:",e),g(!0),k(!1)},onSignUpError:e=>{console.error("Sign-up error:",e),alert("Sign-up failed. Please try again.")},onQuizComplete:()=>{console.log("Quiz completed successfully")},onQuizSkipped:()=>{console.log("Quiz skipped")}})}},6928:function(e,t,s){"use strict";var i,r;s.d(t,{B:function(){return i}}),(r=i||(i={})).LowerBody="Lower Body",r.UpperBody="Upper Body",r.FullBody="Full Body",r.Core="Core"},1163:function(e,t,s){e.exports=s(3079)}},function(e){e.O(0,[16,693,478,594,501,612,888,774,179],function(){return e(e.s=6766)}),_N_E=e.O()}]);
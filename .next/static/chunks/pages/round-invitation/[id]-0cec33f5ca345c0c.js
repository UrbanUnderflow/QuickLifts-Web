(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[377],{2942:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/round-invitation/[id]",function(){return n(51)}])},3346:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(1134).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},39:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(1134).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},4795:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(1134).Z)("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]])},5062:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(1134).Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},4420:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(1134).Z)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]])},8267:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(1134).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},9176:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(1134).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},51:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return R},default:function(){return I}});var l=n(5893),s=n(7294),i=n(1163),a=n(5062),c=n(9176),r=n(3346),o=n(39),d=n(4795),u=n(1134);let h=(0,u.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var x=n(8267),m=n(4420);let p=(0,u.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var f=e=>{let{challenge:t}=e,[n,i]=(0,s.useState)(!1),a=[{title:"Download Pulse",description:"Get the Pulse app from the App Store to join this challenge",icon:(0,l.jsx)(h,{className:"w-8 h-8 text-[#E0FE10]"})},{title:"Create Account",description:"Sign up for an account to start your fitness journey",icon:(0,l.jsx)(x.Z,{className:"w-8 h-8 text-[#E0FE10]"})},{title:"Return Here",description:"Come back to this page and tap 'Join Challenge' to get started",icon:(0,l.jsx)(m.Z,{className:"w-8 h-8 text-[#E0FE10]"})}],c=encodeURIComponent(`https://www.quickliftsapp.com/?linkType=round&roundId=${t.id}`),r=`https://quicklifts.page.link/?link=${c}&apn=com.pulse.fitnessapp&ibi=Tremaine.QuickLifts&isi=6451497729`,o=`https://fitwithpulse.ai/round/${t.id}`;return n?(0,l.jsx)("div",{className:"fixed inset-0 bg-zinc-950 z-50 overflow-y-auto",children:(0,l.jsx)("div",{className:"min-h-screen px-4 text-center",children:(0,l.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen",children:(0,l.jsxs)("div",{className:"bg-zinc-900 p-6 rounded-2xl max-w-md w-full mx-auto",children:[(0,l.jsxs)("h2",{className:"text-2xl font-bold text-white mb-8",children:["Join ",t.title]}),(0,l.jsx)("div",{className:"space-y-8",children:a.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:e.icon}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-white",children:e.title}),(0,l.jsx)("p",{className:"text-zinc-400 mt-1",children:e.description})]}),t<a.length-1&&(0,l.jsx)(p,{className:"w-5 h-5 text-zinc-600 transform rotate-90 mt-2"})]},t))}),(0,l.jsxs)("div",{className:"mt-8 space-y-4",children:[(0,l.jsx)("a",{href:"https://apps.apple.com/ca/app/pulse-community-workouts/id6451497729",className:"w-full flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-xl text-black bg-[#E0FE10] hover:bg-[#E0FE10]/90",children:"Download iOS App"}),(0,l.jsx)("button",{onClick:()=>{window.location.href=r},className:"w-full px-8 py-3 text-base font-medium rounded-xl text-white bg-zinc-800 hover:bg-zinc-700",children:"I already have the iOS app"}),(0,l.jsx)("button",{onClick:()=>{console.log("the web url is: ",o),window.location.href=o},className:"w-full px-8 py-3 text-base font-medium rounded-xl text-white bg-zinc-800 hover:bg-zinc-700",children:"I'm on a laptop or Android Device"})]})]})})})}):(0,l.jsx)("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-zinc-950 border-t border-zinc-800",children:(0,l.jsx)("button",{onClick:()=>{i(!0)},className:"w-full flex items-center justify-center px-8 py-4 text-lg font-medium rounded-xl text-black bg-[#E0FE10] hover:bg-[#E0FE10]/90",children:"Join Round"})})};let g=e=>("string"==typeof e?new Date(e):e).toLocaleDateString("en-US",{month:"long",day:"numeric"}),y=(e,t)=>{let n="string"==typeof e?new Date(e):e;return Math.ceil(Math.abs(("string"==typeof t?new Date(t):t).getTime()-n.getTime())/864e5)},j=e=>{let{title:t,value:n,icon:s}=e;return(0,l.jsx)("div",{className:"flex-1 p-4 bg-zinc-900 rounded-xl",children:(0,l.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[s,(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-lg font-semibold text-white",children:n}),(0,l.jsx)("span",{className:"text-sm text-white/70",children:t})]})]})})},w=e=>{let{introVideos:t}=e,[n,i]=(0,s.useState)(""),[c,r]=(0,s.useState)(!1),o=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("id");e&&i(e)},[]);let d=t?.find(e=>e.userId===n)?.videoUrl;return((0,s.useEffect)(()=>{let e=async()=>{if(o.current)try{await o.current.play(),r(!0)}catch(e){console.error("Autoplay failed:",e)}};d&&e()},[d]),d)?(0,l.jsxs)("div",{className:"relative bg-black rounded-xl h-48 mb-8 overflow-hidden",children:[(0,l.jsx)("video",{ref:o,className:"w-full h-full object-cover",src:d,controls:c,playsInline:!0,autoPlay:!0,muted:!0}),!c&&(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 cursor-pointer",onClick:()=>{o.current?.play(),r(!0)},children:(0,l.jsx)(a.Z,{className:"w-8 h-8 text-white/90"})})]}):(0,l.jsx)("div",{className:"relative bg-black rounded-xl h-48 mb-8 flex items-center justify-center",children:(0,l.jsx)(a.Z,{className:"w-8 h-8 text-white/90"})})},b=e=>{let{userId:t}=e,n=(0,i.useRouter)(),[a,r]=(0,s.useState)({});return((0,s.useEffect)(()=>{let e=async()=>{try{let e=await fetch(`https://fitwithpulse.ai/.netlify/functions/get-user-by-id?id=${t}`),n=await e.json();console.log("API Response:",n),n.success&&r({username:n.user.username,profileImage:n.user.profileImage})}catch(e){console.error("Error fetching host data:",e)}};t&&e()},[t]),a.username)?(0,l.jsx)("div",{className:"flex items-center justify-center gap-3 mb-8 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>n.push(`/profile/${a.username}`),role:"button","aria-label":`View ${a.username}'s profile`,children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[a.profileImage?.profileImageURL?(0,l.jsx)("img",{src:a.profileImage.profileImageURL,alt:a.username,className:"w-10 h-10 rounded-full object-cover"}):(0,l.jsx)("div",{className:"w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center",children:(0,l.jsx)(c.Z,{className:"w-6 h-6 text-zinc-400"})}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{className:"text-sm text-white/70",children:"Hosted by"}),(0,l.jsx)("span",{className:"font-medium",children:a.username})]})]})}):null};var v=e=>{let{challenge:t}=e,n=new Date(t.startDate),i=new Date(t.endDate),[a,u]=(0,s.useState)(""),h=t.participants?.length??0;return(0,s.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("id");e&&u(e)},[]),(0,l.jsx)("div",{className:"min-h-screen bg-zinc-950 text-white",children:(0,l.jsxs)("div",{className:"max-w-2xl mx-auto px-6 py-8",children:[(0,l.jsxs)("div",{className:"text-center space-y-4 mb-8",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white/90",children:"You're invited to participate in this Round \uD83C\uDF89"}),(0,l.jsx)("h1",{className:"text-3xl font-bold",children:t.title}),(0,l.jsx)("p",{className:"text-white/70",children:t.subtitle})]}),a&&(0,l.jsx)(b,{userId:a}),(0,l.jsx)(w,{introVideos:t.introVideos}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-12",children:[(0,l.jsx)(j,{title:"Duration",value:`${y(n,i)} Days`,icon:(0,l.jsx)(r.Z,{className:"w-6 h-6 text-[#E0FE10]"})}),(0,l.jsx)(j,{title:"Start Date",value:g(n),icon:(0,l.jsx)(o.Z,{className:"w-6 h-6 text-[#E0FE10]"})}),(0,l.jsx)(j,{title:"End Date",value:g(i),icon:(0,l.jsx)(d.Z,{className:"w-6 h-6 text-[#E0FE10]"})}),(0,l.jsx)(j,{title:"Participants",value:h,icon:(0,l.jsx)(c.Z,{className:"w-6 h-6 text-[#E0FE10]"})})]}),(0,l.jsx)(f,{challenge:t})]})})},N=n(9008),k=n.n(N),E=e=>{let{challenge:t,id:n}=e,s=new Date(t.startDate).toLocaleDateString("en-US",{month:"long",day:"numeric"}),i=new Date(t.endDate).toLocaleDateString("en-US",{month:"long",day:"numeric"}),a=`${t.subtitle} • ${s} - ${i} • Join the challenge now!`,c=`pulse://rounds?linkType=round&roundId=${n}`;return(0,l.jsxs)(k(),{children:[(0,l.jsx)("title",{children:`Join ${t.title} | Pulse`}),(0,l.jsx)("meta",{name:"description",content:a}),(0,l.jsx)("meta",{property:"og:title",content:"The Next Round Awaits | Pulse"}),(0,l.jsx)("meta",{property:"og:description",content:`${t.title}`}),(0,l.jsx)("meta",{property:"og:type",content:"website"}),(0,l.jsx)("meta",{property:"og:url",content:`https://fitwithpulse.ai/challenge/${n}`}),(0,l.jsx)("meta",{property:"og:site_name",content:"Pulse Fitness"}),(0,l.jsx)("meta",{property:"og:image",content:"https://fitwithpulse.ai/round-preview.png"}),(0,l.jsx)("meta",{property:"og:image:width",content:"1200"}),(0,l.jsx)("meta",{property:"og:image:height",content:"630"}),(0,l.jsx)("meta",{property:"al:ios:app_store_id",content:"6451497729"}),(0,l.jsx)("meta",{property:"al:ios:app_name",content:"Pulse: Community Workouts"}),(0,l.jsx)("meta",{property:"al:ios:url",content:c}),(0,l.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,l.jsx)("meta",{name:"twitter:title",content:`Join ${t.title} | Pulse`}),(0,l.jsx)("meta",{name:"twitter:description",content:a}),(0,l.jsx)("meta",{name:"twitter:image",content:"https://fitwithpulse.ai/round-preview.png"}),(0,l.jsx)("link",{rel:"canonical",href:`https://fitwithpulse.ai/challenge/${n}`})]})},D=n(4454);let S=()=>(0,l.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,l.jsx)("div",{className:"text-white",children:"Loading challenge..."})}),C=e=>{let{message:t}=e;return(0,l.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-white text-center",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Unable to load challenge"}),(0,l.jsx)("p",{className:"text-white/70",children:t}),(0,l.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-[#E0FE10] text-black rounded-lg",children:"Try Again"})]})})},P=e=>{let{expectedPIN:t,onSuccess:n,onError:i}=e,[a,c]=(0,s.useState)(Array(6).fill("")),[r,o]=(0,s.useState)(!1),[d,u]=(0,s.useState)(!1),h=(0,s.useRef)(Array(6).fill(null)),x=(e,t)=>{if(!/^\d*$/.test(t))return;let n=[...a];n[e]=t,c(n),t&&e<8&&h.current[e+1]?.focus(),u(n.every(e=>""!==e)),o(!1)},m=(e,t)=>{"Backspace"===t.key&&!a[e]&&e>0&&h.current[e-1]?.focus()};return(0,l.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-zinc-950 p-4",children:(0,l.jsxs)("div",{className:"w-full max-w-md",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-white text-center mb-8",children:"Enter Round PIN"}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("div",{className:"flex justify-center gap-2 mb-4",children:a.map((e,t)=>(0,l.jsx)("input",{ref:e=>{h.current&&(h.current[t]=e)},inputMode:"numeric",pattern:"[0-9]*",maxLength:1,value:e,onChange:e=>x(t,e.target.value),onKeyDown:e=>m(t,e),className:`
                  w-10 h-12 
                  text-center text-xl font-bold
                  bg-zinc-900 
                  border-2 ${r?"border-red-500":"border-[#E0FE10]"}
                  text-white 
                  rounded-lg 
                  focus:outline-none 
                  focus:border-[#E0FE10] 
                  transition-colors
                `},t))}),r&&(0,l.jsx)("p",{className:"text-red-500 text-center text-sm mt-2",children:"Incorrect PIN. Please try again."})]}),d&&(0,l.jsx)("button",{onClick:()=>{a.join("")===t?n():(o(!0),i("Incorrect PIN. Please try again."),c(Array(6).fill("")),h.current[0]?.focus(),u(!1))},className:"w-full py-3 bg-[#E0FE10] text-black rounded-lg font-bold  hover:bg-opacity-90 transition-opacity",children:"Enter"})]})})};var R=!0,I=e=>{let{initialCollection:t,initialError:n}=e;console.log("Component rendering",{initialCollection:t,initialError:n}),console.log("Challenge Page Render - Collection Data:",{hasPin:!!t?.pin,pin:t?.pin,fullCollection:t});let a=(0,i.useRouter)(),{id:c}=a.query,[r,o]=(0,s.useState)(t||null),[d,u]=(0,s.useState)(!t),[h,x]=(0,s.useState)(n||null),[m,p]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{console.log("useEffect triggered",{id:c,initialCollection:t});let e=async()=>{if(c&&!t)try{let e=`https://fitwithpulse.ai/.netlify/functions/get-challenge-by-id?id=${c}`,t=await fetch(e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!t.ok){let e=await t.text();throw console.error("Error response:",e),Error(`HTTP error! status: ${t.status}`)}let n=await t.json();if(console.log("SSR Response Data:",{pin:n.collection.pin,fullData:n.collection}),console.log("Client - Raw API Response:",JSON.stringify(n,null,2)),console.log("Client - Collection introVideoURL:",n.collection.introVideoURL),console.log("Client - Collection ownerId:",n.collection.ownerId),!n.success)throw Error(n.error||"Failed to fetch challenge");if(!n.collection||!n.collection.challenge)throw Error("Invalid challenge data received");let l={...n.collection,createdAt:new Date(n.collection.createdAt),updatedAt:new Date(n.collection.updatedAt),pin:n.collection.pin,challenge:new D.tv({id:n.collection.challenge.id,title:n.collection.challenge.title,subtitle:n.collection.challenge.subtitle,introVideos:n.collection.challenge.introVideos,introVideoURL:n.collection.challenge.introVideoURL,status:n.collection.challenge.status||"draft",startDate:new Date(n.collection.challenge.startDate),endDate:new Date(n.collection.challenge.endDate),createdAt:new Date(n.collection.challenge.createdAt),updatedAt:new Date(n.collection.challenge.updatedAt),participants:n.collection.challenge.participants||[]})};o(l)}catch(e){console.error("Error details:",e),x(e instanceof Error?e.message:"An error occurred while loading the challenge")}finally{u(!1)}};a.isReady&&c&&e()},[c,a.isReady,t]),!a.isReady||d)?(0,l.jsx)(S,{}):h?(0,l.jsx)(C,{message:h}):r&&r.challenge?r.pin&&!m?(0,l.jsx)(P,{expectedPIN:r.pin,onSuccess:()=>p(!0),onError:e=>x(e)}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(E,{challenge:r.challenge,id:c}),(0,l.jsx)(v,{challenge:r.challenge,onClose:()=>{a.push("/")},onJoinChallenge:async e=>{try{await new Promise(e=>setTimeout(e,1e3)),a.push("/")}catch(e){console.error("Error joining challenge:",e),x("Failed to join challenge. Please try again.")}}})]}):(0,l.jsx)(C,{message:"Challenge not found"})}},9008:function(e,t,n){e.exports=n(3867)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=2942)}),_N_E=e.O()}]);
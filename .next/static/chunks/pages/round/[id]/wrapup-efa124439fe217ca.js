(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[182],{7358:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/round/[id]/wrapup",function(){return t(2634)}])},3488:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});let l=(0,t(1134).Z)("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]])},8496:function(e,s,t){"use strict";t.d(s,{G_:function(){return l.G},P7:function(){return a.P7}});var l=t(9586),a=t(4454)},2634:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return v}});var l=t(5893),a=t(7294),r=t(5007),n=t(1163),c=t(1134);let i=(0,c.Z)("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),d=(0,c.Z)("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),o=(0,c.Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),m=(0,c.Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var x=t(3488);let u=(0,c.Z)("Sunrise",[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]);var h=t(8496);let f=e=>{let{participants:s,analyticsText:t}=e;return(0,l.jsxs)("div",{className:"w-[300px] h-[400px] bg-zinc-900 text-white p-4 rounded-lg flex flex-col",children:[(0,l.jsxs)("div",{className:"flex justify-center items-end space-x-4 mb-4",children:[s[1]&&(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-20 h-20 mx-auto mb-2 rounded-full bg-zinc-800 border-2 border-gray-400 overflow-hidden",children:(0,l.jsx)("img",{src:s[1].profileImage?.profileImageURL||"/default-avatar.png",alt:s[1].username,className:"w-full h-full object-cover"})}),(0,l.jsx)("div",{className:"text-gray-400 font-bold",children:s[1].pulsePoints.totalPoints})]}),s[0]&&(0,l.jsxs)("div",{className:"text-center -mb-4",children:[(0,l.jsx)(i,{className:"w-8 h-8 text-yellow-400 mx-auto mb-2"}),(0,l.jsx)("div",{className:"w-24 h-24 mx-auto mb-2 rounded-full bg-zinc-800 border-2 border-yellow-400 overflow-hidden",children:(0,l.jsx)("img",{src:s[0].profileImage?.profileImageURL||"/default-avatar.png",alt:s[0].username,className:"w-full h-full object-cover"})}),(0,l.jsx)("div",{className:"text-yellow-400 font-bold",children:s[0].pulsePoints.totalPoints})]}),s[2]&&(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-16 h-16 mx-auto mb-2 rounded-full bg-zinc-800 border-2 border-amber-700 overflow-hidden",children:(0,l.jsx)("img",{src:s[2].profileImage?.profileImageURL||"/default-avatar.png",alt:s[2].username,className:"w-full h-full object-cover"})}),(0,l.jsx)("div",{className:"text-amber-700 font-bold",children:s[2].pulsePoints.totalPoints})]})]}),(0,l.jsx)("div",{className:"text-center text-xl font-bold mb-2",children:t}),(0,l.jsx)("div",{className:"text-center text-sm text-gray-400",children:"Challenge Wrap-up"}),(0,l.jsx)("div",{className:"mt-auto text-center text-xs text-gray-500",children:"Powered by QuickLifts"})]})},g=e=>{let{activityItems:s,applicationActivities:t}=e;return(0,a.useEffect)(()=>{navigator.share?navigator.share({title:"Round Wrap-up",text:"Check out my round wrap-up results!",url:s[0]}).catch(e=>console.error("Error sharing",e)):console.log("Native share not supported.")},[s]),(0,l.jsx)("div",{})};var v=()=>{let[e,s]=(0,a.useState)(!0),[t,c]=(0,a.useState)(null),[v,p]=(0,a.useState)([]),[j,N]=(0,a.useState)([]),[b,w]=(0,a.useState)(null),[y,k]=(0,a.useState)(null),[I,P]=(0,a.useState)(null),[z,R]=(0,a.useState)(null),[C,U]=(0,a.useState)([]),[S,A]=(0,a.useState)(!1),{id:E}=(0,n.useRouter)().query,{currentUser:L}=(0,r.v9)(e=>e.user);(0,a.useRef)(null),(0,a.useEffect)(()=>{(async()=>{s(!0);try{let e=await h.G_.getCollectionById("cevWHBlBk7VobANRUsmC"),s=await h.G_.getUserChallengesByChallengeId("cevWHBlBk7VobANRUsmC");c(e.challenge||null),p(s.userChallenges||[])}catch(e){console.error("Error fetching round data:",e)}finally{s(!1)}})()},[E]);let _=e=>{let s=e.map(e=>{console.log("User:",e.username),console.log("All completed workouts:",e.completedWorkouts);let s=e.completedWorkouts.filter(e=>{console.log("Raw completedAt:",e.completedAt);let s=new Date(e.completedAt);return console.log("Parsed completedAt:",s),console.log("Hour:",s.getHours()),8>s.getHours()}).length;return console.log("Early workout count:",s),{user:e,count:s}}).sort((e,s)=>s.count-e.count)[0];return console.log("Top early riser:",s),s};(0,a.useEffect)(()=>{v.length>0&&(N([...v].sort((e,s)=>s.pulsePoints.totalPoints-e.pulsePoints.totalPoints)),w(_(v)),k(v.map(e=>({user:e,count:e.currentStreak})).sort((e,s)=>s.count-e.count)[0]),v.map(e=>({user:e,count:e.encouragedUsers.length})).sort((e,s)=>s.count-e.count)[0],v.length>0&&t&&R(M(v,t)))},[v]);let M=(e,s)=>{let t=s.durationInDays;return e.map(e=>{if(0===e.completedWorkouts.length)return{user:e,improvement:0};let s=[...e.completedWorkouts].sort((e,s)=>new Date(e.completedAt).getTime()-new Date(s.completedAt).getTime()),l=new Date(s[0].completedAt),a=Math.ceil((new Date(s[s.length-1].completedAt).getTime()-l.getTime())/864e5)+1,r=e.pulsePoints.totalPoints,n=r/a,c=r/t,i=c>0?(n/c-1)*100:0;return console.log(`${e.username}:`),console.log(`Compressed ${r} points into ${a} days`),console.log(`Rate: ${n.toFixed(2)}/day vs Expected ${c.toFixed(2)}/day`),console.log(`Improvement: ${i.toFixed(0)}%`),{user:e,improvement:Math.round(i)}}).sort((e,s)=>s.improvement-e.improvement)[0]},D=j.length>0?`Top Score: ${j[0].pulsePoints.totalPoints} pts`:"Challenge Wrap-up";return e?(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-zinc-900 text-white",children:"Loading wrap-up..."}):(0,l.jsxs)("div",{className:"min-h-screen bg-zinc-900 text-white p-6 relative",children:[(0,l.jsxs)("div",{className:"text-center mb-12",children:[(0,l.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"Round Complete! \uD83C\uDF89"}),(0,l.jsx)("h2",{className:"text-xl text-zinc-400",children:t?.title})]}),(0,l.jsx)("div",{className:"mb-12",children:(0,l.jsxs)("div",{className:"flex justify-center items-end space-x-4",children:[j[1]&&(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-20 h-20 mx-auto mb-2 rounded-full bg-zinc-800 border-2 border-gray-400 overflow-hidden",children:(0,l.jsx)("img",{src:j[1].profileImage?.profileImageURL||"/default-avatar.png",alt:j[1].username,className:"w-full h-full object-cover"})}),(0,l.jsx)("div",{className:"text-gray-400 font-bold",children:j[1].pulsePoints.totalPoints})]}),j[0]&&(0,l.jsxs)("div",{className:"text-center -mb-4",children:[(0,l.jsx)(i,{className:"w-8 h-8 text-yellow-400 mx-auto mb-2"}),(0,l.jsx)("div",{className:"w-24 h-24 mx-auto mb-2 rounded-full bg-zinc-800 border-2 border-yellow-400 overflow-hidden",children:(0,l.jsx)("img",{src:j[0].profileImage?.profileImageURL||"/default-avatar.png",alt:j[0].username,className:"w-full h-full object-cover"})}),(0,l.jsx)("div",{className:"text-yellow-400 font-bold",children:j[0].pulsePoints.totalPoints})]}),j[2]&&(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-16 h-16 mx-auto mb-2 rounded-full bg-zinc-800 border-2 border-amber-700 overflow-hidden",children:(0,l.jsx)("img",{src:j[2].profileImage?.profileImageURL||"/default-avatar.png",alt:j[2].username,className:"w-full h-full object-cover"})}),(0,l.jsx)("div",{className:"text-amber-700 font-bold",children:j[2].pulsePoints.totalPoints})]})]})}),(0,l.jsxs)("div",{className:"mb-12",children:[(0,l.jsx)("div",{className:"mb-4 px-4 text-left",children:(0,l.jsx)("h3",{className:"text-xl font-bold",children:"Your Performance"})}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("div",{className:"flex space-x-4 px-4",children:[(0,l.jsxs)("div",{className:"w-32 p-4 bg-zinc-800 rounded-lg",children:[(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(d,{className:"w-8 h-8 text-orange-400"})}),(0,l.jsx)("div",{className:"text-center text-2xl font-bold",children:v.find(e=>e.userId===L?.id)?.currentStreak||0}),(0,l.jsx)("div",{className:"text-center text-sm text-gray-400",children:"Day Streak"})]}),(0,l.jsxs)("div",{className:"w-32 p-4 bg-zinc-800 rounded-lg",children:[(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(o,{className:"w-8 h-8 text-primaryGreen"})}),(0,l.jsxs)("div",{className:"text-center text-2xl font-bold",children:[t?Math.floor((v.find(e=>e.userId===L?.id)?.completedWorkouts.length||0)/t.durationInDays*100):0,"%"]}),(0,l.jsx)("div",{className:"text-center text-sm text-gray-400",children:"Completion"})]}),(0,l.jsxs)("div",{className:"w-32 p-4 bg-zinc-800 rounded-lg",children:[(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(m,{className:"w-8 h-8 text-purple-400"})}),(0,l.jsx)("div",{className:"text-center text-2xl font-bold",children:v.find(e=>e.userId===L?.id)?.encouragedUsers.length||0}),(0,l.jsx)("div",{className:"text-center text-sm text-gray-400",children:"Encouraged"})]}),(0,l.jsxs)("div",{className:"w-32 p-4 bg-zinc-800 rounded-lg",children:[(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)("span",{className:"w-8 h-8 flex items-center justify-center text-green-400 font-bold",children:"âœ“"})}),(0,l.jsx)("div",{className:"text-center text-2xl font-bold",children:v.find(e=>e.userId===L?.id)?.checkIns.length||0}),(0,l.jsx)("div",{className:"text-center text-sm text-gray-400",children:"Check-ins"})]}),(0,l.jsxs)("div",{className:"w-32 p-4 bg-zinc-800 rounded-lg",children:[(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(x.Z,{className:"w-8 h-8 text-blue-400"})}),(0,l.jsx)("div",{className:"text-center text-2xl font-bold",children:v.find(e=>e.userId===L?.id)?.pulsePoints.totalPoints||0}),(0,l.jsx)("div",{className:"text-center text-sm text-gray-400",children:"Pulse Points"})]}),(0,l.jsxs)("div",{className:"w-32 p-4 bg-zinc-800 rounded-lg",children:[(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(i,{className:"w-8 h-8 text-yellow-400"})}),(0,l.jsx)("div",{className:"text-center text-2xl font-bold",children:(()=>{let e=[...v].sort((e,s)=>s.pulsePoints.totalPoints-e.pulsePoints.totalPoints),s=v.find(e=>e.userId===L?.id),t=e.findIndex(e=>e.userId===(s?s.userId:""))+1;return t>0?`#${t}`:"-"})()}),(0,l.jsx)("div",{className:"text-center text-sm text-gray-400",children:"Rank"})]})]})})]}),(0,l.jsxs)("div",{className:"mb-12 px-4",children:[(0,l.jsx)("h3",{className:"text-2xl font-bold mb-6",children:"Round Highlights"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[I&&I.count>0&&(0,l.jsxs)("div",{className:"bg-zinc-800 p-4 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center mb-4",children:[(0,l.jsx)(m,{className:"w-6 h-6 text-red-400 mr-2"}),(0,l.jsx)("span",{className:"font-bold",children:"Most Encouraging"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 rounded-full bg-zinc-700 overflow-hidden mr-3",children:(0,l.jsx)("img",{src:I.user.profileImage?.profileImageURL||"/default-avatar.png",alt:I.user.username,className:"w-full h-full object-cover"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-bold",children:I.user.username}),(0,l.jsxs)("div",{className:"text-sm text-zinc-400",children:[I.count," encouragements"]})]})]})]}),y&&(0,l.jsxs)("div",{className:"bg-zinc-800 p-4 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center mb-4",children:[(0,l.jsx)(d,{className:"w-6 h-6 text-orange-400 mr-2"}),(0,l.jsx)("span",{className:"font-bold",children:"Streak Master"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 rounded-full bg-zinc-700 overflow-hidden mr-3",children:(0,l.jsx)("img",{src:y.user.profileImage?.profileImageURL||"/default-avatar.png",alt:y.user.username,className:"w-full h-full object-cover"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-bold",children:y.user.username}),(0,l.jsxs)("div",{className:"text-sm text-zinc-400",children:[y.count," day streak"]})]})]})]}),b&&(0,l.jsxs)("div",{className:"bg-zinc-800 p-4 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center mb-4",children:[(0,l.jsx)(u,{className:"w-6 h-6 text-yellow-400 mr-2"}),(0,l.jsx)("span",{className:"font-bold",children:"Early Bird"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 rounded-full bg-zinc-700 overflow-hidden mr-3",children:(0,l.jsx)("img",{src:b.user.profileImage?.profileImageURL||"/default-avatar.png",alt:b.user.username,className:"w-full h-full object-cover"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-bold",children:b.user.username}),(0,l.jsxs)("div",{className:"text-sm text-zinc-400",children:[b.count," early workouts"]})]})]})]}),z&&(0,l.jsxs)("div",{className:"bg-zinc-800 p-4 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center mb-4",children:[(0,l.jsx)(o,{className:"w-6 h-6 text-green-400 mr-2"}),(0,l.jsx)("span",{className:"font-bold",children:"Biggest Comeback"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 rounded-full bg-zinc-700 overflow-hidden mr-3",children:(0,l.jsx)("img",{src:z.user.profileImage?.profileImageURL||"/default-avatar.png",alt:z.user.username,className:"w-full h-full object-cover"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-bold",children:z.user.username}),(0,l.jsxs)("div",{className:"text-sm text-zinc-400",children:["+",z.improvement,"% improvement"]})]})]})]})]})]}),(0,l.jsx)("div",{className:"absolute top-0 left-0 -z-10 opacity-0",children:(0,l.jsx)(f,{participants:v,analyticsText:D})}),S&&C.length>0&&(0,l.jsx)(g,{activityItems:C})]})}}},function(e){e.O(0,[66,586,888,774,179],function(){return e(e.s=7358)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[679],{7277:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/workout/[username]/[id]",function(){return s(5364)}])},5364:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var r=s(5893),l=s(7294),o=s(5007),i=s(1163),n=e=>{let{videoURLs:t,isMuted:s=!0,ratio:o="cover"}=e,[i,n]=(0,l.useState)(0),a=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let e=a.current;if(!e)return;let s=()=>{n(e=>(e+1)%t.length)},r=()=>{e.play().catch(e=>{"AbortError"!==e.name&&console.error("Error playing video:",e)})};return e.addEventListener("ended",s),e.addEventListener("canplay",r),()=>{e.removeEventListener("ended",s),e.removeEventListener("canplay",r)}},[t,i]),(0,l.useEffect)(()=>{let e=a.current;e&&(e.src=t[i],e.load())},[i,t]),(0,r.jsx)("div",{className:"relative w-full h-full bg-black",children:(0,r.jsx)("video",{ref:a,className:`absolute inset-0 w-full h-full ${"cover"===o?"object-cover":"object-contain"}`,muted:s,playsInline:!0,loop:!1})})},a=e=>{let{log:t}=e;(0,l.useEffect)(()=>{console.log("Exercise Log:",t),console.log("Exercise name:",t.exercise?.name),console.log("Sets:",t.exercise?.sets),console.log("Reps:",t.exercise?.reps),console.log("Videos length:",t.exercise?.videos?.length??0),console.log("Current video position:",t.exercise?.currentVideoPosition);let e=t.exercise?.videos?.[t.exercise.currentVideoPosition||0];e?console.log("Current video URL:",e.videoURL):console.log("No video available at current position"),t.exercise?.videos?.forEach((e,t)=>{console.log(`Video ${t} URL:`,e.videoURL)})},[t]);let s=t.exercise?.videos&&t.exercise.videos.length>0?t.exercise.videos[t.exercise.currentVideoPosition||0]?.videoURL:void 0;return(0,r.jsxs)("div",{className:"flex bg-black-800 bg-opacity-50 rounded-lg h-24 mb-4 overflow-hidden",children:[t.exercise?.videos?.length&&s?(0,r.jsxs)("div",{className:"relative w-24 h-24 overflow-hidden",children:[(0,r.jsx)("video",{src:s,className:"object-cover w-full h-full",muted:!0,autoPlay:!0,loop:!0}),(0,r.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-b from-black/60 to-transparent"})]}):(0,r.jsx)("div",{className:"w-24 h-24 bg-gray-600 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-xs",children:"No video"})}),(0,r.jsxs)("div",{className:"flex flex-col justify-center ml-4 flex-grow",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-white",children:t.exercise?.name||"Unknown Exercise"}),(0,r.jsx)("p",{className:"text-sm text-[#E0FE10]",children:`${t.exercise?.sets||0} sets x ${t.exercise?.reps==="0"?12:t.exercise?.reps||12} reps`})]})]})},c=s(8662),d=()=>{var e;let t=(0,i.useRouter)(),{username:s,id:d}=t.query,[x,u]=(0,l.useState)(null),[h,f]=(0,l.useState)([]),[m,v]=(0,l.useState)(null),[b,g]=(0,l.useState)(!0),p=(0,o.v9)(e=>e.user.currentUser?.id);(0,l.useEffect)(()=>{t.isReady&&s&&d&&(async()=>{try{let[e,t]=await c.G.fetchSavedWorkout(s,d);e?(u(e),f(t||[])):v("No workout data returned")}catch(e){v(e instanceof Error?e.message:"An unknown error occurred")}finally{g(!1)}})()},[t.isReady,s,d]);let j=async()=>{if(!x||!h.length){v("Unable to start workout");return}try{if(p){let e=await c.G.saveWorkoutSession({userId:p,workout:x,logs:h});console.log("We have queued up saved workout:",e),e?t.push("/"):v("Failed to save workout session")}}catch(e){console.error("Error starting workout:",e),v("Failed to start workout")}};if(b)return(0,r.jsx)("div",{className:"text-white text-center pt-20",children:"Loading workout..."});if(m||!x)return(0,r.jsxs)("div",{className:"text-white text-center pt-20",children:["Error loading workout: ",m||"Unknown error"]});let w=h.filter(e=>e.exercise&&e.exercise.videos).flatMap(e=>e.exercise.videos.map(e=>e.videoURL)),N=5*Math.round((5+8*(e=x.exercises).length+1*Math.max(0,e.length-1)+5)/5);return(0,r.jsxs)("div",{className:"relative h-screen bg-black",children:[(0,r.jsx)("div",{className:"fixed top-0 left-0 right-0 bg-[#E0FE10] text-black py-2 px-4 text-center z-50",children:(0,r.jsx)("p",{className:"font-bold",children:"Ready to start your workout!"})}),(0,r.jsx)(n,{videoURLs:w,isMuted:!0,ratio:"cover"}),(0,r.jsx)("div",{className:"absolute inset-0 mt-80 overflow-y-auto bg-gradient-to-b from-transparent via-[#192126] via-25% to-[#192126] to-50%",children:(0,r.jsx)("div",{className:"flex flex-col min-h-full p-4 pb-20 pt-12",children:(0,r.jsxs)("div",{className:"flex-grow",children:[(0,r.jsxs)("div",{className:"text-center text-white mt-10 mb-1",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Your workout for today:"}),(0,r.jsx)("p",{className:"text-xl font-bold text-[#E0FE10]",children:x.title})]}),(0,r.jsxs)("div",{className:"flex justify-around my-10",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-2xl font-bold text-[#E0FE10]",children:h.length}),(0,r.jsx)("p",{className:"text-m text-white",children:"Exercises"})]}),(0,r.jsx)("div",{className:"h-14 w-px bg-white opacity-50"}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("p",{className:"text-2xl font-bold text-[#E0FE10]",children:[N," mins"]}),(0,r.jsx)("p",{className:"text-m text-white",children:"Duration"})]})]}),(0,r.jsx)("div",{className:"mt-6 mb-28",children:h.map(e=>(0,r.jsx)(a,{log:e},e.id))})]})})}),(0,r.jsx)("div",{className:"fixed bottom-0 left-0 right-0 p-10 bg-gradient-to-t from-black to-transparent",children:(0,r.jsx)("button",{onClick:j,className:"w-full py-3 bg-[#E0FE10] text-black font-bold rounded-full text-lg",children:"Start this Workout"})}),m&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg max-w-sm w-full",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Error"}),(0,r.jsx)("p",{className:"mb-6",children:m}),(0,r.jsx)("button",{onClick:()=>v(null),className:"px-4 py-2 bg-[#E0FE10] text-black rounded",children:"Dismiss"})]})})]})}}},function(e){e.O(0,[16,693,311,376,662,888,774,179],function(){return e(e.s=7277)}),_N_E=e.O()}]);
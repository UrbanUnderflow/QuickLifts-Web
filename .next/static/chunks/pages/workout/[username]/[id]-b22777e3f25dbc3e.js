(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[679],{7277:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/workout/[username]/[id]",function(){return s(5364)}])},5364:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var l=s(5893),r=s(7294),o=s(5007),i=s(1163),n=e=>{let{videoURLs:t,isMuted:s=!0,ratio:o="cover"}=e,[i,n]=(0,r.useState)(0),c=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=c.current;if(!e)return;let s=()=>{n(e=>(e+1)%t.length)},l=()=>{e.play().catch(e=>{"AbortError"!==e.name&&console.error("Error playing video:",e)})};return e.addEventListener("ended",s),e.addEventListener("canplay",l),()=>{e.removeEventListener("ended",s),e.removeEventListener("canplay",l)}},[t,i]),(0,r.useEffect)(()=>{let e=c.current;e&&(e.src=t[i],e.load())},[i,t]),(0,l.jsx)("div",{className:"relative w-full h-full bg-black",children:(0,l.jsx)("video",{ref:c,className:`absolute inset-0 w-full h-full ${"cover"===o?"object-cover":"object-contain"}`,muted:s,playsInline:!0,loop:!1})})},c=e=>{let{log:t,gifUrls:s=[]}=e;(0,r.useEffect)(()=>{console.log("Exercise Log:",t),console.log("Exercise name:",t.exercise?.name),console.log("Sets:",t.exercise?.sets),console.log("Reps:",t.exercise?.reps),console.log("Videos length:",t.exercise?.videos?.length??0),console.log("Current video position:",t.exercise?.currentVideoPosition);let e=t.exercise?.videos?.[t.exercise.currentVideoPosition||0];e?console.log("Current video URL:",e.videoURL):console.log("No video available at current position"),t.exercise?.videos?.forEach((e,t)=>{console.log(`Video ${t} URL:`,e.videoURL)})},[t]);let o=t.exercise?.videos&&t.exercise.videos.length>0?t.exercise.videos[t.exercise.currentVideoPosition||0]?.videoURL:void 0;return(0,l.jsxs)("div",{className:"flex bg-black-800 bg-opacity-50 rounded-lg h-24 mb-4 overflow-hidden",children:[t.exercise?.videos?.length&&o?(0,l.jsxs)("div",{className:"relative w-24 h-24 overflow-hidden",children:[(0,l.jsx)("video",{src:o,className:"object-cover w-full h-full",muted:!0,autoPlay:!0,loop:!0}),(0,l.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-b from-black/60 to-transparent"})]}):(0,l.jsx)("div",{className:"w-24 h-24 bg-gray-600 flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white text-xs",children:"No video"})}),(0,l.jsxs)("div",{className:"flex flex-col justify-center ml-4 flex-grow",children:[(0,l.jsx)("h3",{className:"text-lg font-bold text-white",children:t.exercise?.name||"Unknown Exercise"}),(0,l.jsx)("p",{className:"text-sm text-[#E0FE10]",children:`${t.exercise?.sets||0} sets x ${t.exercise?.reps==="0"?12:t.exercise?.reps||12} reps`})]})]})},a=s(9586),d=s(7613),x=s(8381),u=()=>{var e;let t=(0,i.useRouter)(),{username:s,id:u}=t.query,[f,h]=(0,r.useState)(null),[m,v]=(0,r.useState)([]),[g,b]=(0,r.useState)(null),[j,p]=(0,r.useState)(!0),N=(0,o.v9)(e=>e.user.currentUser?.id);(0,r.useEffect)(()=>{t.isReady&&s&&u&&(async()=>{try{let e=await d.W.getUserByUsername(s);if(!e){b("User not found");return}let[t,l]=await a.G.fetchSavedWorkout(e.id,u);t?(h(t),v(l||[])):b("No workout data returned")}catch(e){b(e instanceof Error?e.message:"An unknown error occurred")}finally{p(!1)}})()},[t.isReady,s,u]);let w=(0,o.I0)(),E=async()=>{if(!f||!m.length){b("Unable to start workout");return}try{if(N){let e=await a.G.saveWorkoutSession({userId:N,workout:f,logs:m});e?(console.log("Queued workout:",e),console.log("âœ… Queued Workout ID:",e.id),w((0,x.q1)(e)),w((0,x.HX)(m)),t.push("/")):b("Failed to save workout session")}}catch(e){console.error("Error starting workout:",e),b("Failed to start workout")}};if(j)return(0,l.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,l.jsx)("div",{className:"text-white text-xl",children:"Loading workout..."})});if(g||!f)return(0,l.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-white text-xl",children:["Error loading workout: ",g||"No workout data available"]})});let k=f.exercises.filter(e=>(console.log("Exercise videos:",e.exercise.videos),e.exercise.videos?.length>0)).flatMap(e=>e.exercise.videos.map(e=>e.videoURL)).filter(e=>e);console.log("Filtered video URLs:",k);let y=5*Math.round((5+8*(e=f.exercises).length+1*Math.max(0,e.length-1)+5)/5);return(0,l.jsxs)("div",{className:"relative h-screen bg-black",children:[(0,l.jsx)("div",{className:"fixed top-0 left-0 right-0 bg-[#E0FE10] text-black py-2 px-4 text-center z-50",children:(0,l.jsx)("p",{className:"font-bold",children:"Ready to start your workout!"})}),(0,l.jsx)(n,{videoURLs:k,isMuted:!0,ratio:"cover"}),(0,l.jsx)("div",{className:"absolute inset-0 mt-80 overflow-y-auto bg-gradient-to-b from-transparent via-[#192126] via-25% to-[#192126] to-50%",children:(0,l.jsx)("div",{className:"flex flex-col min-h-full p-4 pb-20 pt-12",children:(0,l.jsxs)("div",{className:"flex-grow",children:[(0,l.jsxs)("div",{className:"text-center text-white mt-10 mb-1",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold",children:"Your workout for today:"}),(0,l.jsx)("p",{className:"text-xl font-bold text-[#E0FE10]",children:f.title})]}),(0,l.jsxs)("div",{className:"flex justify-around my-10",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-[#E0FE10]",children:m.length}),(0,l.jsx)("p",{className:"text-m text-white",children:"Exercises"})]}),(0,l.jsx)("div",{className:"h-14 w-px bg-white opacity-50"}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("p",{className:"text-2xl font-bold text-[#E0FE10]",children:[y," mins"]}),(0,l.jsx)("p",{className:"text-m text-white",children:"Duration"})]})]}),(0,l.jsx)("div",{className:"mt-6 mb-28",children:m.map(e=>(0,l.jsx)(c,{log:e,gifUrls:e.exercise.videos?.map(e=>e.gifURL).filter(e=>!!e)||[]},e.id))})]})})}),(0,l.jsx)("div",{className:"fixed bottom-0 left-0 right-0 p-10 bg-gradient-to-t from-black to-transparent",children:(0,l.jsx)("button",{onClick:E,className:"w-full py-3 bg-[#E0FE10] text-black font-bold rounded-full text-lg",children:"Start this Workout"})}),g&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg max-w-sm w-full",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Error"}),(0,l.jsx)("p",{className:"mb-6",children:g}),(0,l.jsx)("button",{onClick:()=>b(null),className:"px-4 py-2 bg-[#E0FE10] text-black rounded",children:"Dismiss"})]})})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=7277)}),_N_E=e.O()}]);
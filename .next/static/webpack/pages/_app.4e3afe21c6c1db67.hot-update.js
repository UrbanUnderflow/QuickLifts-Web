"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("pages/_app",{

/***/ "./src/api/firebase/storage/service.ts":
/*!*********************************************!*\
  !*** ./src/api/firebase/storage/service.ts ***!
  \*********************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FirebaseStorageService: function() { return /* binding */ FirebaseStorageService; },\n/* harmony export */   UploadImageType: function() { return /* binding */ UploadImageType; },\n/* harmony export */   VideoTrimmerService: function() { return /* binding */ VideoTrimmerService; },\n/* harmony export */   VideoType: function() { return /* binding */ VideoType; },\n/* harmony export */   firebaseStorageService: function() { return /* binding */ firebaseStorageService; },\n/* harmony export */   videoTrimmerService: function() { return /* binding */ videoTrimmerService; }\n/* harmony export */ });\n/* harmony import */ var _swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @swc/helpers/_/_async_to_generator */ \"./node_modules/@swc/helpers/esm/_async_to_generator.js\");\n/* harmony import */ var _swc_helpers_class_call_check__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @swc/helpers/_/_class_call_check */ \"./node_modules/@swc/helpers/esm/_class_call_check.js\");\n/* harmony import */ var _swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @swc/helpers/_/_object_spread */ \"./node_modules/@swc/helpers/esm/_object_spread.js\");\n/* harmony import */ var _swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @swc/helpers/_/_object_spread_props */ \"./node_modules/@swc/helpers/esm/_object_spread_props.js\");\n/* harmony import */ var _swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @swc/helpers/_/_ts_generator */ \"./node_modules/@swc/helpers/esm/_ts_generator.js\");\n/* harmony import */ var firebase_storage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/storage */ \"./node_modules/firebase/storage/dist/esm/index.esm.js\");\n/* harmony import */ var _api_firebase_user__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../api/firebase/user */ \"./src/api/firebase/user/index.ts\");\n/* harmony import */ var _api_firebase_config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../api/firebase/config */ \"./src/api/firebase/config.ts\");\n// src/services/FirebaseStorageService.ts\n\n\n\n\n\n\n\n\n\nvar UploadImageType;\n(function(UploadImageType) {\n    UploadImageType[\"Profile\"] = \"profile_images\";\n    UploadImageType[\"Feedback\"] = \"feedback\";\n    UploadImageType[\"CheckIn\"] = \"checkin\";\n    UploadImageType[\"Meal\"] = \"meal\";\n    UploadImageType[\"GroupChat\"] = \"group_chat\";\n})(UploadImageType || (UploadImageType = {}));\nvar VideoType;\n(function(VideoType) {\n    VideoType[\"Exercise\"] = \"exercise\";\n    VideoType[\"Intro\"] = \"intro\";\n    VideoType[\"RoundChat\"] = \"round-chat\";\n})(VideoType || (VideoType = {}));\nvar FirebaseStorageService = /*#__PURE__*/ function() {\n    \"use strict\";\n    function FirebaseStorageService() {\n        (0,_swc_helpers_class_call_check__WEBPACK_IMPORTED_MODULE_3__._)(this, FirebaseStorageService);\n        this.storage = (0,firebase_storage__WEBPACK_IMPORTED_MODULE_0__.getStorage)();\n        // Optional: Image caching similar to iOS implementation\n        this.imageCache = new Map();\n    }\n    var _proto = FirebaseStorageService.prototype;\n    _proto.uploadVideo = function uploadVideo(file) {\n        var videoType = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : \"exercise\";\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_4__._)(function() {\n            var user, ALLOWED_TYPES, MAX_FILE_SIZE, fileName, storagePath, storageRef, snapshot, downloadURL, gsURL, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_5__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        // Ensure user is authenticated\n                        user = _api_firebase_config__WEBPACK_IMPORTED_MODULE_2__.auth.currentUser;\n                        if (!user) {\n                            throw new Error(\"User must be authenticated to upload video\");\n                        }\n                        // Validate file type and size\n                        ALLOWED_TYPES = [\n                            \"video/mp4\",\n                            \"video/quicktime\",\n                            \"video/x-msvideo\"\n                        ];\n                        MAX_FILE_SIZE = 100 * 1024 * 1024; // 100MB\n                        if (!ALLOWED_TYPES.includes(file.type)) {\n                            throw new Error(\"Invalid file type. Only MP4, AVI, and QuickTime videos are allowed.\");\n                        }\n                        if (file.size > MAX_FILE_SIZE) {\n                            throw new Error(\"File is too large. Maximum size is 100MB.\");\n                        }\n                        // Generate unique filename\n                        fileName = \"\".concat(Date.now(), \"_\").concat(file.name);\n                        storagePath = \"videos/\".concat(user.uid, \"/\").concat(fileName);\n                        // Create storage reference\n                        storageRef = (0,firebase_storage__WEBPACK_IMPORTED_MODULE_0__.ref)((0,firebase_storage__WEBPACK_IMPORTED_MODULE_0__.getStorage)(), storagePath);\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            4,\n                            ,\n                            5\n                        ]);\n                        return [\n                            4,\n                            (0,firebase_storage__WEBPACK_IMPORTED_MODULE_0__.uploadBytes)(storageRef, file)\n                        ];\n                    case 2:\n                        snapshot = _state.sent();\n                        return [\n                            4,\n                            (0,firebase_storage__WEBPACK_IMPORTED_MODULE_0__.getDownloadURL)(snapshot.ref)\n                        ];\n                    case 3:\n                        downloadURL = _state.sent();\n                        // Construct GS URL (Google Storage URL)\n                        gsURL = \"gs://\".concat(snapshot.ref.bucket, \"/\").concat(snapshot.ref.fullPath);\n                        return [\n                            2,\n                            {\n                                gsURL: gsURL,\n                                downloadURL: downloadURL\n                            }\n                        ];\n                    case 4:\n                        error = _state.sent();\n                        console.error(\"Video upload failed\", error);\n                        throw error;\n                    case 5:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.uploadImage = function uploadImage(file) {\n        var imageType = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : \"profile_images\";\n        var _this = this;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_4__._)(function() {\n            var user, fileName, storagePath, storageRef, snapshot, downloadURL, gsURL, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_5__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        // Ensure user is authenticated\n                        user = _api_firebase_config__WEBPACK_IMPORTED_MODULE_2__.auth.currentUser;\n                        if (!user) {\n                            throw new Error(\"User must be authenticated to upload image\");\n                        }\n                        // Generate unique filename\n                        fileName = \"\".concat(Date.now(), \"_\").concat(file.name);\n                        storagePath = \"\".concat(imageType, \"/\").concat(user.uid, \"/\").concat(fileName);\n                        // Create storage reference\n                        storageRef = (0,firebase_storage__WEBPACK_IMPORTED_MODULE_0__.ref)(_this.storage, storagePath);\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            6,\n                            ,\n                            7\n                        ]);\n                        return [\n                            4,\n                            (0,firebase_storage__WEBPACK_IMPORTED_MODULE_0__.uploadBytes)(storageRef, file)\n                        ];\n                    case 2:\n                        snapshot = _state.sent();\n                        return [\n                            4,\n                            (0,firebase_storage__WEBPACK_IMPORTED_MODULE_0__.getDownloadURL)(snapshot.ref)\n                        ];\n                    case 3:\n                        downloadURL = _state.sent();\n                        // Construct GS URL (Google Storage URL)\n                        gsURL = \"gs://\".concat(snapshot.ref.bucket, \"/\").concat(snapshot.ref.fullPath);\n                        if (!(imageType === \"profile_images\")) return [\n                            3,\n                            5\n                        ];\n                        return [\n                            4,\n                            _this.updateUserProfileImage(downloadURL)\n                        ];\n                    case 4:\n                        _state.sent();\n                        _state.label = 5;\n                    case 5:\n                        return [\n                            2,\n                            {\n                                gsURL: gsURL,\n                                downloadURL: downloadURL\n                            }\n                        ];\n                    case 6:\n                        error = _state.sent();\n                        console.error(\"Image upload failed\", error);\n                        throw error;\n                    case 7:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.updateUserProfileImage = function updateUserProfileImage(imageURL) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_4__._)(function() {\n            var updatedUser;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_5__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        // Ensure current user exists\n                        if (!_api_firebase_user__WEBPACK_IMPORTED_MODULE_1__.userService.currentUser) {\n                            throw new Error(\"No current user found\");\n                        }\n                        // Create a new User object with updated profile image\n                        updatedUser = new _api_firebase_user__WEBPACK_IMPORTED_MODULE_1__.User((0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_6__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_7__._)({}, _api_firebase_user__WEBPACK_IMPORTED_MODULE_1__.userService.currentUser.toDictionary()), {\n                            profileImage: {\n                                profileImageURL: imageURL,\n                                imageOffsetWidth: 0,\n                                imageOffsetHeight: 0\n                            },\n                            updatedAt: new Date()\n                        }));\n                        // Update user in Firestore\n                        return [\n                            4,\n                            _api_firebase_user__WEBPACK_IMPORTED_MODULE_1__.userService.updateUser(updatedUser.id, updatedUser)\n                        ];\n                    case 1:\n                        _state.sent();\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.fetchImage = function fetchImage(url) {\n        var _this = this;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_4__._)(function() {\n            var response, blob, imageURL, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_5__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        // Check cache first\n                        if (_this.imageCache.has(url)) {\n                            return [\n                                2,\n                                _this.imageCache.get(url)\n                            ];\n                        }\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            4,\n                            ,\n                            5\n                        ]);\n                        return [\n                            4,\n                            fetch(url)\n                        ];\n                    case 2:\n                        response = _state.sent();\n                        return [\n                            4,\n                            response.blob()\n                        ];\n                    case 3:\n                        blob = _state.sent();\n                        imageURL = URL.createObjectURL(blob);\n                        // Cache the image URL\n                        _this.imageCache.set(url, imageURL);\n                        return [\n                            2,\n                            imageURL\n                        ];\n                    case 4:\n                        error = _state.sent();\n                        console.error(\"Image fetch failed\", error);\n                        throw error;\n                    case 5:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    return FirebaseStorageService;\n}();\n// In FirebaseStorageService.ts, update the VideoTrimmerService class\nvar VideoTrimmerService = /*#__PURE__*/ function() {\n    \"use strict\";\n    function VideoTrimmerService() {\n        (0,_swc_helpers_class_call_check__WEBPACK_IMPORTED_MODULE_3__._)(this, VideoTrimmerService);\n    }\n    var _proto = VideoTrimmerService.prototype;\n    _proto.trimVideo = function trimVideo(file, startTime, endTime, onProgress) {\n        return new Promise(function(resolve, reject) {\n            var video = document.createElement(\"video\");\n            video.src = URL.createObjectURL(file);\n            video.onloadedmetadata = function() {\n                var canvas = document.createElement(\"canvas\");\n                canvas.width = video.videoWidth;\n                canvas.height = video.videoHeight;\n                var ctx = canvas.getContext(\"2d\");\n                if (!ctx) {\n                    reject(new Error(\"Failed to get canvas context\"));\n                    return;\n                }\n                var outputFormat = {\n                    \"video/mp4\": \"video/webm\",\n                    \"video/quicktime\": \"video/webm\",\n                    \"video/x-msvideo\": \"video/webm\"\n                }[file.type] || \"video/webm\";\n                var mediaRecorder = new MediaRecorder(canvas.captureStream(), {\n                    mimeType: outputFormat,\n                    videoBitsPerSecond: 2500000 // 2.5 Mbps for better quality\n                });\n                var chunks = [];\n                mediaRecorder.ondataavailable = function(e) {\n                    return chunks.push(e.data);\n                };\n                mediaRecorder.onstop = function() {\n                    var blob = new Blob(chunks, {\n                        type: outputFormat\n                    });\n                    var trimmedFile = new File([\n                        blob\n                    ], \"trimmed-\".concat(file.name), {\n                        type: outputFormat\n                    });\n                    URL.revokeObjectURL(video.src);\n                    resolve(trimmedFile);\n                };\n                video.currentTime = startTime;\n                mediaRecorder.start(1000); // Capture in 1-second chunks\n                var totalFrames = (endTime - startTime) * 30; // Assuming 30fps\n                var currentFrame = 0;\n                var checkProgress = function() {\n                    if (video.currentTime >= endTime) {\n                        mediaRecorder.stop();\n                        video.pause();\n                    } else {\n                        currentFrame++;\n                        if (onProgress) {\n                            onProgress(currentFrame / totalFrames);\n                        }\n                        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n                        requestAnimationFrame(checkProgress);\n                    }\n                };\n                checkProgress();\n            };\n            video.onerror = reject;\n        });\n    };\n    return VideoTrimmerService;\n}();\nvar videoTrimmerService = new VideoTrimmerService();\n// Create a singleton instance\nvar firebaseStorageService = new FirebaseStorageService();\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZS9zdG9yYWdlL3NlcnZpY2UudHM/NjIxZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvc2VydmljZXMvRmlyZWJhc2VTdG9yYWdlU2VydmljZS50c1xuaW1wb3J0IHsgZ2V0U3RvcmFnZSwgcmVmLCB1cGxvYWRCeXRlcywgZ2V0RG93bmxvYWRVUkwgfSBmcm9tIFwiZmlyZWJhc2Uvc3RvcmFnZVwiO1xuaW1wb3J0IHsgVXNlciB9IGZyb20gXCIuLi8uLi8uLi9hcGkvZmlyZWJhc2UvdXNlclwiO1xuaW1wb3J0IHsgdXNlclNlcnZpY2UgfSBmcm9tIFwiLi4vLi4vLi4vYXBpL2ZpcmViYXNlL3VzZXJcIjtcbmltcG9ydCB7IGF1dGggfSBmcm9tIFwiLi4vLi4vLi4vYXBpL2ZpcmViYXNlL2NvbmZpZ1wiO1xuXG5leHBvcnQgZW51bSBVcGxvYWRJbWFnZVR5cGUge1xuICBQcm9maWxlID0gXCJwcm9maWxlX2ltYWdlc1wiLFxuICBGZWVkYmFjayA9IFwiZmVlZGJhY2tcIixcbiAgQ2hlY2tJbiA9IFwiY2hlY2tpblwiLFxuICBNZWFsID0gXCJtZWFsXCIsXG4gIEdyb3VwQ2hhdCA9IFwiZ3JvdXBfY2hhdFwiXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXBsb2FkUmVzdWx0IHtcbiAgZ3NVUkw6IHN0cmluZztcbiAgZG93bmxvYWRVUkw6IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IGVudW0gVmlkZW9UeXBlIHtcbiAgICBFeGVyY2lzZSA9IFwiZXhlcmNpc2VcIixcbiAgICBJbnRybyA9IFwiaW50cm9cIixcbiAgICBSb3VuZENoYXQgPSBcInJvdW5kLWNoYXRcIlxufVxuXG5leHBvcnQgY2xhc3MgRmlyZWJhc2VTdG9yYWdlU2VydmljZSB7XG4gIHByaXZhdGUgc3RvcmFnZSA9IGdldFN0b3JhZ2UoKTtcblxuICBhc3luYyB1cGxvYWRWaWRlbyhcbiAgICAgIGZpbGU6IEZpbGUsIFxuICAgICAgdmlkZW9UeXBlOiBWaWRlb1R5cGUgPSBWaWRlb1R5cGUuRXhlcmNpc2VcbiAgICApOiBQcm9taXNlPFVwbG9hZFJlc3VsdD4ge1xuICAgICAgLy8gRW5zdXJlIHVzZXIgaXMgYXV0aGVudGljYXRlZFxuICAgICAgY29uc3QgdXNlciA9IGF1dGguY3VycmVudFVzZXI7XG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVXNlciBtdXN0IGJlIGF1dGhlbnRpY2F0ZWQgdG8gdXBsb2FkIHZpZGVvXCIpO1xuICAgICAgfVxuICBcbiAgICAgIC8vIFZhbGlkYXRlIGZpbGUgdHlwZSBhbmQgc2l6ZVxuICAgICAgY29uc3QgQUxMT1dFRF9UWVBFUyA9IFsndmlkZW8vbXA0JywgJ3ZpZGVvL3F1aWNrdGltZScsICd2aWRlby94LW1zdmlkZW8nXTtcbiAgICAgIGNvbnN0IE1BWF9GSUxFX1NJWkUgPSAxMDAgKiAxMDI0ICogMTAyNDsgLy8gMTAwTUJcbiAgXG4gICAgICBpZiAoIUFMTE9XRURfVFlQRVMuaW5jbHVkZXMoZmlsZS50eXBlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGZpbGUgdHlwZS4gT25seSBNUDQsIEFWSSwgYW5kIFF1aWNrVGltZSB2aWRlb3MgYXJlIGFsbG93ZWQuXCIpO1xuICAgICAgfVxuICBcbiAgICAgIGlmIChmaWxlLnNpemUgPiBNQVhfRklMRV9TSVpFKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZpbGUgaXMgdG9vIGxhcmdlLiBNYXhpbXVtIHNpemUgaXMgMTAwTUIuXCIpO1xuICAgICAgfVxuICBcbiAgICAgIC8vIEdlbmVyYXRlIHVuaXF1ZSBmaWxlbmFtZVxuICAgICAgY29uc3QgZmlsZU5hbWUgPSBgJHtEYXRlLm5vdygpfV8ke2ZpbGUubmFtZX1gO1xuICAgICAgY29uc3Qgc3RvcmFnZVBhdGggPSBgdmlkZW9zLyR7dXNlci51aWR9LyR7ZmlsZU5hbWV9YDtcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIHN0b3JhZ2UgcmVmZXJlbmNlXG4gICAgICBjb25zdCBzdG9yYWdlUmVmID0gcmVmKGdldFN0b3JhZ2UoKSwgc3RvcmFnZVBhdGgpO1xuICBcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIFVwbG9hZCB0aGUgZmlsZVxuICAgICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IHVwbG9hZEJ5dGVzKHN0b3JhZ2VSZWYsIGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGRvd25sb2FkIFVSTFxuICAgICAgICBjb25zdCBkb3dubG9hZFVSTCA9IGF3YWl0IGdldERvd25sb2FkVVJMKHNuYXBzaG90LnJlZik7XG4gICAgICAgIFxuICAgICAgICAvLyBDb25zdHJ1Y3QgR1MgVVJMIChHb29nbGUgU3RvcmFnZSBVUkwpXG4gICAgICAgIGNvbnN0IGdzVVJMID0gYGdzOi8vJHtzbmFwc2hvdC5yZWYuYnVja2V0fS8ke3NuYXBzaG90LnJlZi5mdWxsUGF0aH1gO1xuICBcbiAgICAgICAgcmV0dXJuIHsgZ3NVUkwsIGRvd25sb2FkVVJMIH07XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiVmlkZW8gdXBsb2FkIGZhaWxlZFwiLCBlcnJvcik7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfVxuICAgIH1cblxuICBhc3luYyB1cGxvYWRJbWFnZShcbiAgICBmaWxlOiBGaWxlLCBcbiAgICBpbWFnZVR5cGU6IFVwbG9hZEltYWdlVHlwZSA9IFVwbG9hZEltYWdlVHlwZS5Qcm9maWxlXG4gICk6IFByb21pc2U8VXBsb2FkUmVzdWx0PiB7XG4gICAgLy8gRW5zdXJlIHVzZXIgaXMgYXV0aGVudGljYXRlZFxuICAgIGNvbnN0IHVzZXIgPSBhdXRoLmN1cnJlbnRVc2VyO1xuICAgIGlmICghdXNlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVXNlciBtdXN0IGJlIGF1dGhlbnRpY2F0ZWQgdG8gdXBsb2FkIGltYWdlXCIpO1xuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIHVuaXF1ZSBmaWxlbmFtZVxuICAgIGNvbnN0IGZpbGVOYW1lID0gYCR7RGF0ZS5ub3coKX1fJHtmaWxlLm5hbWV9YDtcbiAgICBjb25zdCBzdG9yYWdlUGF0aCA9IGAke2ltYWdlVHlwZX0vJHt1c2VyLnVpZH0vJHtmaWxlTmFtZX1gO1xuICAgIFxuICAgIC8vIENyZWF0ZSBzdG9yYWdlIHJlZmVyZW5jZVxuICAgIGNvbnN0IHN0b3JhZ2VSZWYgPSByZWYodGhpcy5zdG9yYWdlLCBzdG9yYWdlUGF0aCk7XG5cbiAgICB0cnkge1xuICAgICAgLy8gVXBsb2FkIHRoZSBmaWxlXG4gICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IHVwbG9hZEJ5dGVzKHN0b3JhZ2VSZWYsIGZpbGUpO1xuICAgICAgXG4gICAgICAvLyBHZXQgZG93bmxvYWQgVVJMXG4gICAgICBjb25zdCBkb3dubG9hZFVSTCA9IGF3YWl0IGdldERvd25sb2FkVVJMKHNuYXBzaG90LnJlZik7XG4gICAgICBcbiAgICAgIC8vIENvbnN0cnVjdCBHUyBVUkwgKEdvb2dsZSBTdG9yYWdlIFVSTClcbiAgICAgIGNvbnN0IGdzVVJMID0gYGdzOi8vJHtzbmFwc2hvdC5yZWYuYnVja2V0fS8ke3NuYXBzaG90LnJlZi5mdWxsUGF0aH1gO1xuXG4gICAgICAvLyBJZiBpdCdzIGEgcHJvZmlsZSBpbWFnZSwgdXBkYXRlIHRoZSB1c2VyXG4gICAgICBpZiAoaW1hZ2VUeXBlID09PSBVcGxvYWRJbWFnZVR5cGUuUHJvZmlsZSkge1xuICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZVVzZXJQcm9maWxlSW1hZ2UoZG93bmxvYWRVUkwpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4geyBnc1VSTCwgZG93bmxvYWRVUkwgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkltYWdlIHVwbG9hZCBmYWlsZWRcIiwgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyB1cGRhdGVVc2VyUHJvZmlsZUltYWdlKGltYWdlVVJMOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBFbnN1cmUgY3VycmVudCB1c2VyIGV4aXN0c1xuICAgIGlmICghdXNlclNlcnZpY2UuY3VycmVudFVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIGN1cnJlbnQgdXNlciBmb3VuZFwiKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgYSBuZXcgVXNlciBvYmplY3Qgd2l0aCB1cGRhdGVkIHByb2ZpbGUgaW1hZ2VcbiAgICBjb25zdCB1cGRhdGVkVXNlciA9IG5ldyBVc2VyKHtcbiAgICAgIC4uLnVzZXJTZXJ2aWNlLmN1cnJlbnRVc2VyLnRvRGljdGlvbmFyeSgpLFxuICAgICAgcHJvZmlsZUltYWdlOiB7XG4gICAgICAgIHByb2ZpbGVJbWFnZVVSTDogaW1hZ2VVUkwsXG4gICAgICAgIGltYWdlT2Zmc2V0V2lkdGg6IDAsICAvLyBZb3UgbWlnaHQgd2FudCB0byBtYWtlIHRoZXNlIGNvbmZpZ3VyYWJsZVxuICAgICAgICBpbWFnZU9mZnNldEhlaWdodDogMFxuICAgICAgfSxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgIH0pO1xuXG4gICAgLy8gVXBkYXRlIHVzZXIgaW4gRmlyZXN0b3JlXG4gICAgYXdhaXQgdXNlclNlcnZpY2UudXBkYXRlVXNlcih1cGRhdGVkVXNlci5pZCwgdXBkYXRlZFVzZXIpO1xuICB9XG5cbiAgLy8gT3B0aW9uYWw6IEltYWdlIGNhY2hpbmcgc2ltaWxhciB0byBpT1MgaW1wbGVtZW50YXRpb25cbiAgcHJpdmF0ZSBpbWFnZUNhY2hlOiBNYXA8c3RyaW5nLCBzdHJpbmc+ID0gbmV3IE1hcCgpO1xuXG4gIGFzeW5jIGZldGNoSW1hZ2UodXJsOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIC8vIENoZWNrIGNhY2hlIGZpcnN0XG4gICAgaWYgKHRoaXMuaW1hZ2VDYWNoZS5oYXModXJsKSkge1xuICAgICAgcmV0dXJuIHRoaXMuaW1hZ2VDYWNoZS5nZXQodXJsKSE7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKTtcbiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCByZXNwb25zZS5ibG9iKCk7XG4gICAgICBjb25zdCBpbWFnZVVSTCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gICAgICBcbiAgICAgIC8vIENhY2hlIHRoZSBpbWFnZSBVUkxcbiAgICAgIHRoaXMuaW1hZ2VDYWNoZS5zZXQodXJsLCBpbWFnZVVSTCk7XG4gICAgICBcbiAgICAgIHJldHVybiBpbWFnZVVSTDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkltYWdlIGZldGNoIGZhaWxlZFwiLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cbn1cblxuXG4vLyBJbiBGaXJlYmFzZVN0b3JhZ2VTZXJ2aWNlLnRzLCB1cGRhdGUgdGhlIFZpZGVvVHJpbW1lclNlcnZpY2UgY2xhc3NcbmV4cG9ydCBjbGFzcyBWaWRlb1RyaW1tZXJTZXJ2aWNlIHtcbiAgICB0cmltVmlkZW8oXG4gICAgICBmaWxlOiBGaWxlLCBcbiAgICAgIHN0YXJ0VGltZTogbnVtYmVyLCBcbiAgICAgIGVuZFRpbWU6IG51bWJlcixcbiAgICAgIG9uUHJvZ3Jlc3M/OiAocHJvZ3Jlc3M6IG51bWJlcikgPT4gdm9pZFxuICAgICk6IFByb21pc2U8RmlsZT4ge1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3QgdmlkZW8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2aWRlbycpO1xuICAgICAgICB2aWRlby5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgdmlkZW8ub25sb2FkZWRtZXRhZGF0YSA9ICgpID0+IHtcbiAgICAgICAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICAgICAgICBjYW52YXMud2lkdGggPSB2aWRlby52aWRlb1dpZHRoO1xuICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSB2aWRlby52aWRlb0hlaWdodDtcbiAgICAgICAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoIWN0eCkge1xuICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCBjYW52YXMgY29udGV4dCcpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gIFxuICAgICAgICAgIGNvbnN0IG91dHB1dEZvcm1hdCA9IHtcbiAgICAgICAgICAgICd2aWRlby9tcDQnOiAndmlkZW8vd2VibScsXG4gICAgICAgICAgICAndmlkZW8vcXVpY2t0aW1lJzogJ3ZpZGVvL3dlYm0nLFxuICAgICAgICAgICAgJ3ZpZGVvL3gtbXN2aWRlbyc6ICd2aWRlby93ZWJtJ1xuICAgICAgICAgIH1bZmlsZS50eXBlXSB8fCAndmlkZW8vd2VibSc7XG4gIFxuICAgICAgICAgIGNvbnN0IG1lZGlhUmVjb3JkZXIgPSBuZXcgTWVkaWFSZWNvcmRlcihcbiAgICAgICAgICAgIGNhbnZhcy5jYXB0dXJlU3RyZWFtKCksIFxuICAgICAgICAgICAgeyBcbiAgICAgICAgICAgICAgbWltZVR5cGU6IG91dHB1dEZvcm1hdCxcbiAgICAgICAgICAgICAgdmlkZW9CaXRzUGVyU2Vjb25kOiAyNTAwMDAwIC8vIDIuNSBNYnBzIGZvciBiZXR0ZXIgcXVhbGl0eVxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgXG4gICAgICAgICAgY29uc3QgY2h1bmtzOiBCbG9iW10gPSBbXTtcbiAgICAgICAgICBtZWRpYVJlY29yZGVyLm9uZGF0YWF2YWlsYWJsZSA9IChlKSA9PiBjaHVua3MucHVzaChlLmRhdGEpO1xuICAgICAgICAgIFxuICAgICAgICAgIG1lZGlhUmVjb3JkZXIub25zdG9wID0gKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKGNodW5rcywgeyB0eXBlOiBvdXRwdXRGb3JtYXQgfSk7XG4gICAgICAgICAgICBjb25zdCB0cmltbWVkRmlsZSA9IG5ldyBGaWxlKFtibG9iXSwgYHRyaW1tZWQtJHtmaWxlLm5hbWV9YCwge1xuICAgICAgICAgICAgICB0eXBlOiBvdXRwdXRGb3JtYXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTCh2aWRlby5zcmMpO1xuICAgICAgICAgICAgcmVzb2x2ZSh0cmltbWVkRmlsZSk7XG4gICAgICAgICAgfTtcbiAgXG4gICAgICAgICAgdmlkZW8uY3VycmVudFRpbWUgPSBzdGFydFRpbWU7XG4gICAgICAgICAgbWVkaWFSZWNvcmRlci5zdGFydCgxMDAwKTsgLy8gQ2FwdHVyZSBpbiAxLXNlY29uZCBjaHVua3NcbiAgXG4gICAgICAgICAgY29uc3QgdG90YWxGcmFtZXMgPSAoZW5kVGltZSAtIHN0YXJ0VGltZSkgKiAzMDsgLy8gQXNzdW1pbmcgMzBmcHNcbiAgICAgICAgICBsZXQgY3VycmVudEZyYW1lID0gMDtcbiAgXG4gICAgICAgICAgY29uc3QgY2hlY2tQcm9ncmVzcyA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmICh2aWRlby5jdXJyZW50VGltZSA+PSBlbmRUaW1lKSB7XG4gICAgICAgICAgICAgIG1lZGlhUmVjb3JkZXIuc3RvcCgpO1xuICAgICAgICAgICAgICB2aWRlby5wYXVzZSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY3VycmVudEZyYW1lKys7XG4gICAgICAgICAgICAgIGlmIChvblByb2dyZXNzKSB7XG4gICAgICAgICAgICAgICAgb25Qcm9ncmVzcyhjdXJyZW50RnJhbWUgLyB0b3RhbEZyYW1lcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSh2aWRlbywgMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcbiAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNoZWNrUHJvZ3Jlc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gIFxuICAgICAgICAgIGNoZWNrUHJvZ3Jlc3MoKTtcbiAgICAgICAgfTtcbiAgXG4gICAgICAgIHZpZGVvLm9uZXJyb3IgPSByZWplY3Q7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuZXhwb3J0IGNvbnN0IHZpZGVvVHJpbW1lclNlcnZpY2UgPSBuZXcgVmlkZW9UcmltbWVyU2VydmljZSgpO1xuXG4vLyBDcmVhdGUgYSBzaW5nbGV0b24gaW5zdGFuY2VcbmV4cG9ydCBjb25zdCBmaXJlYmFzZVN0b3JhZ2VTZXJ2aWNlID0gbmV3IEZpcmViYXNlU3RvcmFnZVNlcnZpY2UoKTsiXSwibmFtZXMiOlsiZ2V0U3RvcmFnZSIsInJlZiIsInVwbG9hZEJ5dGVzIiwiZ2V0RG93bmxvYWRVUkwiLCJVc2VyIiwidXNlclNlcnZpY2UiLCJhdXRoIiwiVXBsb2FkSW1hZ2VUeXBlIiwiVmlkZW9UeXBlIiwiRmlyZWJhc2VTdG9yYWdlU2VydmljZSIsInN0b3JhZ2UiLCJpbWFnZUNhY2hlIiwiTWFwIiwidXBsb2FkVmlkZW8iLCJmaWxlIiwidmlkZW9UeXBlIiwidXNlciIsIkFMTE9XRURfVFlQRVMiLCJNQVhfRklMRV9TSVpFIiwiZmlsZU5hbWUiLCJzdG9yYWdlUGF0aCIsInN0b3JhZ2VSZWYiLCJzbmFwc2hvdCIsImRvd25sb2FkVVJMIiwiZ3NVUkwiLCJlcnJvciIsImN1cnJlbnRVc2VyIiwiRXJyb3IiLCJpbmNsdWRlcyIsInR5cGUiLCJzaXplIiwiRGF0ZSIsIm5vdyIsIm5hbWUiLCJ1aWQiLCJidWNrZXQiLCJmdWxsUGF0aCIsImNvbnNvbGUiLCJ1cGxvYWRJbWFnZSIsImltYWdlVHlwZSIsInVwZGF0ZVVzZXJQcm9maWxlSW1hZ2UiLCJpbWFnZVVSTCIsInVwZGF0ZWRVc2VyIiwidG9EaWN0aW9uYXJ5IiwicHJvZmlsZUltYWdlIiwicHJvZmlsZUltYWdlVVJMIiwiaW1hZ2VPZmZzZXRXaWR0aCIsImltYWdlT2Zmc2V0SGVpZ2h0IiwidXBkYXRlZEF0IiwidXBkYXRlVXNlciIsImlkIiwiZmV0Y2hJbWFnZSIsInVybCIsInJlc3BvbnNlIiwiYmxvYiIsImhhcyIsImdldCIsImZldGNoIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwic2V0IiwiVmlkZW9UcmltbWVyU2VydmljZSIsInRyaW1WaWRlbyIsInN0YXJ0VGltZSIsImVuZFRpbWUiLCJvblByb2dyZXNzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJ2aWRlbyIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInNyYyIsIm9ubG9hZGVkbWV0YWRhdGEiLCJjYW52YXMiLCJ3aWR0aCIsInZpZGVvV2lkdGgiLCJoZWlnaHQiLCJ2aWRlb0hlaWdodCIsImN0eCIsImdldENvbnRleHQiLCJvdXRwdXRGb3JtYXQiLCJtZWRpYVJlY29yZGVyIiwiTWVkaWFSZWNvcmRlciIsImNhcHR1cmVTdHJlYW0iLCJtaW1lVHlwZSIsInZpZGVvQml0c1BlclNlY29uZCIsImNodW5rcyIsIm9uZGF0YWF2YWlsYWJsZSIsImUiLCJwdXNoIiwiZGF0YSIsIm9uc3RvcCIsIkJsb2IiLCJ0cmltbWVkRmlsZSIsIkZpbGUiLCJyZXZva2VPYmplY3RVUkwiLCJjdXJyZW50VGltZSIsInN0YXJ0IiwidG90YWxGcmFtZXMiLCJjdXJyZW50RnJhbWUiLCJjaGVja1Byb2dyZXNzIiwic3RvcCIsInBhdXNlIiwiZHJhd0ltYWdlIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwib25lcnJvciIsInZpZGVvVHJpbW1lclNlcnZpY2UiLCJmaXJlYmFzZVN0b3JhZ2VTZXJ2aWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/api/firebase/storage/service.ts\n"));

/***/ })

});
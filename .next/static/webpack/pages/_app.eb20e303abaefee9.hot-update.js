"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("pages/_app",{

/***/ "./src/api/firebase/workout/service.ts":
/*!*********************************************!*\
  !*** ./src/api/firebase/workout/service.ts ***!
  \*********************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   workoutService: function() { return /* binding */ workoutService; }\n/* harmony export */ });\n/* harmony import */ var _swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @swc/helpers/_/_async_to_generator */ \"./node_modules/@swc/helpers/esm/_async_to_generator.js\");\n/* harmony import */ var _swc_helpers_class_call_check__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @swc/helpers/_/_class_call_check */ \"./node_modules/@swc/helpers/esm/_class_call_check.js\");\n/* harmony import */ var _swc_helpers_create_class__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @swc/helpers/_/_create_class */ \"./node_modules/@swc/helpers/esm/_create_class.js\");\n/* harmony import */ var _swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @swc/helpers/_/_object_spread */ \"./node_modules/@swc/helpers/esm/_object_spread.js\");\n/* harmony import */ var _swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @swc/helpers/_/_object_spread_props */ \"./node_modules/@swc/helpers/esm/_object_spread_props.js\");\n/* harmony import */ var _swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @swc/helpers/_/_sliced_to_array */ \"./node_modules/@swc/helpers/esm/_sliced_to_array.js\");\n/* harmony import */ var _swc_helpers_to_consumable_array__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @swc/helpers/_/_to_consumable_array */ \"./node_modules/@swc/helpers/esm/_to_consumable_array.js\");\n/* harmony import */ var _swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @swc/helpers/_/_ts_generator */ \"./node_modules/@swc/helpers/esm/_ts_generator.js\");\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/firestore */ \"./node_modules/firebase/firestore/dist/esm/index.esm.js\");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../config */ \"./src/api/firebase/config.ts\");\n/* harmony import */ var _user__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../user */ \"./src/api/firebase/user/index.ts\");\n/* harmony import */ var _exercise_types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../exercise/types */ \"./src/api/firebase/exercise/types.ts\");\n/* harmony import */ var _exercise_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../exercise/service */ \"./src/api/firebase/exercise/service.ts\");\n/* harmony import */ var _user_types__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../user/types */ \"./src/api/firebase/user/types.ts\");\n/* harmony import */ var _workout_types__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../api/firebase/workout/types */ \"./src/api/firebase/workout/types.ts\");\n/* harmony import */ var _barrel_optimize_names_format_date_fns__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! __barrel_optimize__?names=format!=!date-fns */ \"__barrel_optimize__?names=format!=!./node_modules/date-fns/index.js\");\n/* harmony import */ var _utils_timestamp__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../utils/timestamp */ \"./src/utils/timestamp.ts\");\n/* harmony import */ var _utils_formatDate__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../utils/formatDate */ \"./src/utils/formatDate.ts\");\n/* harmony import */ var _redux_store__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../redux/store */ \"./src/redux/store.ts\");\n/* harmony import */ var _redux_workoutSlice__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../redux/workoutSlice */ \"./src/redux/workoutSlice.ts\");\n// src/api/firebase/workout/service.ts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n // Adjust the import path\n\n\n\n\nvar WorkoutService = /*#__PURE__*/ function() {\n    \"use strict\";\n    function WorkoutService() {\n        (0,_swc_helpers_class_call_check__WEBPACK_IMPORTED_MODULE_11__._)(this, WorkoutService);\n    }\n    var _proto = WorkoutService.prototype;\n    _proto.generateId = function generateId() {\n        return (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"workouts\")).id;\n    };\n    // Update the formatWorkoutAndInitializeLogs function\n    _proto.formatWorkoutAndInitializeLogs = function formatWorkoutAndInitializeLogs(exerciseDetails, workoutAuthor) {\n        var _this = this;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var _userService_currentUser, workId, exerciseReferences, exerciseLogs, validExerciseDetails, newWorkout;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                workId = _this.generateId(); // Use this.generateId() since it's a class method\n                exerciseReferences = [];\n                exerciseLogs = [];\n                // Ensure exercise details are valid before processing\n                validExerciseDetails = exerciseDetails.filter(function(detail) {\n                    return (detail === null || detail === void 0 ? void 0 : detail.exercise) && detail.exercise.id;\n                });\n                validExerciseDetails.forEach(function(detail, index) {\n                    var _detail_category, _category_details, _category_details1, _category_details2, _userService_currentUser, _userService_currentUser1;\n                    // Ensure exercise instance has all required fields\n                    var exerciseInstance = new _exercise_types__WEBPACK_IMPORTED_MODULE_3__.Exercise((0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, detail.exercise), {\n                        id: detail.exercise.id || workoutService.generateId(),\n                        name: detail.exercise.name || \"\",\n                        author: detail.exercise.author || {\n                            userId: workoutAuthor || \"PulseAI\",\n                            username: workoutAuthor || \"PulseAI\"\n                        },\n                        description: detail.exercise.description || \"\",\n                        category: detail.exercise.category || {\n                            type: \"weight-training\",\n                            details: null\n                        },\n                        primaryBodyParts: detail.exercise.primaryBodyParts || [],\n                        secondaryBodyParts: detail.exercise.secondaryBodyParts || [],\n                        tags: detail.exercise.tags || [],\n                        videos: detail.exercise.videos || [],\n                        createdAt: detail.exercise.createdAt || new Date(),\n                        updatedAt: detail.exercise.updatedAt || new Date()\n                    }));\n                    // Create exercise reference with required fields\n                    var exerciseRef = {\n                        exercise: exerciseInstance,\n                        groupId: detail.groupId || 0\n                    };\n                    exerciseReferences.push(exerciseRef);\n                    // Set default values for exercise parameters\n                    var category = ((_detail_category = detail.category) === null || _detail_category === void 0 ? void 0 : _detail_category.type) === \"weight-training\" ? detail.category : {\n                        type: \"weight-training\",\n                        details: {\n                            sets: 3,\n                            reps: [\n                                \"12\"\n                            ],\n                            weight: 0,\n                            screenTime: 0\n                        }\n                    };\n                    var _category_details_sets;\n                    var sets = (_category_details_sets = (_category_details = category.details) === null || _category_details === void 0 ? void 0 : _category_details.sets) !== null && _category_details_sets !== void 0 ? _category_details_sets : 3;\n                    var _category_details_reps;\n                    var reps = (_category_details_reps = (_category_details1 = category.details) === null || _category_details1 === void 0 ? void 0 : _category_details1.reps) !== null && _category_details_reps !== void 0 ? _category_details_reps : [\n                        \"12\"\n                    ];\n                    var _category_details_weight;\n                    var weight = (_category_details_weight = (_category_details2 = category.details) === null || _category_details2 === void 0 ? void 0 : _category_details2.weight) !== null && _category_details_weight !== void 0 ? _category_details_weight : 0;\n                    // Create logs for each set with validated data\n                    var setsLogs = Array.from({\n                        length: sets\n                    }, function() {\n                        return new _workout_types__WEBPACK_IMPORTED_MODULE_6__.RepsAndWeightLog({\n                            reps: parseInt(reps[0] || \"12\", 10),\n                            weight: weight || 0\n                        });\n                    });\n                    // Create exercise log with validated data\n                    var exerciseLogId = _exercise_service__WEBPACK_IMPORTED_MODULE_4__.exerciseService.generateExerciseLogID(workId, ((_userService_currentUser = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser) === null || _userService_currentUser === void 0 ? void 0 : _userService_currentUser.id) || \"anonymous\");\n                    var log = new _exercise_types__WEBPACK_IMPORTED_MODULE_3__.ExerciseLog({\n                        id: exerciseLogId,\n                        workoutId: workId,\n                        userId: ((_userService_currentUser1 = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser) === null || _userService_currentUser1 === void 0 ? void 0 : _userService_currentUser1.id) || \"anonymous\",\n                        exercise: exerciseInstance,\n                        logs: setsLogs,\n                        feedback: \"\",\n                        note: detail.notes || \"\",\n                        isSplit: detail.isSplit || false,\n                        logSubmitted: false,\n                        logIsEditing: false,\n                        isCompleted: false,\n                        order: index + 1,\n                        createdAt: new Date(),\n                        updatedAt: new Date(),\n                        completedAt: new Date()\n                    });\n                    exerciseLogs.push(log);\n                });\n                // Create workout with validated data\n                newWorkout = new _workout_types__WEBPACK_IMPORTED_MODULE_6__.Workout({\n                    id: workId,\n                    roundWorkoutId: \"\",\n                    exercises: exerciseReferences,\n                    logs: exerciseLogs,\n                    title: \"\",\n                    description: \"\",\n                    duration: _workout_types__WEBPACK_IMPORTED_MODULE_6__.Workout.estimatedDuration(exerciseReferences) || 0,\n                    workoutRating: \"none\",\n                    useAuthorContent: false,\n                    isCompleted: false,\n                    workoutStatus: \"archived\",\n                    author: ((_userService_currentUser = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser) === null || _userService_currentUser === void 0 ? void 0 : _userService_currentUser.id) || \"PulseAI\",\n                    createdAt: new Date(),\n                    updatedAt: new Date(),\n                    zone: _workout_types__WEBPACK_IMPORTED_MODULE_6__.Workout.determineWorkoutZone(exerciseReferences) || \"full\"\n                });\n                return [\n                    2,\n                    {\n                        workout: newWorkout,\n                        exerciseLogs: exerciseLogs\n                    }\n                ];\n            });\n        })();\n    };\n    _proto.getUserById = function getUserById(userId) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var userDoc, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        _state.trys.push([\n                            0,\n                            2,\n                            ,\n                            3\n                        ]);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId))\n                        ];\n                    case 1:\n                        userDoc = _state.sent();\n                        if (!userDoc.exists()) {\n                            throw new Error(\"User not found\");\n                        }\n                        return [\n                            2,\n                            new _user_types__WEBPACK_IMPORTED_MODULE_5__.User((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                id: userDoc.id\n                            }, userDoc.data()))\n                        ];\n                    case 2:\n                        error = _state.sent();\n                        console.error(\"Error getting user by ID:\", error);\n                        throw error;\n                    case 3:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    // In WorkoutService\n    _proto.revertAuthorFormat = function revertAuthorFormat(workoutId, authorId) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var _userService_currentUser, workoutRef;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        if (!((_userService_currentUser = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser) === null || _userService_currentUser === void 0 ? void 0 : _userService_currentUser.id)) throw new Error(\"No user signed in\");\n                        workoutRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser.id, \"MyCreatedWorkouts\", workoutId);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(workoutRef, {\n                                author: authorId\n                            })\n                        ];\n                    case 1:\n                        _state.sent();\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.updateWorkout = function updateWorkout(workout) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var _userService_currentUser, workoutRef, batch, logsRef, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        if (!((_userService_currentUser = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser) === null || _userService_currentUser === void 0 ? void 0 : _userService_currentUser.id)) {\n                            throw new Error(\"No user is signed in\");\n                        }\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            5,\n                            ,\n                            6\n                        ]);\n                        workoutRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser.id, \"MyCreatedWorkouts\", workout.id);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(workoutRef, workout.toDictionary(), {\n                                merge: true\n                            })\n                        ];\n                    case 2:\n                        _state.sent();\n                        if (!(workout.logs && workout.logs.length > 0)) return [\n                            3,\n                            4\n                        ];\n                        batch = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.writeBatch)(_config__WEBPACK_IMPORTED_MODULE_1__.db);\n                        logsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(workoutRef, \"logs\");\n                        workout.logs.forEach(function(log) {\n                            var logRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(logsRef, log.id);\n                            batch.set(logRef, log.toDictionary(), {\n                                merge: true\n                            });\n                        });\n                        return [\n                            4,\n                            batch.commit()\n                        ];\n                    case 3:\n                        _state.sent();\n                        _state.label = 4;\n                    case 4:\n                        return [\n                            3,\n                            6\n                        ];\n                    case 5:\n                        error = _state.sent();\n                        console.error(\"Error updating workout:\", error);\n                        throw error;\n                    case 6:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    /**\n   * Fetch the user's current workout (either QueuedUp or InProgress).\n   */ _proto.fetchCurrentWorkout = function fetchCurrentWorkout(userId) {\n        var _this = this;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var session;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        return [\n                            4,\n                            _this.fetchCurrentWorkoutSession(userId)\n                        ];\n                    case 1:\n                        session = _state.sent();\n                        return [\n                            2,\n                            session.workout\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.getAllSweatlists = function getAllSweatlists(userId) {\n        var _this = this;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var workoutsRef, exercisesWithVideos, workoutsSnapshot, workouts, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, workoutDoc, workoutData, workoutId, mappedExercises, workout, logsRef, logsSnapshot, err, error, firestoreError;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        if (!userId) {\n                            throw new Error(\"User ID is required\");\n                        }\n                        // Reference to the user's workout collection\n                        workoutsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId, \"MyCreatedWorkouts\");\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            12,\n                            ,\n                            13\n                        ]);\n                        return [\n                            4,\n                            _this.fetchAndMapExercisesWithVideos()\n                        ];\n                    case 2:\n                        exercisesWithVideos = _state.sent();\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(workoutsRef)\n                        ];\n                    case 3:\n                        workoutsSnapshot = _state.sent();\n                        workouts = [];\n                        _iteratorNormalCompletion = true, _didIteratorError = false, _iteratorError = undefined;\n                        _state.label = 4;\n                    case 4:\n                        _state.trys.push([\n                            4,\n                            9,\n                            10,\n                            11\n                        ]);\n                        _iterator = workoutsSnapshot.docs[Symbol.iterator]();\n                        _state.label = 5;\n                    case 5:\n                        if (!!(_iteratorNormalCompletion = (_step = _iterator.next()).done)) return [\n                            3,\n                            8\n                        ];\n                        workoutDoc = _step.value;\n                        workoutData = workoutDoc.data();\n                        workoutId = workoutDoc.id;\n                        // Map the exercises in the workout to the full exercise objects with videos\n                        mappedExercises = (workoutData.exercises || []).map(function(exerciseRef) {\n                            var fullExercise = exercisesWithVideos.find(function(ex) {\n                                return ex.name === exerciseRef.exercise.name;\n                            });\n                            console.log(\"This is the mapped exercise: \" + fullExercise);\n                            return (0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, exerciseRef), {\n                                exercise: fullExercise || exerciseRef\n                            });\n                        });\n                        // Parse workout data into the desired structure\n                        workout = new _workout_types__WEBPACK_IMPORTED_MODULE_6__.Workout({\n                            id: workoutData.id || \"\",\n                            roundWorkoutId: workoutData.roundWorkoutId || \"\",\n                            collectionId: workoutData.collectionId,\n                            exercises: mappedExercises,\n                            challenge: workoutData.challenge,\n                            logs: [],\n                            title: workoutData.title || \"\",\n                            description: workoutData.description || \"\",\n                            duration: workoutData.duration || 0,\n                            workoutRating: workoutData.workoutRating,\n                            useAuthorContent: workoutData.useAuthorContent || false,\n                            isCompleted: workoutData.isCompleted || false,\n                            workoutStatus: workoutData.workoutStatus || \"notStarted\",\n                            startTime: workoutData.startTime ? new Date(workoutData.startTime) : undefined,\n                            order: workoutData.order,\n                            author: workoutData.author || userId,\n                            createdAt: workoutData.createdAt ? new Date(workoutData.createdAt) : new Date(),\n                            updatedAt: workoutData.updatedAt ? new Date(workoutData.updatedAt) : new Date(),\n                            zone: workoutData.zone || \"FULL_BODY\"\n                        });\n                        // Fetch and process logs\n                        logsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId, \"MyCreatedWorkouts\", workoutId, \"logs\");\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(logsRef)\n                        ];\n                    case 6:\n                        logsSnapshot = _state.sent();\n                        workout.logs = logsSnapshot.docs.map(function(logDoc) {\n                            return (0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, logDoc.data()), {\n                                id: logDoc.id\n                            });\n                        });\n                        workouts.push(workout);\n                        _state.label = 7;\n                    case 7:\n                        _iteratorNormalCompletion = true;\n                        return [\n                            3,\n                            5\n                        ];\n                    case 8:\n                        return [\n                            3,\n                            11\n                        ];\n                    case 9:\n                        err = _state.sent();\n                        _didIteratorError = true;\n                        _iteratorError = err;\n                        return [\n                            3,\n                            11\n                        ];\n                    case 10:\n                        try {\n                            if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n                                _iterator[\"return\"]();\n                            }\n                        } finally{\n                            if (_didIteratorError) {\n                                throw _iteratorError;\n                            }\n                        }\n                        return [\n                            7\n                        ];\n                    case 11:\n                        return [\n                            2,\n                            workouts\n                        ];\n                    case 12:\n                        error = _state.sent();\n                        firestoreError = error;\n                        console.error(\"Error fetching sweatlists:\", firestoreError.message);\n                        throw new Error(\"Failed to fetch sweatlists\");\n                    case 13:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.getUserChallengesByChallengeId = function getUserChallengesByChallengeId(challengeId) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var userChallengesRef, q, snapshot, userChallenges, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        userChallengesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"user-challenge\");\n                        q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(userChallengesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"challengeId\", \"==\", challengeId));\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            3,\n                            ,\n                            4\n                        ]);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q)\n                        ];\n                    case 2:\n                        snapshot = _state.sent();\n                        userChallenges = snapshot.docs.map(function(doc) {\n                            var data = doc.data();\n                            return new _workout_types__WEBPACK_IMPORTED_MODULE_6__.UserChallenge(data);\n                        });\n                        if (userChallenges.length > 0) {\n                            return [\n                                2,\n                                {\n                                    userChallenges: userChallenges\n                                }\n                            ];\n                        } else {\n                            return [\n                                2,\n                                {\n                                    userChallenges: [],\n                                    error: \"No user challenges found for this challenge.\"\n                                }\n                            ];\n                        }\n                        return [\n                            3,\n                            4\n                        ];\n                    case 3:\n                        error = _state.sent();\n                        console.error(\"Error fetching user challenges by challengeId:\", error);\n                        return [\n                            2,\n                            {\n                                userChallenges: [],\n                                error: error instanceof Error ? error.message : \"Unknown error\"\n                            }\n                        ];\n                    case 4:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    /**\n   * Fetches workout summaries for a specific date.\n   * @param date - The date for which workout summaries are being fetched.\n   * @returns A promise resolving to an array of workout summaries.\n   * @throws If no user is signed in or if the Firestore query fails.\n   */ _proto.fetchWorkoutSummaries = function fetchWorkoutSummaries(date) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var currentUser, formattedDate, summariesRef, q, snapshot, error, firestoreError;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        currentUser = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser;\n                        if (!(currentUser === null || currentUser === void 0 ? void 0 : currentUser.id)) {\n                            throw new Error(\"No user is signed in\");\n                        }\n                        // Format the date to match the format in Firestore ('MM-dd-yyyy')\n                        formattedDate = (0,_barrel_optimize_names_format_date_fns__WEBPACK_IMPORTED_MODULE_16__.format)(date, \"MM-dd-yyyy\");\n                        // Reference to the user's workoutSummaries subcollection\n                        summariesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", currentUser.id, \"workoutSummaries\");\n                        // Create a query to filter documents by the specified date\n                        q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(summariesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"date\", \"==\", formattedDate));\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            3,\n                            ,\n                            4\n                        ]);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q)\n                        ];\n                    case 2:\n                        snapshot = _state.sent();\n                        // Map the documents to an array of WorkoutSummary objects\n                        return [\n                            2,\n                            snapshot.docs.map(function(doc) {\n                                return (0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                    id: doc.id\n                                }, doc.data());\n                            })\n                        ];\n                    case 3:\n                        error = _state.sent();\n                        firestoreError = error;\n                        console.error(\"Error fetching workout summaries:\", firestoreError.message);\n                        throw new Error(firestoreError.message);\n                    case 4:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.fetchAllWorkoutSummaries = function fetchAllWorkoutSummaries() {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var currentUser, summariesRef, q, snapshot, error, firestoreError;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        currentUser = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser;\n                        if (!(currentUser === null || currentUser === void 0 ? void 0 : currentUser.id)) {\n                            throw new Error(\"No user is signed in\");\n                        }\n                        // Reference to the user's workoutSummaries subcollection\n                        summariesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", currentUser.id, \"workoutSummary\");\n                        // Query to retrieve all workout summaries, sorted by `createdAt` in ascending order\n                        q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(summariesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"asc\")); // Adjust field name based on your schema\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            3,\n                            ,\n                            4\n                        ]);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q)\n                        ];\n                    case 2:\n                        snapshot = _state.sent();\n                        // Map the documents to an array of WorkoutSummary objects\n                        return [\n                            2,\n                            snapshot.docs.map(function(doc) {\n                                return (0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                    id: doc.id\n                                }, doc.data());\n                            })\n                        ];\n                    case 3:\n                        error = _state.sent();\n                        firestoreError = error;\n                        console.error(\"Error fetching all workout summaries:\", firestoreError.message);\n                        throw new Error(firestoreError.message);\n                    case 4:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    /**\n * Fetch user challenges by userId.\n * @param userId The ID of the user to fetch challenges for.\n * @returns A promise resolving to an array of user challenges.\n * @throws If the Firestore query fails.\n */ _proto.fetchUserChallengesByUserId = function fetchUserChallengesByUserId(userId) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var userChallengesRef, q, snapshot, userChallenges, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        userChallengesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"user-challenge\");\n                        q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(userChallengesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId));\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            3,\n                            ,\n                            4\n                        ]);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q)\n                        ];\n                    case 2:\n                        snapshot = _state.sent();\n                        // console.log(`Total challenges fetched: ${snapshot.docs.length}`);\n                        userChallenges = snapshot.docs.map(function(doc) {\n                            var data = doc.data();\n                            // console.log(`Processing challenge with ID: ${doc.id}`, data);\n                            return (0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                id: doc.id\n                            }, data), {\n                                challenge: data.challenge ? new _workout_types__WEBPACK_IMPORTED_MODULE_6__.Challenge({\n                                    id: data.challenge.id,\n                                    title: data.challenge.title,\n                                    subtitle: data.challenge.subtitle,\n                                    participants: data.challenge.participants || [],\n                                    status: data.challenge.status,\n                                    startDate: data.challenge.startDate ? new Date(data.challenge.startDate) : new Date(),\n                                    endDate: data.challenge.endDate ? new Date(data.challenge.endDate) : new Date(),\n                                    createdAt: data.challenge.createdAt ? new Date(data.challenge.createdAt) : new Date(),\n                                    updatedAt: data.challenge.updatedAt ? new Date(data.challenge.updatedAt) : new Date(),\n                                    introVideos: (data.challenge.introVideos || []).map(function(v) {\n                                        return new _workout_types__WEBPACK_IMPORTED_MODULE_6__.IntroVideo({\n                                            id: v.id,\n                                            userId: v.userId,\n                                            videoUrl: v.videoUrl\n                                        });\n                                    })\n                                }) : undefined,\n                                createdAt: (0,_utils_timestamp__WEBPACK_IMPORTED_MODULE_7__.convertTimestamp)(data.createdAt),\n                                updatedAt: (0,_utils_timestamp__WEBPACK_IMPORTED_MODULE_7__.convertTimestamp)(data.updatedAt)\n                            });\n                        });\n                        // console.log('All challenges after processing:', JSON.stringify(userChallenges, null, 2));\n                        return [\n                            2,\n                            userChallenges\n                        ];\n                    case 3:\n                        error = _state.sent();\n                        console.error(\"Error fetching user challenges by userId:\", error);\n                        throw error;\n                    case 4:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.fetchCollectionWithSweatLists = function fetchCollectionWithSweatLists(collectionId) {\n        var _this = this;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var collection, sweatLists, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, sweatlistIdentifier, _ref, workout, error, err, error1;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        _state.trys.push([\n                            0,\n                            12,\n                            ,\n                            13\n                        ]);\n                        return [\n                            4,\n                            _this.getCollectionById(collectionId)\n                        ];\n                    case 1:\n                        collection = _state.sent();\n                        // Fetch sweat lists (workouts)\n                        sweatLists = [];\n                        _iteratorNormalCompletion = true, _didIteratorError = false, _iteratorError = undefined;\n                        _state.label = 2;\n                    case 2:\n                        _state.trys.push([\n                            2,\n                            9,\n                            10,\n                            11\n                        ]);\n                        _iterator = (collection.sweatlistIds || [])[Symbol.iterator]();\n                        _state.label = 3;\n                    case 3:\n                        if (!!(_iteratorNormalCompletion = (_step = _iterator.next()).done)) return [\n                            3,\n                            8\n                        ];\n                        sweatlistIdentifier = _step.value;\n                        _state.label = 4;\n                    case 4:\n                        _state.trys.push([\n                            4,\n                            6,\n                            ,\n                            7\n                        ]);\n                        return [\n                            4,\n                            _this.fetchSavedWorkout(sweatlistIdentifier.sweatlistAuthorId, sweatlistIdentifier.id)\n                        ];\n                    case 5:\n                        _ref = _swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_17__._.apply(void 0, [\n                            _state.sent(),\n                            1\n                        ]), workout = _ref[0];\n                        if (workout) {\n                            sweatLists.push(workout);\n                        }\n                        return [\n                            3,\n                            7\n                        ];\n                    case 6:\n                        error = _state.sent();\n                        console.error(\"Error fetching workout \".concat(sweatlistIdentifier.id, \":\"), error);\n                        return [\n                            3,\n                            7\n                        ];\n                    case 7:\n                        _iteratorNormalCompletion = true;\n                        return [\n                            3,\n                            3\n                        ];\n                    case 8:\n                        return [\n                            3,\n                            11\n                        ];\n                    case 9:\n                        err = _state.sent();\n                        _didIteratorError = true;\n                        _iteratorError = err;\n                        return [\n                            3,\n                            11\n                        ];\n                    case 10:\n                        try {\n                            if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n                                _iterator[\"return\"]();\n                            }\n                        } finally{\n                            if (_didIteratorError) {\n                                throw _iteratorError;\n                            }\n                        }\n                        return [\n                            7\n                        ];\n                    case 11:\n                        return [\n                            2,\n                            {\n                                collection: collection,\n                                sweatLists: sweatLists\n                            }\n                        ];\n                    case 12:\n                        error1 = _state.sent();\n                        console.error(\"Error fetching collection with sweat lists:\", error1);\n                        throw error1;\n                    case 13:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.fetchSavedWorkout = function fetchSavedWorkout(userId, workoutId) {\n        var _this = this;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var workoutRef, workoutSnap, workoutData, exercisesWithVideos, mappedExercises, workout, logsRef, logsSnapshot, logs, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        _state.trys.push([\n                            0,\n                            4,\n                            ,\n                            5\n                        ]);\n                        // Fetch workout document\n                        workoutRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId, \"MyCreatedWorkouts\", workoutId);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(workoutRef)\n                        ];\n                    case 1:\n                        workoutSnap = _state.sent();\n                        if (!workoutSnap.exists()) {\n                            return [\n                                2,\n                                [\n                                    null,\n                                    null\n                                ]\n                            ];\n                        }\n                        workoutData = workoutSnap.data();\n                        return [\n                            4,\n                            _this.fetchAndMapExercisesWithVideos()\n                        ];\n                    case 2:\n                        exercisesWithVideos = _state.sent();\n                        // Map the exercises\n                        mappedExercises = (workoutData.exercises || []).map(function(exerciseRef) {\n                            var fullExercise = exercisesWithVideos.find(function(ex) {\n                                return ex.name === exerciseRef.exercise.name;\n                            });\n                            return (0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, exerciseRef), {\n                                exercise: fullExercise || exerciseRef.exercise\n                            });\n                        });\n                        workoutData.exercises = mappedExercises;\n                        workout = new _workout_types__WEBPACK_IMPORTED_MODULE_6__.Workout((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                            id: workoutId\n                        }, workoutData));\n                        // Fetch and map logs\n                        logsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(workoutRef, \"logs\");\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(logsRef)\n                        ];\n                    case 3:\n                        logsSnapshot = _state.sent();\n                        console.log(\"Found logs count:\", logsSnapshot.size);\n                        logs = logsSnapshot.docs.map(function(logDoc) {\n                            var _fullExercise_category;\n                            var logData = logDoc.data();\n                            console.log(\"Raw log data from Firebase:\", {\n                                exerciseName: logData.exercise.name,\n                                exerciseCategory: logData.exercise.category\n                            });\n                            var fullExercise = exercisesWithVideos.find(function(ex) {\n                                return ex.name === logData.exercise.name;\n                            });\n                            console.log(\"Exercise Category Details:\", fullExercise === null || fullExercise === void 0 ? void 0 : (_fullExercise_category = fullExercise.category) === null || _fullExercise_category === void 0 ? void 0 : _fullExercise_category.details);\n                            var updatedExercise = fullExercise ? (0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, fullExercise), {\n                                category: logData.exercise.category\n                            }) : logData.exercise;\n                            return new _exercise_types__WEBPACK_IMPORTED_MODULE_3__.ExerciseLog({\n                                id: logDoc.id,\n                                workoutId: workoutId,\n                                userId: userId,\n                                exercise: updatedExercise || logData.exercise,\n                                logs: logData.log || [],\n                                feedback: logData.feedback || \"\",\n                                note: logData.note || \"\",\n                                recommendedWeight: logData.recommendedWeight || \"calculating...\",\n                                isSplit: logData.isSplit || false,\n                                isBodyWeight: logData.isBodyWeight || false,\n                                logSubmitted: logData.logSubmitted || false,\n                                logIsEditing: logData.logIsEditing || false,\n                                isCompleted: logData.isCompleted || false,\n                                completedAt: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(logData.completedAt),\n                                createdAt: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(logData.createdAt),\n                                updatedAt: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(logData.updatedAt)\n                            });\n                        });\n                        workout.logs = logs;\n                        return [\n                            2,\n                            [\n                                workout,\n                                logs\n                            ]\n                        ];\n                    case 4:\n                        error = _state.sent();\n                        console.error(\"Error fetching saved workout:\", error);\n                        throw error; // Throw the error to see the full stack trace\n                    case 5:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    /**\n * Fetch user challenges by challengeId.\n * @param challengeId The ID of the challenge to fetch associated user challenges for.\n * @returns A promise resolving to an array of user challenges.\n * @throws If the Firestore query fails.\n */ _proto.fetchUserChallengesByChallengeId = function fetchUserChallengesByChallengeId(challengeId) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var userChallengesRef, q, snapshot, userChallenges, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        userChallengesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"user-challenge\");\n                        q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(userChallengesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"challengeId\", \"==\", challengeId));\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            3,\n                            ,\n                            4\n                        ]);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q)\n                        ];\n                    case 2:\n                        snapshot = _state.sent();\n                        // console.log(`Total user challenges fetched: ${snapshot.docs.length}`);\n                        userChallenges = snapshot.docs.map(function(doc) {\n                            var data = doc.data();\n                            // console.log(`Processing user challenge with ID: ${doc.id}`, data);\n                            return (0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                id: doc.id\n                            }, data), {\n                                challenge: data.challenge ? new _workout_types__WEBPACK_IMPORTED_MODULE_6__.Challenge({\n                                    id: data.challenge.id,\n                                    title: data.challenge.title,\n                                    subtitle: data.challenge.subtitle,\n                                    participants: data.challenge.participants || [],\n                                    status: data.challenge.status,\n                                    startDate: data.challenge.startDate ? new Date(data.challenge.startDate) : new Date(),\n                                    endDate: data.challenge.endDate ? new Date(data.challenge.endDate) : new Date(),\n                                    createdAt: data.challenge.createdAt ? new Date(data.challenge.createdAt) : new Date(),\n                                    updatedAt: data.challenge.updatedAt ? new Date(data.challenge.updatedAt) : new Date(),\n                                    introVideos: (data.challenge.introVideos || []).map(function(v) {\n                                        return new _workout_types__WEBPACK_IMPORTED_MODULE_6__.IntroVideo({\n                                            id: v.id,\n                                            userId: v.userId,\n                                            videoUrl: v.videoUrl\n                                        });\n                                    })\n                                }) : undefined,\n                                createdAt: (0,_utils_timestamp__WEBPACK_IMPORTED_MODULE_7__.convertTimestamp)(data.createdAt),\n                                updatedAt: (0,_utils_timestamp__WEBPACK_IMPORTED_MODULE_7__.convertTimestamp)(data.updatedAt)\n                            });\n                        });\n                        // console.log('All user challenges after processing:', JSON.stringify(userChallenges, null, 2));\n                        return [\n                            2,\n                            userChallenges\n                        ];\n                    case 3:\n                        error = _state.sent();\n                        console.error(\"Error fetching user challenges by challengeId:\", error);\n                        throw error;\n                    case 4:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.getCollectionById = function getCollectionById(id) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var docRef, docSnap, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        console.log(\"Fetching collection with id:\", id);\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            3,\n                            ,\n                            4\n                        ]);\n                        docRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"sweatlist-collection\", id);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(docRef)\n                        ];\n                    case 2:\n                        docSnap = _state.sent();\n                        if (docSnap.exists()) {\n                            return [\n                                2,\n                                new _workout_types__WEBPACK_IMPORTED_MODULE_6__.SweatlistCollection((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                    id: docSnap.id\n                                }, docSnap.data()))\n                            ];\n                        } else {\n                            throw new Error(\"Collection not found\");\n                        }\n                        return [\n                            3,\n                            4\n                        ];\n                    case 3:\n                        error = _state.sent();\n                        console.error(\"Error getting collection by ID:\", error);\n                        throw error;\n                    case 4:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.fetchCollections = function fetchCollections(userId) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var collectionsRef, qArray, snapshotArray, collectionsFromArray, qString, snapshotString, collectionsFromString, combined, uniqueCollections, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        if (!userId) {\n                            throw new Error(\"User ID is required\");\n                        }\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            4,\n                            ,\n                            5\n                        ]);\n                        collectionsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"sweatlist-collection\");\n                        // Query for records where ownerId is an array that contains the userId.\n                        qArray = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(collectionsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"ownerId\", \"array-contains\", userId));\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(qArray)\n                        ];\n                    case 2:\n                        snapshotArray = _state.sent();\n                        collectionsFromArray = snapshotArray.docs.map(function(doc) {\n                            var data = (0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                id: doc.id\n                            }, doc.data());\n                            return new _workout_types__WEBPACK_IMPORTED_MODULE_6__.SweatlistCollection(data);\n                        });\n                        console.log(\"The array collections\", collectionsFromArray);\n                        // Query for records where ownerId is a string equal to the userId.\n                        qString = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(collectionsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"ownerId\", \"==\", userId));\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(qString)\n                        ];\n                    case 3:\n                        snapshotString = _state.sent();\n                        collectionsFromString = snapshotString.docs.map(function(doc) {\n                            var data = (0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                id: doc.id\n                            }, doc.data());\n                            return new _workout_types__WEBPACK_IMPORTED_MODULE_6__.SweatlistCollection(data);\n                        });\n                        console.log(\"The string collections\", collectionsFromString);\n                        // Combine both arrays and remove duplicates (if any) based on the collection id.\n                        combined = (0,_swc_helpers_to_consumable_array__WEBPACK_IMPORTED_MODULE_18__._)(collectionsFromArray).concat((0,_swc_helpers_to_consumable_array__WEBPACK_IMPORTED_MODULE_18__._)(collectionsFromString));\n                        uniqueCollections = new Map();\n                        combined.forEach(function(collection) {\n                            uniqueCollections.set(collection.id, collection);\n                        });\n                        return [\n                            2,\n                            Array.from(uniqueCollections.values())\n                        ];\n                    case 4:\n                        error = _state.sent();\n                        console.error(\"Error fetching sweatlists:\", error);\n                        throw error;\n                    case 5:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    /**\n   * Fetch user challenges by userId and filter for active challenges.\n   * @returns A promise resolving to an array of active challenges.\n   * @throws If no user is signed in or if the Firestore query fails.\n   */ _proto.fetchActiveChallenges = function fetchActiveChallenges() {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var currentUser, userChallengesRef, q, snapshot, allChallenges, activeChallenges, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        currentUser = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser;\n                        if (!(currentUser === null || currentUser === void 0 ? void 0 : currentUser.id)) {\n                            throw new Error(\"No user is signed in\");\n                        }\n                        userChallengesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"user-challenge\");\n                        q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(userChallengesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", currentUser.id));\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            3,\n                            ,\n                            4\n                        ]);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q)\n                        ];\n                    case 2:\n                        snapshot = _state.sent();\n                        // console.log(`Total challenges fetched: ${snapshot.docs.length}`);\n                        allChallenges = snapshot.docs.map(function(doc) {\n                            var data = doc.data();\n                            // console.log(`Processing challenge with ID: ${doc.id}`, data);\n                            // Use the Challenge constructor to parse the challenge data\n                            // console.log(\"date before format: \" + convertFirestoreTimestamp(data.challenge.startDate));\n                            var challenge = data.challenge ? new _workout_types__WEBPACK_IMPORTED_MODULE_6__.Challenge({\n                                id: data.challenge.id,\n                                title: data.challenge.title,\n                                subtitle: data.challenge.subtitle,\n                                participants: data.challenge.participants || [],\n                                status: data.challenge.status,\n                                startDate: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(data.challenge.startDate),\n                                endDate: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(data.challenge.endDate),\n                                createdAt: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(data.challenge.createdAt),\n                                updatedAt: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(data.challenge.updatedAt),\n                                introVideos: (data.challenge.introVideos || []).map(function(v) {\n                                    return new _workout_types__WEBPACK_IMPORTED_MODULE_6__.IntroVideo({\n                                        id: v.id,\n                                        userId: v.userId,\n                                        videoUrl: v.videoUrl\n                                    });\n                                })\n                            }) : undefined;\n                            return (0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                id: doc.id\n                            }, data), {\n                                challenge: challenge,\n                                createdAt: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(data.createdAt),\n                                updatedAt: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(data.updatedAt)\n                            });\n                        });\n                        // console.log('All challenges after processing:', JSON.stringify(allChallenges, null, 2));\n                        // Filter for active challenges (endDate > current date)\n                        activeChallenges = allChallenges.filter(function(userChallenge) {\n                            var _userChallenge_challenge;\n                            var endDate = (_userChallenge_challenge = userChallenge.challenge) === null || _userChallenge_challenge === void 0 ? void 0 : _userChallenge_challenge.endDate;\n                            // console.log(\n                            //   `Evaluating challenge ID: ${userChallenge.id}, End Date: ${endDate}, Current Date: ${new Date()}`\n                            // );\n                            return endDate && endDate > new Date();\n                        });\n                        // console.log(`Total active challenges: ${activeChallenges.length}`, activeChallenges);\n                        return [\n                            2,\n                            activeChallenges\n                        ];\n                    case 3:\n                        error = _state.sent();\n                        console.error(\"Error fetching active challenges:\", error);\n                        throw error;\n                    case 4:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    /**\n   * Fetch user challenges by userId.\n   * @returns A promise resolving to an array of challenges.\n   * @throws If no user is signed in or if the Firestore query fails.\n   */ _proto.fetchUserChallenges = function fetchUserChallenges() {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var currentUser, userChallengesRef, q, snapshot, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        currentUser = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser;\n                        if (!(currentUser === null || currentUser === void 0 ? void 0 : currentUser.id)) {\n                            throw new Error(\"No user is signed in\");\n                        }\n                        // Reference to the user-challenge collection\n                        userChallengesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"user-challenge\");\n                        // Query challenges where userId matches the current user's ID\n                        q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(userChallengesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", currentUser.id));\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            3,\n                            ,\n                            4\n                        ]);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q)\n                        ];\n                    case 2:\n                        snapshot = _state.sent();\n                        // Map documents to an array of Challenge objects\n                        return [\n                            2,\n                            snapshot.docs.map(function(doc) {\n                                return new _workout_types__WEBPACK_IMPORTED_MODULE_6__.UserChallenge((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                    id: doc.id\n                                }, doc.data()));\n                            })\n                        ];\n                    case 3:\n                        error = _state.sent();\n                        console.error(\"Error fetching user challenges:\", error);\n                        throw new Error(\"Failed to fetch user challenges\");\n                    case 4:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    //update the workout summary,\n    _proto.updateWorkoutSummary = function updateWorkoutSummary(param) {\n        var userId = param.userId, workoutId = param.workoutId, summary = param.summary;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var summaryRef, summaryData, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        if (!userId) {\n                            throw new Error(\"No user ID provided\");\n                        }\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            3,\n                            ,\n                            4\n                        ]);\n                        // Create a reference to the collection\n                        summaryRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId, \"workoutSummary\", summary.id);\n                        // Convert summary to a plain object for Firestore\n                        summaryData = {\n                            id: summary.id,\n                            workoutId: summary.workoutId,\n                            exercises: summary.exercises,\n                            bodyParts: summary.bodyParts,\n                            secondaryBodyParts: summary.secondaryBodyParts,\n                            workoutTitle: summary.workoutTitle,\n                            caloriesBurned: summary.caloriesBurned,\n                            workoutRating: summary.workoutRating,\n                            exercisesCompleted: summary.exercisesCompleted,\n                            aiInsight: summary.aiInsight,\n                            recommendations: summary.recommendations,\n                            gifURLs: summary.gifURLs,\n                            recommendedWork: summary.recommendedWork,\n                            isCompleted: summary.isCompleted,\n                            createdAt: summary.createdAt,\n                            updatedAt: new Date(),\n                            completedAt: summary.completedAt,\n                            duration: summary.duration\n                        };\n                        // Set data with merge enabled (equivalent to Swift's setData with merge: true)\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(summaryRef, summaryData, {\n                                merge: true\n                            })\n                        ];\n                    case 2:\n                        _state.sent();\n                        console.log(\"Workout summary document updated successfully\");\n                        return [\n                            3,\n                            4\n                        ];\n                    case 3:\n                        error = _state.sent();\n                        console.error(\"Error updating workout summary:\", error);\n                        throw error;\n                    case 4:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.updateWorkoutLogs = function updateWorkoutLogs(param) {\n        var userId = param.userId, workoutId = param.workoutId, logs = param.logs;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var workoutRef, logsRef, batch, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        _state.trys.push([\n                            0,\n                            2,\n                            ,\n                            3\n                        ]);\n                        workoutRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId, \"workoutSessions\", workoutId);\n                        logsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(workoutRef, \"logs\");\n                        batch = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.writeBatch)(_config__WEBPACK_IMPORTED_MODULE_1__.db);\n                        logs.forEach(function(log) {\n                            var logDocRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(logsRef, log.id);\n                            batch.update(logDocRef, (0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, log.toDictionary()));\n                        });\n                        return [\n                            4,\n                            batch.commit()\n                        ];\n                    case 1:\n                        _state.sent();\n                        return [\n                            3,\n                            3\n                        ];\n                    case 2:\n                        error = _state.sent();\n                        console.error(\"Error updating workout logs:\", error);\n                        throw error;\n                    case 3:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    // The cancelWorkout method  it deletes the workout session and summary (if any),\n    // cleans up the local state, and logs the cancellation.\n    _proto.cancelWorkout = function cancelWorkout(workout, workoutSummary) {\n        var _this = this;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var _userService_currentUser, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        if (!((_userService_currentUser = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser) === null || _userService_currentUser === void 0 ? void 0 : _userService_currentUser.id) || !workout) {\n                            throw new Error(\"User not authenticated.\");\n                        }\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            5,\n                            ,\n                            6\n                        ]);\n                        return [\n                            4,\n                            _this.deleteWorkoutSession(workout.id)\n                        ];\n                    case 2:\n                        _state.sent();\n                        if (!workoutSummary) return [\n                            3,\n                            4\n                        ];\n                        return [\n                            4,\n                            _this.deleteWorkoutSummary(workoutSummary.id)\n                        ];\n                    case 3:\n                        _state.sent();\n                        _state.label = 4;\n                    case 4:\n                        _this.cleanUpWorkoutInProgress();\n                        console.log(\"Workout canceled and cleaned up successfully.\");\n                        return [\n                            3,\n                            6\n                        ];\n                    case 5:\n                        error = _state.sent();\n                        console.error(\"Error canceling workout:\", error);\n                        throw error;\n                    case 6:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    // Deletes a workout session document and all its subcollection \"logs\"\n    _proto.deleteWorkoutSession = function deleteWorkoutSession(workoutId) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var _userService_currentUser, userId, workoutRef, logsRef, logsSnapshot, batch, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        if (!((_userService_currentUser = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser) === null || _userService_currentUser === void 0 ? void 0 : _userService_currentUser.id) || !workoutId) {\n                            throw new Error(\"User not authenticated.\");\n                        }\n                        userId = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser.id;\n                        workoutRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId, \"workoutSessions\", workoutId);\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            4,\n                            ,\n                            5\n                        ]);\n                        // Delete all logs in the subcollection\n                        logsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(workoutRef, \"logs\");\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(logsRef)\n                        ];\n                    case 2:\n                        logsSnapshot = _state.sent();\n                        batch = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.writeBatch)(_config__WEBPACK_IMPORTED_MODULE_1__.db);\n                        logsSnapshot.docs.forEach(function(logDoc) {\n                            batch[\"delete\"](logDoc.ref);\n                        });\n                        // Delete the main workout document\n                        batch[\"delete\"](workoutRef);\n                        return [\n                            4,\n                            batch.commit()\n                        ];\n                    case 3:\n                        _state.sent();\n                        console.log(\"Workout session and logs deleted successfully.\");\n                        return [\n                            3,\n                            5\n                        ];\n                    case 4:\n                        error = _state.sent();\n                        console.error(\"Error deleting workout session:\", error);\n                        throw error;\n                    case 5:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    // Deletes the workout summary document.\n    _proto.deleteWorkoutSummary = function deleteWorkoutSummary(workoutSummaryId) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var _userService_currentUser, summaryRef, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        if (!workoutSummaryId || !((_userService_currentUser = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser) === null || _userService_currentUser === void 0 ? void 0 : _userService_currentUser.id)) {\n                            return [\n                                2\n                            ];\n                        }\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            3,\n                            ,\n                            4\n                        ]);\n                        summaryRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser.id, \"workoutSummary\", workoutSummaryId);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.deleteDoc)(summaryRef)\n                        ];\n                    case 2:\n                        _state.sent();\n                        console.log(\"Workout summary deleted successfully.\");\n                        return [\n                            3,\n                            4\n                        ];\n                    case 3:\n                        error = _state.sent();\n                        console.error(\"Error deleting workout summary:\", error);\n                        throw error;\n                    case 4:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    // Clean up local storage and in-memory workout state.\n    _proto.cleanUpWorkoutInProgress = function cleanUpWorkoutInProgress() {\n        _redux_store__WEBPACK_IMPORTED_MODULE_9__.store.dispatch((0,_redux_workoutSlice__WEBPACK_IMPORTED_MODULE_10__.resetWorkoutState)());\n    };\n    /**\n   * Fetch the workout session from Firestore, returning { workout, logs }.\n   * Checks first for a QueuedUp session, then for InProgress.\n   */ _proto.fetchCurrentWorkoutSession = function fetchCurrentWorkoutSession(userId) {\n        var _this = this;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var exerciseSnapshot, videoSnapshot, exerciseVideos, exercisesWithVideos, workoutSessionsRef, q, snap;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        if (!userId) throw new Error(\"No user ID provided\");\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"exercises\"))\n                        ];\n                    case 1:\n                        exerciseSnapshot = _state.sent();\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"exerciseVideos\"))\n                        ];\n                    case 2:\n                        videoSnapshot = _state.sent();\n                        exerciseVideos = videoSnapshot.docs.map(function(doc) {\n                            return new _exercise_types__WEBPACK_IMPORTED_MODULE_3__.ExerciseVideo((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                id: doc.id\n                            }, doc.data()));\n                        });\n                        exercisesWithVideos = exerciseSnapshot.docs.map(function(doc) {\n                            var exercise = new _exercise_types__WEBPACK_IMPORTED_MODULE_3__.Exercise((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                id: doc.id\n                            }, doc.data()));\n                            var matchingVideos = exerciseVideos.filter(function(video) {\n                                return video.exercise.toLowerCase() === exercise.name.toLowerCase();\n                            });\n                            return new _exercise_types__WEBPACK_IMPORTED_MODULE_3__.Exercise((0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, exercise), {\n                                videos: matchingVideos\n                            }));\n                        });\n                        workoutSessionsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId, \"workoutSessions\");\n                        q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(workoutSessionsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", _workout_types__WEBPACK_IMPORTED_MODULE_6__.WorkoutStatus.QueuedUp));\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q)\n                        ];\n                    case 3:\n                        snap = _state.sent();\n                        if (!snap.empty) {\n                            return [\n                                2,\n                                _this.processWorkoutSessionDocument(snap.docs[0], exercisesWithVideos)\n                            ];\n                        }\n                        q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(workoutSessionsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", _workout_types__WEBPACK_IMPORTED_MODULE_6__.WorkoutStatus.InProgress));\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q)\n                        ];\n                    case 4:\n                        snap = _state.sent();\n                        if (!snap.empty) {\n                            return [\n                                2,\n                                _this.processWorkoutSessionDocument(snap.docs[0], exercisesWithVideos)\n                            ];\n                        }\n                        return [\n                            2,\n                            {\n                                workout: null,\n                                logs: null\n                            }\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.fetchAndMapExercisesWithVideos = function fetchAndMapExercisesWithVideos() {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var exerciseSnapshot, exercises, videoSnapshot, exerciseVideos, exercisesWithVideos, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        _state.trys.push([\n                            0,\n                            3,\n                            ,\n                            4\n                        ]);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"exercises\"))\n                        ];\n                    case 1:\n                        exerciseSnapshot = _state.sent();\n                        exercises = exerciseSnapshot.docs.map(function(doc) {\n                            return new _exercise_types__WEBPACK_IMPORTED_MODULE_3__.Exercise((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                id: doc.id\n                            }, doc.data()));\n                        });\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"exerciseVideos\"))\n                        ];\n                    case 2:\n                        videoSnapshot = _state.sent();\n                        exerciseVideos = videoSnapshot.docs.map(function(doc) {\n                            return new _exercise_types__WEBPACK_IMPORTED_MODULE_3__.ExerciseVideo((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                id: doc.id\n                            }, doc.data()));\n                        });\n                        // console.log(`Fetched ${exerciseVideos.length} exercise videos`);\n                        // 3. Map videos to exercises\n                        exercisesWithVideos = exercises.map(function(exercise) {\n                            var matchingVideos = exerciseVideos.filter(function(video) {\n                                return video.exercise.toLowerCase() === exercise.name.toLowerCase();\n                            });\n                            return new _exercise_types__WEBPACK_IMPORTED_MODULE_3__.Exercise((0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, exercise), {\n                                videos: matchingVideos\n                            }));\n                        });\n                        // console.log('Finished mapping exercises with videos');\n                        // console.log(`Total exercises with videos: ${exercisesWithVideos.length}`);\n                        return [\n                            2,\n                            exercisesWithVideos\n                        ];\n                    case 3:\n                        error = _state.sent();\n                        console.error(\"Error fetching and mapping exercises with videos:\", error);\n                        throw error;\n                    case 4:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    /**\n   * Helper to build the Workout object + any logs from the snapshot.\n   */ _proto.fetchAllWorkoutSessions = function fetchAllWorkoutSessions(userId) {\n        var _this = this;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var exerciseSnapshot, exercises, videoSnapshot, exerciseVideos, exercisesWithVideos, workoutSessionsRef, snap, sessions, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        if (!userId) {\n                            throw new Error(\"No user ID provided\");\n                        }\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            6,\n                            ,\n                            7\n                        ]);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"exercises\"))\n                        ];\n                    case 2:\n                        exerciseSnapshot = _state.sent();\n                        exercises = exerciseSnapshot.docs.map(function(doc) {\n                            return new _exercise_types__WEBPACK_IMPORTED_MODULE_3__.Exercise((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                id: doc.id\n                            }, doc.data()));\n                        });\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"exerciseVideos\"))\n                        ];\n                    case 3:\n                        videoSnapshot = _state.sent();\n                        exerciseVideos = videoSnapshot.docs.map(function(doc) {\n                            return new _exercise_types__WEBPACK_IMPORTED_MODULE_3__.ExerciseVideo((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({\n                                id: doc.id\n                            }, doc.data()));\n                        });\n                        exercisesWithVideos = exercises.map(function(exercise) {\n                            var matchingVideos = exerciseVideos.filter(function(video) {\n                                return video.exercise.toLowerCase() === exercise.name.toLowerCase();\n                            });\n                            return new _exercise_types__WEBPACK_IMPORTED_MODULE_3__.Exercise((0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, exercise), {\n                                videos: matchingVideos\n                            }));\n                        });\n                        workoutSessionsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId, \"workoutSessions\");\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(workoutSessionsRef)\n                        ];\n                    case 4:\n                        snap = _state.sent();\n                        if (snap.empty) {\n                            console.log(\"No workout sessions found for user\");\n                            return [\n                                2,\n                                []\n                            ];\n                        }\n                        return [\n                            4,\n                            Promise.all(snap.docs.map(function() {\n                                var _ref = (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function(doc) {\n                                    var sessionData;\n                                    return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                                        switch(_state.label){\n                                            case 0:\n                                                return [\n                                                    4,\n                                                    _this.processWorkoutSessionDocument(doc, exercisesWithVideos)\n                                                ];\n                                            case 1:\n                                                sessionData = _state.sent();\n                                                if (sessionData.logs) {\n                                                    sessionData.logs.sort(function(a, b) {\n                                                        var _a_order;\n                                                        var orderA = (_a_order = a.order) !== null && _a_order !== void 0 ? _a_order : 0;\n                                                        var _b_order;\n                                                        var orderB = (_b_order = b.order) !== null && _b_order !== void 0 ? _b_order : 0;\n                                                        return orderA - orderB;\n                                                    });\n                                                }\n                                                return [\n                                                    2,\n                                                    sessionData\n                                                ];\n                                        }\n                                    });\n                                });\n                                return function(doc) {\n                                    return _ref.apply(this, arguments);\n                                };\n                            }()))\n                        ];\n                    case 5:\n                        sessions = _state.sent();\n                        return [\n                            2,\n                            sessions\n                        ];\n                    case 6:\n                        error = _state.sent();\n                        console.error(\"Error fetching workout sessions:\", error);\n                        throw error;\n                    case 7:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.updateCollection = function updateCollection(collection) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var collRef, newDocRef, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        _state.trys.push([\n                            0,\n                            2,\n                            ,\n                            3\n                        ]);\n                        collRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"sweatlist-collection\");\n                        // If collection.id is empty, generate a new doc ID and assign it.\n                        if (!collection.id || collection.id.trim() === \"\") {\n                            newDocRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(collRef);\n                            collection.id = newDocRef.id;\n                        }\n                        // Ensure the challenge id matches the collection id.\n                        if (collection.challenge) {\n                            collection.challenge.id = collection.id;\n                        }\n                        // Update the updatedAt field.\n                        collection.updatedAt = new Date();\n                        // Save the collection to Firestore.\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(collRef, collection.id), collection.toDictionary())\n                        ];\n                    case 1:\n                        _state.sent();\n                        console.log(\"Collection updated successfully\");\n                        return [\n                            2,\n                            collection\n                        ];\n                    case 2:\n                        error = _state.sent();\n                        console.error(\"Error updating collection document:\", error);\n                        throw new Error(\"Error while updating the collection\");\n                    case 3:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.processWorkoutSessionDocument = function processWorkoutSessionDocument(workoutDoc, exercisesWithVideos) {\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var data, mappedExercises, workout, logsRef, logsSnapshot, logs;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        data = workoutDoc.data();\n                        // Map exercises with their full data and videos\n                        mappedExercises = (data.exercises || []).map(function(exerciseRef) {\n                            var _exerciseRef_exercise_name, _exerciseRef_exercise;\n                            // Find the full exercise with videos\n                            var exerciseNameLower = (_exerciseRef_exercise = exerciseRef.exercise) === null || _exerciseRef_exercise === void 0 ? void 0 : (_exerciseRef_exercise_name = _exerciseRef_exercise.name) === null || _exerciseRef_exercise_name === void 0 ? void 0 : _exerciseRef_exercise_name.toLowerCase().trim();\n                            var fullExercise = exercisesWithVideos.find(function(ex) {\n                                return ex.name.toLowerCase().trim() === exerciseNameLower;\n                            });\n                            // If full exercise found, return it, otherwise use the original\n                            return (0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, exerciseRef), {\n                                exercise: fullExercise || exerciseRef.exercise\n                            });\n                        });\n                        // Create the workout with mapped exercises\n                        workout = new _workout_types__WEBPACK_IMPORTED_MODULE_6__.Workout({\n                            id: workoutDoc.id,\n                            roundWorkoutId: data.roundWorkoutId || \"\",\n                            exercises: mappedExercises,\n                            title: data.title || \"\",\n                            description: data.description || \"\",\n                            duration: data.duration || 0,\n                            useAuthorContent: data.useAuthorContent || false,\n                            isCompleted: data.isCompleted || false,\n                            workoutStatus: data.workoutStatus || _workout_types__WEBPACK_IMPORTED_MODULE_6__.WorkoutStatus.Archived,\n                            author: data.author || \"\",\n                            createdAt: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(data.createdAt),\n                            updatedAt: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(data.updatedAt),\n                            startTime: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(data.startTime),\n                            collectionId: data.collectionId,\n                            challenge: data.challenge,\n                            logs: (data.logs || []).map(function(logData) {\n                                var _logData_exercise_name, _logData_exercise;\n                                // Map logs with full exercises\n                                var exerciseNameLower = (_logData_exercise = logData.exercise) === null || _logData_exercise === void 0 ? void 0 : (_logData_exercise_name = _logData_exercise.name) === null || _logData_exercise_name === void 0 ? void 0 : _logData_exercise_name.toLowerCase().trim();\n                                var fullExercise = exercisesWithVideos.find(function(ex) {\n                                    return ex.name.toLowerCase().trim() === exerciseNameLower;\n                                });\n                                return (0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, logData), {\n                                    exercise: fullExercise || logData.exercise\n                                });\n                            }),\n                            workoutRating: data.workoutRating,\n                            order: data.order,\n                            zone: data.zone || _workout_types__WEBPACK_IMPORTED_MODULE_6__.BodyZone.FullBody\n                        });\n                        // Fetch logs from subcollection\n                        logsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(workoutDoc.ref, \"logs\");\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(logsRef)\n                        ];\n                    case 1:\n                        logsSnapshot = _state.sent();\n                        logs = logsSnapshot.docs.map(function(logDoc) {\n                            var _logData_exercise_name, _logData_exercise;\n                            var logData = logDoc.data();\n                            // Find the full exercise with videos\n                            var exerciseNameLower = (_logData_exercise = logData.exercise) === null || _logData_exercise === void 0 ? void 0 : (_logData_exercise_name = _logData_exercise.name) === null || _logData_exercise_name === void 0 ? void 0 : _logData_exercise_name.toLowerCase().trim();\n                            var fullExercise = exercisesWithVideos.find(function(ex) {\n                                return ex.name.toLowerCase().trim() === exerciseNameLower;\n                            });\n                            var updatedExercise = fullExercise ? (0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, fullExercise), {\n                                category: logData.exercise.category\n                            }) : logData.exercise;\n                            // Prepare log data with full exercise\n                            var preparedLogData = (0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, logData), {\n                                id: logDoc.id,\n                                workoutId: workout.id,\n                                exercise: updatedExercise,\n                                createdAt: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(logData.createdAt),\n                                updatedAt: (0,_utils_formatDate__WEBPACK_IMPORTED_MODULE_8__.convertFirestoreTimestamp)(logData.updatedAt)\n                            });\n                            // Use the ExerciseLog constructor to ensure proper mapping\n                            return new _exercise_types__WEBPACK_IMPORTED_MODULE_3__.ExerciseLog(preparedLogData);\n                        });\n                        return [\n                            2,\n                            {\n                                workout: workout,\n                                logs: logs\n                            }\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.saveWorkoutSession = function saveWorkoutSession(param) {\n        var userId = param.userId, workout = param.workout, logs = param.logs;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var currentDate, cleanWorkout, workoutSessionRef, logsRef, logBatch, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        if (!userId) throw new Error(\"No user ID provided\");\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            4,\n                            ,\n                            5\n                        ]);\n                        currentDate = new Date();\n                        cleanWorkout = new _workout_types__WEBPACK_IMPORTED_MODULE_6__.Workout((0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_14__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_15__._)({}, workout), {\n                            roundWorkoutId: \"\".concat(workout.id, \"-\").concat(currentDate.getTime()),\n                            workoutStatus: _workout_types__WEBPACK_IMPORTED_MODULE_6__.WorkoutStatus.QueuedUp,\n                            createdAt: currentDate,\n                            updatedAt: currentDate,\n                            startTime: currentDate,\n                            logs: []\n                        }));\n                        workoutSessionRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId, \"workoutSessions\"));\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(workoutSessionRef, cleanWorkout.toDictionary())\n                        ];\n                    case 2:\n                        _state.sent();\n                        logsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(workoutSessionRef, \"logs\");\n                        logBatch = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.writeBatch)(_config__WEBPACK_IMPORTED_MODULE_1__.db);\n                        logs.forEach(function(log, index) {\n                            var logDocRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(logsRef, \"\".concat(log.id, \"-\").concat(currentDate.getTime()));\n                            logBatch.set(logDocRef, {\n                                id: logDocRef.id,\n                                workoutId: workoutSessionRef.id,\n                                exercise: log.exercise.toDictionary(),\n                                order: index,\n                                createdAt: currentDate.getTime(),\n                                updatedAt: currentDate.getTime(),\n                                logSubmitted: false,\n                                isCompleted: false\n                            });\n                        });\n                        return [\n                            4,\n                            logBatch.commit()\n                        ];\n                    case 3:\n                        _state.sent();\n                        return [\n                            2,\n                            cleanWorkout\n                        ];\n                    case 4:\n                        error = _state.sent();\n                        console.error(\"Error saving workout session:\", error);\n                        throw error;\n                    case 5:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    /**\n   * Example \"join challenge\" method using the client SDK (no admin privileges).\n   * This creates a doc in `user-challenge` with the userId, challengeId, etc.\n   */ _proto.joinChallenge = function joinChallenge(param) {\n        var username = param.username, challengeId = param.challengeId;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_12__._)(function() {\n            var currentUser, usersRef, userQuery, userSnapshot, userDoc, userData, userId, challengeRef, challengeSnap, challenge, userChallengeId, userChallengeData;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_13__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        // 1) Make sure we have a signed-in user\n                        currentUser = _user__WEBPACK_IMPORTED_MODULE_2__.userService.currentUser;\n                        if (!currentUser) {\n                            throw new Error(\"No user is signed in\");\n                        }\n                        // 2) Find the user doc by username\n                        usersRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"users\");\n                        userQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(usersRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"username\", \"==\", username));\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(userQuery)\n                        ];\n                    case 1:\n                        userSnapshot = _state.sent();\n                        if (userSnapshot.empty) {\n                            throw new Error(\"User not found\");\n                        }\n                        userDoc = userSnapshot.docs[0];\n                        userData = userDoc.data();\n                        userId = userDoc.id;\n                        // 3) Check if the challenge doc exists\n                        challengeRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"sweatlist-collection\", challengeId);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(challengeRef)\n                        ];\n                    case 2:\n                        challengeSnap = _state.sent();\n                        if (!challengeSnap.exists()) {\n                            throw new Error(\"Challenge not found\");\n                        }\n                        challenge = challengeSnap.data();\n                        // 4) Build new user-challenge document\n                        userChallengeId = \"\".concat(challengeId, \"-\").concat(userId, \"-\").concat(Date.now());\n                        userChallengeData = {\n                            id: userChallengeId,\n                            challenge: challenge,\n                            challengeId: challengeId,\n                            userId: userId,\n                            fcmToken: userData.fcmToken || \"\",\n                            profileImage: userData.profileImage || {},\n                            progress: 0,\n                            completedWorkouts: [],\n                            isCompleted: false,\n                            uid: userId,\n                            location: userData.location || null,\n                            city: \"\",\n                            country: \"\",\n                            timezone: \"\",\n                            username: username,\n                            joinDate: new Date(),\n                            createdAt: new Date(),\n                            updatedAt: new Date(),\n                            pulsePoints: {\n                                baseCompletion: 0,\n                                firstCompletion: 0,\n                                streakBonus: 0,\n                                checkInBonus: 0,\n                                effortRating: 0,\n                                chatParticipation: 0,\n                                locationCheckin: 0,\n                                contentEngagement: 0,\n                                encouragementSent: 0,\n                                encouragementReceived: 0\n                            },\n                            currentStreak: 0,\n                            encouragedUsers: [],\n                            encouragedByUsers: [],\n                            checkIns: []\n                        };\n                        // 5) Store user-challenge doc\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_config__WEBPACK_IMPORTED_MODULE_1__.db, \"user-challenge\", userChallengeId), userChallengeData)\n                        ];\n                    case 3:\n                        _state.sent();\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    (0,_swc_helpers_create_class__WEBPACK_IMPORTED_MODULE_19__._)(WorkoutService, [\n        {\n            key: \"currentWorkout\",\n            get: // Replace getters/setters to use Redux\n            function get() {\n                return _redux_store__WEBPACK_IMPORTED_MODULE_9__.store.getState().workout.currentWorkout;\n            },\n            set: function set(workout) {\n                _redux_store__WEBPACK_IMPORTED_MODULE_9__.store.dispatch((0,_redux_workoutSlice__WEBPACK_IMPORTED_MODULE_10__.setCurrentWorkout)(workout));\n            }\n        },\n        {\n            key: \"currentWorkoutLogs\",\n            get: function get() {\n                return _redux_store__WEBPACK_IMPORTED_MODULE_9__.store.getState().workout.currentExerciseLogs;\n            },\n            set: function set(logs) {\n                _redux_store__WEBPACK_IMPORTED_MODULE_9__.store.dispatch((0,_redux_workoutSlice__WEBPACK_IMPORTED_MODULE_10__.setCurrentExerciseLogs)(logs));\n            }\n        },\n        {\n            key: \"currentWorkoutSummary\",\n            get: function get() {\n                return _redux_store__WEBPACK_IMPORTED_MODULE_9__.store.getState().workout.workoutSummary;\n            },\n            set: function set(workoutSummary) {\n                _redux_store__WEBPACK_IMPORTED_MODULE_9__.store.dispatch((0,_redux_workoutSlice__WEBPACK_IMPORTED_MODULE_10__.setWorkoutSummary)(workoutSummary));\n            }\n        }\n    ]);\n    return WorkoutService;\n}();\nvar workoutService = new WorkoutService();\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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c2Uvd29ya291dC9zZXJ2aWNlLnRzP2M1ZTIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2FwaS9maXJlYmFzZS93b3Jrb3V0L3NlcnZpY2UudHNcbmltcG9ydCB7XG4gIGNvbGxlY3Rpb24sXG4gIGRvYyxcbiAgZ2V0RG9jcyxcbiAgZ2V0RG9jLFxuICB1cGRhdGVEb2MsXG4gIHF1ZXJ5LFxuICB3aGVyZSxcbiAgb3JkZXJCeSwgXG4gIERvY3VtZW50RGF0YSxcbiAgUXVlcnlEb2N1bWVudFNuYXBzaG90LFxuICBjb2xsZWN0aW9uIGFzIGZzQ29sbGVjdGlvbixcbiAgc2V0RG9jLFxuICBkZWxldGVEb2MsXG4gIHdyaXRlQmF0Y2hcbn0gZnJvbSAnZmlyZWJhc2UvZmlyZXN0b3JlJztcblxuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi9jb25maWcnO1xuaW1wb3J0IHsgdXNlclNlcnZpY2UgfSBmcm9tICcuLi91c2VyJztcbmltcG9ydCB7IFxuICBFeGVyY2lzZUxvZywgXG4gIEV4ZXJjaXNlQ2F0ZWdvcnksIFxuICBFeGVyY2lzZSwgXG4gIEJvZHlQYXJ0LCBcbiAgRXhlcmNpc2VWaWRlbywgXG4gIEV4ZXJjaXNlQXV0aG9yLCBcbiAgRXhlcmNpc2VWaWRlb1Zpc2liaWxpdHksIFxuICBFeGVyY2lzZURldGFpbCwgXG4gIEV4ZXJjaXNlUmVmZXJlbmNlIH0gZnJvbSAnLi4vZXhlcmNpc2UvdHlwZXMnO1xuaW1wb3J0IHsgZXhlcmNpc2VTZXJ2aWNlIH0gZnJvbSAnLi4vZXhlcmNpc2Uvc2VydmljZSc7XG5pbXBvcnQgeyBQcm9maWxlSW1hZ2UsIFVzZXIgfSBmcm9tICcuLi91c2VyL3R5cGVzJ1xuaW1wb3J0IHsgV29ya291dCwgV29ya291dFN1bW1hcnksIEJvZHlab25lLCBJbnRyb1ZpZGVvLCBSZXBzQW5kV2VpZ2h0TG9nLCBXb3Jrb3V0UmF0aW5nIH0gZnJvbSAnLi4vd29ya291dC90eXBlcyc7XG5pbXBvcnQgeyBXb3Jrb3V0U3RhdHVzLCBTd2VhdGxpc3RDb2xsZWN0aW9uIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBmb3JtYXQgfSBmcm9tICdkYXRlLWZucyc7IFxuaW1wb3J0IHsgY29udmVydFRpbWVzdGFtcCwgc2VydmVyVGltZXN0YW1wIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdGltZXN0YW1wJzsgLy8gQWRqdXN0IHRoZSBpbXBvcnQgcGF0aFxuaW1wb3J0IHsgY29udmVydEZpcmVzdG9yZVRpbWVzdGFtcCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL2Zvcm1hdERhdGUnO1xuaW1wb3J0IHsgQ2hhbGxlbmdlLCBDaGFsbGVuZ2VTdGF0dXMsIFVzZXJDaGFsbGVuZ2UgfSBmcm9tICcuLi8uLi8uLi9hcGkvZmlyZWJhc2Uvd29ya291dC90eXBlcyc7XG5cbmltcG9ydCB7IHN0b3JlIH0gZnJvbSAnLi4vLi4vLi4vcmVkdXgvc3RvcmUnO1xuaW1wb3J0IHsgc2V0Q3VycmVudFdvcmtvdXQsIHNldEN1cnJlbnRFeGVyY2lzZUxvZ3MsIHJlc2V0V29ya291dFN0YXRlLCBzZXRXb3Jrb3V0U3VtbWFyeSB9IGZyb20gJy4uLy4uLy4uL3JlZHV4L3dvcmtvdXRTbGljZSc7XG5cblxuaW50ZXJmYWNlIEZpcmVzdG9yZUVycm9yIHtcbiAgY29kZTogc3RyaW5nO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgc3RhY2s/OiBzdHJpbmc7XG59XG5cbmNsYXNzIFdvcmtvdXRTZXJ2aWNlIHtcblxuLy8gUmVwbGFjZSBnZXR0ZXJzL3NldHRlcnMgdG8gdXNlIFJlZHV4XG4gIGdldCBjdXJyZW50V29ya291dCgpOiBXb3Jrb3V0IHwgbnVsbCB7XG4gICAgcmV0dXJuIHN0b3JlLmdldFN0YXRlKCkud29ya291dC5jdXJyZW50V29ya291dDtcbiAgfVxuXG4gIHNldCBjdXJyZW50V29ya291dCh3b3Jrb3V0OiBXb3Jrb3V0IHwgbnVsbCkge1xuICAgIHN0b3JlLmRpc3BhdGNoKHNldEN1cnJlbnRXb3Jrb3V0KHdvcmtvdXQpKTtcbiAgfVxuXG4gIGdldCBjdXJyZW50V29ya291dExvZ3MoKTogRXhlcmNpc2VMb2dbXSB7XG4gICAgcmV0dXJuIHN0b3JlLmdldFN0YXRlKCkud29ya291dC5jdXJyZW50RXhlcmNpc2VMb2dzO1xuICB9XG5cbiAgc2V0IGN1cnJlbnRXb3Jrb3V0TG9ncyhsb2dzOiBFeGVyY2lzZUxvZ1tdKSB7XG4gICAgc3RvcmUuZGlzcGF0Y2goc2V0Q3VycmVudEV4ZXJjaXNlTG9ncyhsb2dzKSk7XG4gIH1cblxuICBnZXQgY3VycmVudFdvcmtvdXRTdW1tYXJ5KCk6IFdvcmtvdXRTdW1tYXJ5IHwgbnVsbCB7XG4gICAgcmV0dXJuIHN0b3JlLmdldFN0YXRlKCkud29ya291dC53b3Jrb3V0U3VtbWFyeTtcbiAgfVxuXG4gIHNldCBjdXJyZW50V29ya291dFN1bW1hcnkod29ya291dFN1bW1hcnk6IFdvcmtvdXRTdW1tYXJ5KSB7XG4gICAgc3RvcmUuZGlzcGF0Y2goc2V0V29ya291dFN1bW1hcnkod29ya291dFN1bW1hcnkpKTtcbiAgfVxuXG4gICBnZW5lcmF0ZUlkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGRvYyhjb2xsZWN0aW9uKGRiLCAnd29ya291dHMnKSkuaWQ7XG4gIH1cblxuICAgIC8vIFVwZGF0ZSB0aGUgZm9ybWF0V29ya291dEFuZEluaXRpYWxpemVMb2dzIGZ1bmN0aW9uXG4gIGFzeW5jIGZvcm1hdFdvcmtvdXRBbmRJbml0aWFsaXplTG9ncyhcbiAgICAgIGV4ZXJjaXNlRGV0YWlsczogRXhlcmNpc2VEZXRhaWxbXSxcbiAgICAgIHdvcmtvdXRBdXRob3I/OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPHsgd29ya291dDogV29ya291dDsgZXhlcmNpc2VMb2dzOiBFeGVyY2lzZUxvZ1tdIH0+IHtcbiAgICAgIGNvbnN0IHdvcmtJZCA9IHRoaXMuZ2VuZXJhdGVJZCgpOyAvLyBVc2UgdGhpcy5nZW5lcmF0ZUlkKCkgc2luY2UgaXQncyBhIGNsYXNzIG1ldGhvZFxuICAgICAgY29uc3QgZXhlcmNpc2VSZWZlcmVuY2VzOiBFeGVyY2lzZVJlZmVyZW5jZVtdID0gW107XG4gICAgICBjb25zdCBleGVyY2lzZUxvZ3M6IEV4ZXJjaXNlTG9nW10gPSBbXTtcblxuICAvLyBFbnN1cmUgZXhlcmNpc2UgZGV0YWlscyBhcmUgdmFsaWQgYmVmb3JlIHByb2Nlc3NpbmdcbiAgY29uc3QgdmFsaWRFeGVyY2lzZURldGFpbHMgPSBleGVyY2lzZURldGFpbHMuZmlsdGVyKGRldGFpbCA9PiBkZXRhaWw/LmV4ZXJjaXNlICYmIGRldGFpbC5leGVyY2lzZS5pZCk7XG5cbiAgdmFsaWRFeGVyY2lzZURldGFpbHMuZm9yRWFjaCgoZGV0YWlsLCBpbmRleCkgPT4ge1xuICAgIC8vIEVuc3VyZSBleGVyY2lzZSBpbnN0YW5jZSBoYXMgYWxsIHJlcXVpcmVkIGZpZWxkc1xuICAgIGNvbnN0IGV4ZXJjaXNlSW5zdGFuY2UgPSBuZXcgRXhlcmNpc2Uoe1xuICAgICAgLi4uZGV0YWlsLmV4ZXJjaXNlLFxuICAgICAgaWQ6IGRldGFpbC5leGVyY2lzZS5pZCB8fCB3b3Jrb3V0U2VydmljZS5nZW5lcmF0ZUlkKCksXG4gICAgICBuYW1lOiBkZXRhaWwuZXhlcmNpc2UubmFtZSB8fCAnJyxcbiAgICAgIGF1dGhvcjogZGV0YWlsLmV4ZXJjaXNlLmF1dGhvciB8fCB7XG4gICAgICAgIHVzZXJJZDogd29ya291dEF1dGhvciB8fCAnUHVsc2VBSScsXG4gICAgICAgIHVzZXJuYW1lOiB3b3Jrb3V0QXV0aG9yIHx8ICdQdWxzZUFJJ1xuICAgICAgfSxcbiAgICAgIGRlc2NyaXB0aW9uOiBkZXRhaWwuZXhlcmNpc2UuZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICBjYXRlZ29yeTogZGV0YWlsLmV4ZXJjaXNlLmNhdGVnb3J5IHx8IHsgdHlwZTogJ3dlaWdodC10cmFpbmluZycsIGRldGFpbHM6IG51bGwgfSxcbiAgICAgIHByaW1hcnlCb2R5UGFydHM6IGRldGFpbC5leGVyY2lzZS5wcmltYXJ5Qm9keVBhcnRzIHx8IFtdLFxuICAgICAgc2Vjb25kYXJ5Qm9keVBhcnRzOiBkZXRhaWwuZXhlcmNpc2Uuc2Vjb25kYXJ5Qm9keVBhcnRzIHx8IFtdLFxuICAgICAgdGFnczogZGV0YWlsLmV4ZXJjaXNlLnRhZ3MgfHwgW10sXG4gICAgICB2aWRlb3M6IGRldGFpbC5leGVyY2lzZS52aWRlb3MgfHwgW10sXG4gICAgICBjcmVhdGVkQXQ6IGRldGFpbC5leGVyY2lzZS5jcmVhdGVkQXQgfHwgbmV3IERhdGUoKSxcbiAgICAgIHVwZGF0ZWRBdDogZGV0YWlsLmV4ZXJjaXNlLnVwZGF0ZWRBdCB8fCBuZXcgRGF0ZSgpXG4gICAgfSk7XG5cbiAgICAvLyBDcmVhdGUgZXhlcmNpc2UgcmVmZXJlbmNlIHdpdGggcmVxdWlyZWQgZmllbGRzXG4gICAgY29uc3QgZXhlcmNpc2VSZWY6IEV4ZXJjaXNlUmVmZXJlbmNlID0ge1xuICAgICAgZXhlcmNpc2U6IGV4ZXJjaXNlSW5zdGFuY2UsXG4gICAgICBncm91cElkOiBkZXRhaWwuZ3JvdXBJZCB8fCAwXG4gICAgfTtcbiAgICBleGVyY2lzZVJlZmVyZW5jZXMucHVzaChleGVyY2lzZVJlZik7XG5cbiAgICAvLyBTZXQgZGVmYXVsdCB2YWx1ZXMgZm9yIGV4ZXJjaXNlIHBhcmFtZXRlcnNcbiAgICBjb25zdCBjYXRlZ29yeSA9IGRldGFpbC5jYXRlZ29yeT8udHlwZSA9PT0gJ3dlaWdodC10cmFpbmluZycgPyBkZXRhaWwuY2F0ZWdvcnkgOiB7XG4gICAgICB0eXBlOiAnd2VpZ2h0LXRyYWluaW5nJyxcbiAgICAgIGRldGFpbHM6IHsgc2V0czogMywgcmVwczogWycxMiddLCB3ZWlnaHQ6IDAsIHNjcmVlblRpbWU6IDAgfVxuICAgIH07XG5cbiAgICBjb25zdCBzZXRzID0gY2F0ZWdvcnkuZGV0YWlscz8uc2V0cyA/PyAzO1xuICAgIGNvbnN0IHJlcHMgPSBjYXRlZ29yeS5kZXRhaWxzPy5yZXBzID8/IFsnMTInXTtcbiAgICBjb25zdCB3ZWlnaHQgPSBjYXRlZ29yeS5kZXRhaWxzPy53ZWlnaHQgPz8gMDtcblxuICAgIC8vIENyZWF0ZSBsb2dzIGZvciBlYWNoIHNldCB3aXRoIHZhbGlkYXRlZCBkYXRhXG4gICAgY29uc3Qgc2V0c0xvZ3MgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBzZXRzIH0sICgpID0+IFxuICAgICAgbmV3IFJlcHNBbmRXZWlnaHRMb2coe1xuICAgICAgICByZXBzOiBwYXJzZUludChyZXBzWzBdIHx8ICcxMicsIDEwKSxcbiAgICAgICAgd2VpZ2h0OiB3ZWlnaHQgfHwgMFxuICAgICAgfSlcbiAgICApO1xuXG4gICAgLy8gQ3JlYXRlIGV4ZXJjaXNlIGxvZyB3aXRoIHZhbGlkYXRlZCBkYXRhXG4gICAgY29uc3QgZXhlcmNpc2VMb2dJZCA9IGV4ZXJjaXNlU2VydmljZS5nZW5lcmF0ZUV4ZXJjaXNlTG9nSUQoXG4gICAgICB3b3JrSWQsXG4gICAgICB1c2VyU2VydmljZS5jdXJyZW50VXNlcj8uaWQgfHwgJ2Fub255bW91cydcbiAgICApO1xuXG4gICAgY29uc3QgbG9nID0gbmV3IEV4ZXJjaXNlTG9nKHtcbiAgICAgIGlkOiBleGVyY2lzZUxvZ0lkLFxuICAgICAgd29ya291dElkOiB3b3JrSWQsXG4gICAgICB1c2VySWQ6IHVzZXJTZXJ2aWNlLmN1cnJlbnRVc2VyPy5pZCB8fCAnYW5vbnltb3VzJyxcbiAgICAgIGV4ZXJjaXNlOiBleGVyY2lzZUluc3RhbmNlLFxuICAgICAgbG9nczogc2V0c0xvZ3MsXG4gICAgICBmZWVkYmFjazogJycsXG4gICAgICBub3RlOiBkZXRhaWwubm90ZXMgfHwgJycsXG4gICAgICBpc1NwbGl0OiBkZXRhaWwuaXNTcGxpdCB8fCBmYWxzZSxcbiAgICAgIGxvZ1N1Ym1pdHRlZDogZmFsc2UsXG4gICAgICBsb2dJc0VkaXRpbmc6IGZhbHNlLFxuICAgICAgaXNDb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgb3JkZXI6IGluZGV4ICsgMSxcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIGNvbXBsZXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgfSk7XG4gICAgXG4gICAgZXhlcmNpc2VMb2dzLnB1c2gobG9nKTtcbiAgfSk7XG5cbiAgLy8gQ3JlYXRlIHdvcmtvdXQgd2l0aCB2YWxpZGF0ZWQgZGF0YVxuICBjb25zdCBuZXdXb3Jrb3V0ID0gbmV3IFdvcmtvdXQoe1xuICAgIGlkOiB3b3JrSWQsXG4gICAgcm91bmRXb3Jrb3V0SWQ6ICcnLFxuICAgIGV4ZXJjaXNlczogZXhlcmNpc2VSZWZlcmVuY2VzLFxuICAgIGxvZ3M6IGV4ZXJjaXNlTG9ncyxcbiAgICB0aXRsZTogJycsXG4gICAgZGVzY3JpcHRpb246ICcnLFxuICAgIGR1cmF0aW9uOiBXb3Jrb3V0LmVzdGltYXRlZER1cmF0aW9uKGV4ZXJjaXNlUmVmZXJlbmNlcykgfHwgMCxcbiAgICB3b3Jrb3V0UmF0aW5nOiAnbm9uZScgYXMgV29ya291dFJhdGluZyxcbiAgICB1c2VBdXRob3JDb250ZW50OiBmYWxzZSxcbiAgICBpc0NvbXBsZXRlZDogZmFsc2UsXG4gICAgd29ya291dFN0YXR1czogJ2FyY2hpdmVkJyBhcyBXb3Jrb3V0U3RhdHVzLFxuICAgIGF1dGhvcjogdXNlclNlcnZpY2UuY3VycmVudFVzZXI/LmlkIHx8ICdQdWxzZUFJJyxcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIHpvbmU6IFdvcmtvdXQuZGV0ZXJtaW5lV29ya291dFpvbmUoZXhlcmNpc2VSZWZlcmVuY2VzKSB8fCAnZnVsbCcgYXMgQm9keVpvbmVcbiAgfSk7XG5cbiAgcmV0dXJuIHsgd29ya291dDogbmV3V29ya291dCwgZXhlcmNpc2VMb2dzIH07XG5cbn1cblxuICBhc3luYyBnZXRVc2VyQnlJZCh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8VXNlcj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1c2VyRG9jID0gYXdhaXQgZ2V0RG9jKGRvYyhkYiwgJ3VzZXJzJywgdXNlcklkKSk7XG4gICAgICBpZiAoIXVzZXJEb2MuZXhpc3RzKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBmb3VuZCcpO1xuICAgICAgfVxuICBcbiAgICAgIHJldHVybiBuZXcgVXNlcih7XG4gICAgICAgIGlkOiB1c2VyRG9jLmlkLFxuICAgICAgICAuLi51c2VyRG9jLmRhdGEoKSBcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHVzZXIgYnkgSUQ6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLy8gSW4gV29ya291dFNlcnZpY2VcbiAgYXN5bmMgcmV2ZXJ0QXV0aG9yRm9ybWF0KHdvcmtvdXRJZDogc3RyaW5nLCBhdXRob3JJZDogc3RyaW5nKSB7XG4gICAgaWYgKCF1c2VyU2VydmljZS5jdXJyZW50VXNlcj8uaWQpIHRocm93IG5ldyBFcnJvcignTm8gdXNlciBzaWduZWQgaW4nKTtcbiAgICBcbiAgICBjb25zdCB3b3Jrb3V0UmVmID0gZG9jKGRiLCAndXNlcnMnLCB1c2VyU2VydmljZS5jdXJyZW50VXNlci5pZCwgJ015Q3JlYXRlZFdvcmtvdXRzJywgd29ya291dElkKTtcbiAgICBhd2FpdCB1cGRhdGVEb2Mod29ya291dFJlZiwge1xuICAgICAgYXV0aG9yOiBhdXRob3JJZFxuICAgIH0pO1xuICAgfVxuXG5hc3luYyB1cGRhdGVXb3Jrb3V0KHdvcmtvdXQ6IFdvcmtvdXQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKCF1c2VyU2VydmljZS5jdXJyZW50VXNlcj8uaWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHVzZXIgaXMgc2lnbmVkIGluJyk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHdvcmtvdXRSZWYgPSBkb2MoZGIsICd1c2VycycsIHVzZXJTZXJ2aWNlLmN1cnJlbnRVc2VyLmlkLCAnTXlDcmVhdGVkV29ya291dHMnLCB3b3Jrb3V0LmlkKTtcbiAgICBhd2FpdCBzZXREb2Mod29ya291dFJlZiwgd29ya291dC50b0RpY3Rpb25hcnkoKSwgeyBtZXJnZTogdHJ1ZSB9KTtcblxuICAgIC8vIFVwZGF0ZSBsb2dzIGlmIHRoZXkgZXhpc3RcbiAgICBpZiAod29ya291dC5sb2dzICYmIHdvcmtvdXQubG9ncy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBiYXRjaCA9IHdyaXRlQmF0Y2goZGIpO1xuICAgICAgY29uc3QgbG9nc1JlZiA9IGNvbGxlY3Rpb24od29ya291dFJlZiwgJ2xvZ3MnKTtcblxuICAgICAgd29ya291dC5sb2dzLmZvckVhY2gobG9nID0+IHtcbiAgICAgICAgY29uc3QgbG9nUmVmID0gZG9jKGxvZ3NSZWYsIGxvZy5pZCk7XG4gICAgICAgIGJhdGNoLnNldChsb2dSZWYsIGxvZy50b0RpY3Rpb25hcnkoKSwgeyBtZXJnZTogdHJ1ZSB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBiYXRjaC5jb21taXQoKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgd29ya291dDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuICAvKipcbiAgICogRmV0Y2ggdGhlIHVzZXIncyBjdXJyZW50IHdvcmtvdXQgKGVpdGhlciBRdWV1ZWRVcCBvciBJblByb2dyZXNzKS5cbiAgICovXG4gIGFzeW5jIGZldGNoQ3VycmVudFdvcmtvdXQodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFdvcmtvdXQgfCBudWxsPiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IHRoaXMuZmV0Y2hDdXJyZW50V29ya291dFNlc3Npb24odXNlcklkKTtcbiAgICByZXR1cm4gc2Vzc2lvbi53b3Jrb3V0O1xuICB9XG5cbiAgYXN5bmMgZ2V0QWxsU3dlYXRsaXN0cyh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8V29ya291dFtdPiB7XG4gICAgaWYgKCF1c2VySWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVXNlciBJRCBpcyByZXF1aXJlZCcpO1xuICAgIH1cbiAgXG4gICAgLy8gUmVmZXJlbmNlIHRvIHRoZSB1c2VyJ3Mgd29ya291dCBjb2xsZWN0aW9uXG4gICAgY29uc3Qgd29ya291dHNSZWYgPSBjb2xsZWN0aW9uKGRiLCAndXNlcnMnLCB1c2VySWQsICdNeUNyZWF0ZWRXb3Jrb3V0cycpO1xuICBcbiAgICB0cnkge1xuICAgICAgLy8gRmV0Y2ggZXhlcmNpc2VzIHdpdGggdmlkZW9zXG4gICAgICBjb25zdCBleGVyY2lzZXNXaXRoVmlkZW9zID0gYXdhaXQgdGhpcy5mZXRjaEFuZE1hcEV4ZXJjaXNlc1dpdGhWaWRlb3MoKTtcbiAgXG4gICAgICAvLyBRdWVyeSB0byBmZXRjaCBhbGwgd29ya291dHNcbiAgICAgIGNvbnN0IHdvcmtvdXRzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHdvcmtvdXRzUmVmKTtcbiAgICAgIGNvbnN0IHdvcmtvdXRzOiBXb3Jrb3V0W10gPSBbXTtcbiAgXG4gICAgICAvLyBQcm9jZXNzIGVhY2ggd29ya291dCBkb2N1bWVudFxuICAgICAgZm9yIChjb25zdCB3b3Jrb3V0RG9jIG9mIHdvcmtvdXRzU25hcHNob3QuZG9jcykge1xuICAgICAgICBjb25zdCB3b3Jrb3V0RGF0YSA9IHdvcmtvdXREb2MuZGF0YSgpO1xuICAgICAgICBjb25zdCB3b3Jrb3V0SWQgPSB3b3Jrb3V0RG9jLmlkO1xuICBcbiAgICAgICAgLy8gTWFwIHRoZSBleGVyY2lzZXMgaW4gdGhlIHdvcmtvdXQgdG8gdGhlIGZ1bGwgZXhlcmNpc2Ugb2JqZWN0cyB3aXRoIHZpZGVvc1xuICAgICAgICBjb25zdCBtYXBwZWRFeGVyY2lzZXMgPSAod29ya291dERhdGEuZXhlcmNpc2VzIHx8IFtdKS5tYXAoKGV4ZXJjaXNlUmVmOiBhbnkpID0+IHtcbiAgICAgICAgICBjb25zdCBmdWxsRXhlcmNpc2UgPSBleGVyY2lzZXNXaXRoVmlkZW9zLmZpbmQoZXggPT4gZXgubmFtZSA9PT0gZXhlcmNpc2VSZWYuZXhlcmNpc2UubmFtZSk7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJUaGlzIGlzIHRoZSBtYXBwZWQgZXhlcmNpc2U6IFwiICsgZnVsbEV4ZXJjaXNlKTtcblxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5leGVyY2lzZVJlZixcbiAgICAgICAgICAgIGV4ZXJjaXNlOiBmdWxsRXhlcmNpc2UgfHwgZXhlcmNpc2VSZWZcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICBcbiAgICAgICAgLy8gUGFyc2Ugd29ya291dCBkYXRhIGludG8gdGhlIGRlc2lyZWQgc3RydWN0dXJlXG4gICAgICAgIGNvbnN0IHdvcmtvdXQgPSBuZXcgV29ya291dCh7XG4gICAgICAgICAgaWQ6IHdvcmtvdXREYXRhLmlkIHx8ICcnLFxuICAgICAgICAgIHJvdW5kV29ya291dElkOiB3b3Jrb3V0RGF0YS5yb3VuZFdvcmtvdXRJZCB8fCAnJyxcbiAgICAgICAgICBjb2xsZWN0aW9uSWQ6IHdvcmtvdXREYXRhLmNvbGxlY3Rpb25JZCxcbiAgICAgICAgICBleGVyY2lzZXM6IG1hcHBlZEV4ZXJjaXNlcyxcbiAgICAgICAgICBjaGFsbGVuZ2U6IHdvcmtvdXREYXRhLmNoYWxsZW5nZSxcbiAgICAgICAgICBsb2dzOiBbXSxcbiAgICAgICAgICB0aXRsZTogd29ya291dERhdGEudGl0bGUgfHwgJycsXG4gICAgICAgICAgZGVzY3JpcHRpb246IHdvcmtvdXREYXRhLmRlc2NyaXB0aW9uIHx8ICcnLFxuICAgICAgICAgIGR1cmF0aW9uOiB3b3Jrb3V0RGF0YS5kdXJhdGlvbiB8fCAwLFxuICAgICAgICAgIHdvcmtvdXRSYXRpbmc6IHdvcmtvdXREYXRhLndvcmtvdXRSYXRpbmcsXG4gICAgICAgICAgdXNlQXV0aG9yQ29udGVudDogd29ya291dERhdGEudXNlQXV0aG9yQ29udGVudCB8fCBmYWxzZSxcbiAgICAgICAgICBpc0NvbXBsZXRlZDogd29ya291dERhdGEuaXNDb21wbGV0ZWQgfHwgZmFsc2UsXG4gICAgICAgICAgd29ya291dFN0YXR1czogd29ya291dERhdGEud29ya291dFN0YXR1cyB8fCAnbm90U3RhcnRlZCcsXG4gICAgICAgICAgc3RhcnRUaW1lOiB3b3Jrb3V0RGF0YS5zdGFydFRpbWUgPyBuZXcgRGF0ZSh3b3Jrb3V0RGF0YS5zdGFydFRpbWUpIDogdW5kZWZpbmVkLFxuICAgICAgICAgIG9yZGVyOiB3b3Jrb3V0RGF0YS5vcmRlcixcbiAgICAgICAgICBhdXRob3I6IHdvcmtvdXREYXRhLmF1dGhvciB8fCB1c2VySWQsXG4gICAgICAgICAgY3JlYXRlZEF0OiB3b3Jrb3V0RGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZSh3b3Jrb3V0RGF0YS5jcmVhdGVkQXQpIDogbmV3IERhdGUoKSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IHdvcmtvdXREYXRhLnVwZGF0ZWRBdCA/IG5ldyBEYXRlKHdvcmtvdXREYXRhLnVwZGF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHpvbmU6IHdvcmtvdXREYXRhLnpvbmUgfHwgJ0ZVTExfQk9EWScsXG4gICAgICAgIH0pOyAgICAgICAgXG4gIFxuICAgICAgICAvLyBGZXRjaCBhbmQgcHJvY2VzcyBsb2dzXG4gICAgICAgIGNvbnN0IGxvZ3NSZWYgPSBjb2xsZWN0aW9uKGRiLCAndXNlcnMnLCB1c2VySWQsICdNeUNyZWF0ZWRXb3Jrb3V0cycsIHdvcmtvdXRJZCwgJ2xvZ3MnKTtcbiAgICAgICAgY29uc3QgbG9nc1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhsb2dzUmVmKTtcbiAgICAgICAgd29ya291dC5sb2dzID0gbG9nc1NuYXBzaG90LmRvY3MubWFwKChsb2dEb2MpID0+ICh7XG4gICAgICAgICAgLi4ubG9nRG9jLmRhdGEoKSxcbiAgICAgICAgICBpZDogbG9nRG9jLmlkLFxuICAgICAgICB9KSkgYXMgRXhlcmNpc2VMb2dbXTtcbiAgXG4gICAgICAgIHdvcmtvdXRzLnB1c2god29ya291dCk7XG4gICAgICB9XG4gIFxuICAgICAgcmV0dXJuIHdvcmtvdXRzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBmaXJlc3RvcmVFcnJvciA9IGVycm9yIGFzIEZpcmVzdG9yZUVycm9yO1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgc3dlYXRsaXN0czonLCBmaXJlc3RvcmVFcnJvci5tZXNzYWdlKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGZldGNoIHN3ZWF0bGlzdHMnKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRVc2VyQ2hhbGxlbmdlc0J5Q2hhbGxlbmdlSWQoY2hhbGxlbmdlSWQ6IHN0cmluZyk6IFByb21pc2U8eyB1c2VyQ2hhbGxlbmdlczogVXNlckNoYWxsZW5nZVtdOyBlcnJvcj86IHN0cmluZyB9PiB7XG4gICAgY29uc3QgdXNlckNoYWxsZW5nZXNSZWYgPSBjb2xsZWN0aW9uKGRiLCAndXNlci1jaGFsbGVuZ2UnKTtcbiAgICBjb25zdCBxID0gcXVlcnkodXNlckNoYWxsZW5nZXNSZWYsIHdoZXJlKCdjaGFsbGVuZ2VJZCcsICc9PScsIGNoYWxsZW5nZUlkKSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcbiAgICAgIGNvbnN0IHVzZXJDaGFsbGVuZ2VzOiBVc2VyQ2hhbGxlbmdlW10gPSBzbmFwc2hvdC5kb2NzLm1hcCgoZG9jOiBEb2N1bWVudERhdGEpID0+IHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGRvYy5kYXRhKCk7XG4gICAgICAgIHJldHVybiBuZXcgVXNlckNoYWxsZW5nZShkYXRhKTtcbiAgICAgIH0pO1xuICAgICAgaWYgKHVzZXJDaGFsbGVuZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIHsgdXNlckNoYWxsZW5nZXMgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7IHVzZXJDaGFsbGVuZ2VzOiBbXSwgZXJyb3I6ICdObyB1c2VyIGNoYWxsZW5nZXMgZm91bmQgZm9yIHRoaXMgY2hhbGxlbmdlLicgfTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgdXNlciBjaGFsbGVuZ2VzIGJ5IGNoYWxsZW5nZUlkOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7IHVzZXJDaGFsbGVuZ2VzOiBbXSwgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InIH07XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogRmV0Y2hlcyB3b3Jrb3V0IHN1bW1hcmllcyBmb3IgYSBzcGVjaWZpYyBkYXRlLlxuICAgKiBAcGFyYW0gZGF0ZSAtIFRoZSBkYXRlIGZvciB3aGljaCB3b3Jrb3V0IHN1bW1hcmllcyBhcmUgYmVpbmcgZmV0Y2hlZC5cbiAgICogQHJldHVybnMgQSBwcm9taXNlIHJlc29sdmluZyB0byBhbiBhcnJheSBvZiB3b3Jrb3V0IHN1bW1hcmllcy5cbiAgICogQHRocm93cyBJZiBubyB1c2VyIGlzIHNpZ25lZCBpbiBvciBpZiB0aGUgRmlyZXN0b3JlIHF1ZXJ5IGZhaWxzLlxuICAgKi9cbiAgYXN5bmMgZmV0Y2hXb3Jrb3V0U3VtbWFyaWVzKGRhdGU6IERhdGUpOiBQcm9taXNlPFdvcmtvdXRTdW1tYXJ5W10+IHtcbiAgICBjb25zdCBjdXJyZW50VXNlciA9IHVzZXJTZXJ2aWNlLmN1cnJlbnRVc2VyO1xuICAgIGlmICghY3VycmVudFVzZXI/LmlkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHVzZXIgaXMgc2lnbmVkIGluJyk7XG4gICAgfVxuXG4gICAgLy8gRm9ybWF0IHRoZSBkYXRlIHRvIG1hdGNoIHRoZSBmb3JtYXQgaW4gRmlyZXN0b3JlICgnTU0tZGQteXl5eScpXG4gICAgY29uc3QgZm9ybWF0dGVkRGF0ZSA9IGZvcm1hdChkYXRlLCAnTU0tZGQteXl5eScpO1xuXG4gICAgLy8gUmVmZXJlbmNlIHRvIHRoZSB1c2VyJ3Mgd29ya291dFN1bW1hcmllcyBzdWJjb2xsZWN0aW9uXG4gICAgY29uc3Qgc3VtbWFyaWVzUmVmID0gY29sbGVjdGlvbihkYiwgJ3VzZXJzJywgY3VycmVudFVzZXIuaWQsICd3b3Jrb3V0U3VtbWFyaWVzJyk7XG5cbiAgICAvLyBDcmVhdGUgYSBxdWVyeSB0byBmaWx0ZXIgZG9jdW1lbnRzIGJ5IHRoZSBzcGVjaWZpZWQgZGF0ZVxuICAgIGNvbnN0IHEgPSBxdWVyeShzdW1tYXJpZXNSZWYsIHdoZXJlKCdkYXRlJywgJz09JywgZm9ybWF0dGVkRGF0ZSkpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcblxuICAgICAgLy8gTWFwIHRoZSBkb2N1bWVudHMgdG8gYW4gYXJyYXkgb2YgV29ya291dFN1bW1hcnkgb2JqZWN0c1xuICAgICAgcmV0dXJuIHNuYXBzaG90LmRvY3MubWFwKChkb2M6IERvY3VtZW50RGF0YSk6IFdvcmtvdXRTdW1tYXJ5ID0+ICh7XG4gICAgICAgIGlkOiBkb2MuaWQsXG4gICAgICAgIC4uLmRvYy5kYXRhKCksXG4gICAgICB9KSk7XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZmlyZXN0b3JlRXJyb3IgPSBlcnJvciBhcyBGaXJlc3RvcmVFcnJvcjtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHdvcmtvdXQgc3VtbWFyaWVzOicsIGZpcmVzdG9yZUVycm9yLm1lc3NhZ2UpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGZpcmVzdG9yZUVycm9yLm1lc3NhZ2UpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZldGNoQWxsV29ya291dFN1bW1hcmllcygpOiBQcm9taXNlPFdvcmtvdXRTdW1tYXJ5W10+IHtcbiAgICBjb25zdCBjdXJyZW50VXNlciA9IHVzZXJTZXJ2aWNlLmN1cnJlbnRVc2VyO1xuICAgIGlmICghY3VycmVudFVzZXI/LmlkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHVzZXIgaXMgc2lnbmVkIGluJyk7XG4gICAgfVxuICBcbiAgICAvLyBSZWZlcmVuY2UgdG8gdGhlIHVzZXIncyB3b3Jrb3V0U3VtbWFyaWVzIHN1YmNvbGxlY3Rpb25cbiAgICBjb25zdCBzdW1tYXJpZXNSZWYgPSBjb2xsZWN0aW9uKGRiLCAndXNlcnMnLCBjdXJyZW50VXNlci5pZCwgJ3dvcmtvdXRTdW1tYXJ5Jyk7XG4gIFxuICAgIC8vIFF1ZXJ5IHRvIHJldHJpZXZlIGFsbCB3b3Jrb3V0IHN1bW1hcmllcywgc29ydGVkIGJ5IGBjcmVhdGVkQXRgIGluIGFzY2VuZGluZyBvcmRlclxuICAgIGNvbnN0IHEgPSBxdWVyeShzdW1tYXJpZXNSZWYsIG9yZGVyQnkoJ2NyZWF0ZWRBdCcsICdhc2MnKSk7IC8vIEFkanVzdCBmaWVsZCBuYW1lIGJhc2VkIG9uIHlvdXIgc2NoZW1hXG4gIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XG4gIFxuICAgICAgLy8gTWFwIHRoZSBkb2N1bWVudHMgdG8gYW4gYXJyYXkgb2YgV29ya291dFN1bW1hcnkgb2JqZWN0c1xuICAgICAgcmV0dXJuIHNuYXBzaG90LmRvY3MubWFwKChkb2M6IERvY3VtZW50RGF0YSk6IFdvcmtvdXRTdW1tYXJ5ID0+ICh7XG4gICAgICAgIGlkOiBkb2MuaWQsXG4gICAgICAgIC4uLmRvYy5kYXRhKCksXG4gICAgICB9KSk7XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZmlyZXN0b3JlRXJyb3IgPSBlcnJvciBhcyBGaXJlc3RvcmVFcnJvcjtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGFsbCB3b3Jrb3V0IHN1bW1hcmllczonLCBmaXJlc3RvcmVFcnJvci5tZXNzYWdlKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihmaXJlc3RvcmVFcnJvci5tZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuXG4gIC8qKlxuICogRmV0Y2ggdXNlciBjaGFsbGVuZ2VzIGJ5IHVzZXJJZC5cbiAqIEBwYXJhbSB1c2VySWQgVGhlIElEIG9mIHRoZSB1c2VyIHRvIGZldGNoIGNoYWxsZW5nZXMgZm9yLlxuICogQHJldHVybnMgQSBwcm9taXNlIHJlc29sdmluZyB0byBhbiBhcnJheSBvZiB1c2VyIGNoYWxsZW5nZXMuXG4gKiBAdGhyb3dzIElmIHRoZSBGaXJlc3RvcmUgcXVlcnkgZmFpbHMuXG4gKi9cbmFzeW5jIGZldGNoVXNlckNoYWxsZW5nZXNCeVVzZXJJZCh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8VXNlckNoYWxsZW5nZVtdPiB7XG4gIGNvbnN0IHVzZXJDaGFsbGVuZ2VzUmVmID0gY29sbGVjdGlvbihkYiwgJ3VzZXItY2hhbGxlbmdlJyk7XG4gIGNvbnN0IHEgPSBxdWVyeSh1c2VyQ2hhbGxlbmdlc1JlZiwgd2hlcmUoJ3VzZXJJZCcsICc9PScsIHVzZXJJZCkpO1xuXG4gIHRyeSB7XG4gICAgLy8gY29uc29sZS5sb2coYEZldGNoaW5nIGNoYWxsZW5nZXMgZm9yIHVzZXIgSUQ6ICR7dXNlcklkfWApO1xuXG4gICAgY29uc3Qgc25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHEpO1xuXG4gICAgLy8gY29uc29sZS5sb2coYFRvdGFsIGNoYWxsZW5nZXMgZmV0Y2hlZDogJHtzbmFwc2hvdC5kb2NzLmxlbmd0aH1gKTtcblxuICAgIGNvbnN0IHVzZXJDaGFsbGVuZ2VzID0gc25hcHNob3QuZG9jcy5tYXAoKGRvYzogRG9jdW1lbnREYXRhKSA9PiB7XG4gICAgICBjb25zdCBkYXRhID0gZG9jLmRhdGEoKTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKGBQcm9jZXNzaW5nIGNoYWxsZW5nZSB3aXRoIElEOiAke2RvYy5pZH1gLCBkYXRhKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IGRvYy5pZCxcbiAgICAgICAgLi4uZGF0YSxcbiAgICAgICAgY2hhbGxlbmdlOiBkYXRhLmNoYWxsZW5nZVxuICAgICAgICAgID8gbmV3IENoYWxsZW5nZSh7XG4gICAgICAgICAgICAgIGlkOiBkYXRhLmNoYWxsZW5nZS5pZCxcbiAgICAgICAgICAgICAgdGl0bGU6IGRhdGEuY2hhbGxlbmdlLnRpdGxlLFxuICAgICAgICAgICAgICBzdWJ0aXRsZTogZGF0YS5jaGFsbGVuZ2Uuc3VidGl0bGUsXG4gICAgICAgICAgICAgIHBhcnRpY2lwYW50czogZGF0YS5jaGFsbGVuZ2UucGFydGljaXBhbnRzIHx8IFtdLFxuICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuY2hhbGxlbmdlLnN0YXR1cyBhcyBDaGFsbGVuZ2VTdGF0dXMsXG4gICAgICAgICAgICAgIHN0YXJ0RGF0ZTogZGF0YS5jaGFsbGVuZ2Uuc3RhcnREYXRlID8gbmV3IERhdGUoZGF0YS5jaGFsbGVuZ2Uuc3RhcnREYXRlKSA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgIGVuZERhdGU6IGRhdGEuY2hhbGxlbmdlLmVuZERhdGUgPyBuZXcgRGF0ZShkYXRhLmNoYWxsZW5nZS5lbmREYXRlKSA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jaGFsbGVuZ2UuY3JlYXRlZEF0ID8gbmV3IERhdGUoZGF0YS5jaGFsbGVuZ2UuY3JlYXRlZEF0KSA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgIHVwZGF0ZWRBdDogZGF0YS5jaGFsbGVuZ2UudXBkYXRlZEF0ID8gbmV3IERhdGUoZGF0YS5jaGFsbGVuZ2UudXBkYXRlZEF0KSA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgIGludHJvVmlkZW9zOiAoZGF0YS5jaGFsbGVuZ2UuaW50cm9WaWRlb3MgfHwgW10pLm1hcCgodjogYW55KSA9PiBcbiAgICAgICAgICAgICAgICBuZXcgSW50cm9WaWRlbyh7XG4gICAgICAgICAgICAgICAgICBpZDogdi5pZCxcbiAgICAgICAgICAgICAgICAgIHVzZXJJZDogdi51c2VySWQsXG4gICAgICAgICAgICAgICAgICB2aWRlb1VybDogdi52aWRlb1VybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgIGNyZWF0ZWRBdDogY29udmVydFRpbWVzdGFtcChkYXRhLmNyZWF0ZWRBdCksXG4gICAgICAgIHVwZGF0ZWRBdDogY29udmVydFRpbWVzdGFtcChkYXRhLnVwZGF0ZWRBdCksXG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgLy8gY29uc29sZS5sb2coJ0FsbCBjaGFsbGVuZ2VzIGFmdGVyIHByb2Nlc3Npbmc6JywgSlNPTi5zdHJpbmdpZnkodXNlckNoYWxsZW5nZXMsIG51bGwsIDIpKTtcblxuICAgIHJldHVybiB1c2VyQ2hhbGxlbmdlcztcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyB1c2VyIGNoYWxsZW5nZXMgYnkgdXNlcklkOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG5hc3luYyBmZXRjaENvbGxlY3Rpb25XaXRoU3dlYXRMaXN0cyhjb2xsZWN0aW9uSWQ6IHN0cmluZyk6IFByb21pc2U8eyBjb2xsZWN0aW9uOiBhbnksIHN3ZWF0TGlzdHM6IFdvcmtvdXRbXSB9PiB7XG4gIHRyeSB7XG4gICAgLy8gRmV0Y2ggdGhlIGNvbGxlY3Rpb25cbiAgICBjb25zdCBjb2xsZWN0aW9uID0gYXdhaXQgdGhpcy5nZXRDb2xsZWN0aW9uQnlJZChjb2xsZWN0aW9uSWQpO1xuXG4gICAgLy8gRmV0Y2ggc3dlYXQgbGlzdHMgKHdvcmtvdXRzKVxuICAgIGNvbnN0IHN3ZWF0TGlzdHM6IFdvcmtvdXRbXSA9IFtdO1xuICAgIFxuICAgIC8vIEFzc3VtaW5nIGNvbGxlY3Rpb24gaGFzIHN3ZWF0bGlzdElkcyB3aXRoIGF1dGhvciBhbmQgd29ya291dCBJRHNcbiAgICBmb3IgKGNvbnN0IHN3ZWF0bGlzdElkZW50aWZpZXIgb2YgY29sbGVjdGlvbi5zd2VhdGxpc3RJZHMgfHwgW10pIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IFt3b3Jrb3V0XSA9IGF3YWl0IHRoaXMuZmV0Y2hTYXZlZFdvcmtvdXQoXG4gICAgICAgICAgc3dlYXRsaXN0SWRlbnRpZmllci5zd2VhdGxpc3RBdXRob3JJZCwgXG4gICAgICAgICAgc3dlYXRsaXN0SWRlbnRpZmllci5pZFxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgaWYgKHdvcmtvdXQpIHtcbiAgICAgICAgICBzd2VhdExpc3RzLnB1c2god29ya291dCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGZldGNoaW5nIHdvcmtvdXQgJHtzd2VhdGxpc3RJZGVudGlmaWVyLmlkfTpgLCBlcnJvcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgY29sbGVjdGlvbiwgc3dlYXRMaXN0cyB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNvbGxlY3Rpb24gd2l0aCBzd2VhdCBsaXN0czonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuXG5cbmFzeW5jIGZldGNoU2F2ZWRXb3Jrb3V0KHVzZXJJZDogc3RyaW5nLCB3b3Jrb3V0SWQ6IHN0cmluZyk6IFByb21pc2U8W1dvcmtvdXQgfCBudWxsLCBFeGVyY2lzZUxvZ1tdIHwgbnVsbF0+IHtcbiAgdHJ5IHtcbiAgICAvLyBGZXRjaCB3b3Jrb3V0IGRvY3VtZW50XG4gICAgY29uc3Qgd29ya291dFJlZiA9IGRvYyhkYiwgJ3VzZXJzJywgdXNlcklkLCAnTXlDcmVhdGVkV29ya291dHMnLCB3b3Jrb3V0SWQpO1xuICAgIGNvbnN0IHdvcmtvdXRTbmFwID0gYXdhaXQgZ2V0RG9jKHdvcmtvdXRSZWYpO1xuICAgIFxuICAgIGlmICghd29ya291dFNuYXAuZXhpc3RzKCkpIHtcbiAgICAgIHJldHVybiBbbnVsbCwgbnVsbF07XG4gICAgfVxuXG4gICAgY29uc3Qgd29ya291dERhdGEgPSB3b3Jrb3V0U25hcC5kYXRhKCk7XG4gICAgY29uc3QgZXhlcmNpc2VzV2l0aFZpZGVvcyA9IGF3YWl0IHRoaXMuZmV0Y2hBbmRNYXBFeGVyY2lzZXNXaXRoVmlkZW9zKCk7XG5cbiAgICAvLyBNYXAgdGhlIGV4ZXJjaXNlc1xuICAgIGNvbnN0IG1hcHBlZEV4ZXJjaXNlcyA9ICh3b3Jrb3V0RGF0YS5leGVyY2lzZXMgfHwgW10pLm1hcCgoZXhlcmNpc2VSZWY6IGFueSkgPT4ge1xuICAgICAgY29uc3QgZnVsbEV4ZXJjaXNlID0gZXhlcmNpc2VzV2l0aFZpZGVvcy5maW5kKGV4ID0+IGV4Lm5hbWUgPT09IGV4ZXJjaXNlUmVmLmV4ZXJjaXNlLm5hbWUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uZXhlcmNpc2VSZWYsXG4gICAgICAgIGV4ZXJjaXNlOiBmdWxsRXhlcmNpc2UgfHwgZXhlcmNpc2VSZWYuZXhlcmNpc2VcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICB3b3Jrb3V0RGF0YS5leGVyY2lzZXMgPSBtYXBwZWRFeGVyY2lzZXM7XG4gICAgY29uc3Qgd29ya291dCA9IG5ldyBXb3Jrb3V0KHtcbiAgICAgIGlkOiB3b3Jrb3V0SWQsXG4gICAgICAuLi53b3Jrb3V0RGF0YVxuICAgIH0pO1xuXG4gICAgLy8gRmV0Y2ggYW5kIG1hcCBsb2dzXG4gICAgY29uc3QgbG9nc1JlZiA9IGNvbGxlY3Rpb24od29ya291dFJlZiwgJ2xvZ3MnKTtcbiAgICBjb25zdCBsb2dzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGxvZ3NSZWYpO1xuICAgIGNvbnNvbGUubG9nKCdGb3VuZCBsb2dzIGNvdW50OicsIGxvZ3NTbmFwc2hvdC5zaXplKTtcblxuICAgIGNvbnN0IGxvZ3M6IEV4ZXJjaXNlTG9nW10gPSBsb2dzU25hcHNob3QuZG9jcy5tYXAobG9nRG9jID0+IHtcbiAgICAgIGNvbnN0IGxvZ0RhdGEgPSBsb2dEb2MuZGF0YSgpO1xuICAgICAgY29uc29sZS5sb2coJ1JhdyBsb2cgZGF0YSBmcm9tIEZpcmViYXNlOicsIHtcbiAgICAgICAgZXhlcmNpc2VOYW1lOiBsb2dEYXRhLmV4ZXJjaXNlLm5hbWUsXG4gICAgICAgIGV4ZXJjaXNlQ2F0ZWdvcnk6IGxvZ0RhdGEuZXhlcmNpc2UuY2F0ZWdvcnlcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCBmdWxsRXhlcmNpc2UgPSBleGVyY2lzZXNXaXRoVmlkZW9zLmZpbmQoZXggPT4gZXgubmFtZSA9PT0gbG9nRGF0YS5leGVyY2lzZS5uYW1lKTtcbiAgICAgIGNvbnNvbGUubG9nKCdFeGVyY2lzZSBDYXRlZ29yeSBEZXRhaWxzOicsIGZ1bGxFeGVyY2lzZT8uY2F0ZWdvcnk/LmRldGFpbHMpO1xuXG4gICAgICBjb25zdCB1cGRhdGVkRXhlcmNpc2UgPSBmdWxsRXhlcmNpc2VcbiAgICA/IHtcbiAgICAgICAgLi4uZnVsbEV4ZXJjaXNlLFxuICAgICAgICBjYXRlZ29yeTogbG9nRGF0YS5leGVyY2lzZS5jYXRlZ29yeSxcbiAgICAgIH1cbiAgICA6IGxvZ0RhdGEuZXhlcmNpc2U7XG4gICAgICBcbiAgICAgIHJldHVybiBuZXcgRXhlcmNpc2VMb2coe1xuICAgICAgICBpZDogbG9nRG9jLmlkLFxuICAgICAgICB3b3Jrb3V0SWQ6IHdvcmtvdXRJZCxcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXG4gICAgICAgIGV4ZXJjaXNlOiB1cGRhdGVkRXhlcmNpc2UgfHwgbG9nRGF0YS5leGVyY2lzZSxcbiAgICAgICAgbG9nczogbG9nRGF0YS5sb2cgfHwgW10sXG4gICAgICAgIGZlZWRiYWNrOiBsb2dEYXRhLmZlZWRiYWNrIHx8ICcnLFxuICAgICAgICBub3RlOiBsb2dEYXRhLm5vdGUgfHwgJycsXG4gICAgICAgIHJlY29tbWVuZGVkV2VpZ2h0OiBsb2dEYXRhLnJlY29tbWVuZGVkV2VpZ2h0IHx8ICdjYWxjdWxhdGluZy4uLicsXG4gICAgICAgIGlzU3BsaXQ6IGxvZ0RhdGEuaXNTcGxpdCB8fCBmYWxzZSxcbiAgICAgICAgaXNCb2R5V2VpZ2h0OiBsb2dEYXRhLmlzQm9keVdlaWdodCB8fCBmYWxzZSxcbiAgICAgICAgbG9nU3VibWl0dGVkOiBsb2dEYXRhLmxvZ1N1Ym1pdHRlZCB8fCBmYWxzZSxcbiAgICAgICAgbG9nSXNFZGl0aW5nOiBsb2dEYXRhLmxvZ0lzRWRpdGluZyB8fCBmYWxzZSxcbiAgICAgICAgaXNDb21wbGV0ZWQ6IGxvZ0RhdGEuaXNDb21wbGV0ZWQgfHwgZmFsc2UsXG4gICAgICAgIGNvbXBsZXRlZEF0OiBjb252ZXJ0RmlyZXN0b3JlVGltZXN0YW1wKGxvZ0RhdGEuY29tcGxldGVkQXQpLFxuICAgICAgICBjcmVhdGVkQXQ6IGNvbnZlcnRGaXJlc3RvcmVUaW1lc3RhbXAobG9nRGF0YS5jcmVhdGVkQXQpLFxuICAgICAgICB1cGRhdGVkQXQ6IGNvbnZlcnRGaXJlc3RvcmVUaW1lc3RhbXAobG9nRGF0YS51cGRhdGVkQXQpXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHdvcmtvdXQubG9ncyA9IGxvZ3M7XG4gICAgcmV0dXJuIFt3b3Jrb3V0LCBsb2dzXTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzYXZlZCB3b3Jrb3V0OicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjsgLy8gVGhyb3cgdGhlIGVycm9yIHRvIHNlZSB0aGUgZnVsbCBzdGFjayB0cmFjZVxuICB9XG59XG5cbi8qKlxuICogRmV0Y2ggdXNlciBjaGFsbGVuZ2VzIGJ5IGNoYWxsZW5nZUlkLlxuICogQHBhcmFtIGNoYWxsZW5nZUlkIFRoZSBJRCBvZiB0aGUgY2hhbGxlbmdlIHRvIGZldGNoIGFzc29jaWF0ZWQgdXNlciBjaGFsbGVuZ2VzIGZvci5cbiAqIEByZXR1cm5zIEEgcHJvbWlzZSByZXNvbHZpbmcgdG8gYW4gYXJyYXkgb2YgdXNlciBjaGFsbGVuZ2VzLlxuICogQHRocm93cyBJZiB0aGUgRmlyZXN0b3JlIHF1ZXJ5IGZhaWxzLlxuICovXG5hc3luYyBmZXRjaFVzZXJDaGFsbGVuZ2VzQnlDaGFsbGVuZ2VJZChjaGFsbGVuZ2VJZDogc3RyaW5nKTogUHJvbWlzZTxVc2VyQ2hhbGxlbmdlW10+IHtcbiAgY29uc3QgdXNlckNoYWxsZW5nZXNSZWYgPSBjb2xsZWN0aW9uKGRiLCAndXNlci1jaGFsbGVuZ2UnKTtcbiAgY29uc3QgcSA9IHF1ZXJ5KHVzZXJDaGFsbGVuZ2VzUmVmLCB3aGVyZSgnY2hhbGxlbmdlSWQnLCAnPT0nLCBjaGFsbGVuZ2VJZCkpO1xuXG4gIHRyeSB7XG4gICAgLy8gY29uc29sZS5sb2coYEZldGNoaW5nIHVzZXIgY2hhbGxlbmdlcyBmb3IgY2hhbGxlbmdlIElEOiAke2NoYWxsZW5nZUlkfWApO1xuXG4gICAgY29uc3Qgc25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHEpO1xuXG4gICAgLy8gY29uc29sZS5sb2coYFRvdGFsIHVzZXIgY2hhbGxlbmdlcyBmZXRjaGVkOiAke3NuYXBzaG90LmRvY3MubGVuZ3RofWApO1xuXG4gICAgY29uc3QgdXNlckNoYWxsZW5nZXMgPSBzbmFwc2hvdC5kb2NzLm1hcCgoZG9jOiBEb2N1bWVudERhdGEpID0+IHtcbiAgICAgIGNvbnN0IGRhdGEgPSBkb2MuZGF0YSgpO1xuICAgICAgLy8gY29uc29sZS5sb2coYFByb2Nlc3NpbmcgdXNlciBjaGFsbGVuZ2Ugd2l0aCBJRDogJHtkb2MuaWR9YCwgZGF0YSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBkb2MuaWQsXG4gICAgICAgIC4uLmRhdGEsXG4gICAgICAgIGNoYWxsZW5nZTogZGF0YS5jaGFsbGVuZ2VcbiAgICAgICAgICA/IG5ldyBDaGFsbGVuZ2Uoe1xuICAgICAgICAgICAgICBpZDogZGF0YS5jaGFsbGVuZ2UuaWQsXG4gICAgICAgICAgICAgIHRpdGxlOiBkYXRhLmNoYWxsZW5nZS50aXRsZSxcbiAgICAgICAgICAgICAgc3VidGl0bGU6IGRhdGEuY2hhbGxlbmdlLnN1YnRpdGxlLFxuICAgICAgICAgICAgICBwYXJ0aWNpcGFudHM6IGRhdGEuY2hhbGxlbmdlLnBhcnRpY2lwYW50cyB8fCBbXSxcbiAgICAgICAgICAgICAgc3RhdHVzOiBkYXRhLmNoYWxsZW5nZS5zdGF0dXMgYXMgQ2hhbGxlbmdlU3RhdHVzLFxuICAgICAgICAgICAgICBzdGFydERhdGU6IGRhdGEuY2hhbGxlbmdlLnN0YXJ0RGF0ZSA/IG5ldyBEYXRlKGRhdGEuY2hhbGxlbmdlLnN0YXJ0RGF0ZSkgOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICBlbmREYXRlOiBkYXRhLmNoYWxsZW5nZS5lbmREYXRlID8gbmV3IERhdGUoZGF0YS5jaGFsbGVuZ2UuZW5kRGF0ZSkgOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGRhdGEuY2hhbGxlbmdlLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY2hhbGxlbmdlLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGRhdGEuY2hhbGxlbmdlLnVwZGF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY2hhbGxlbmdlLnVwZGF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICBpbnRyb1ZpZGVvczogKGRhdGEuY2hhbGxlbmdlLmludHJvVmlkZW9zIHx8IFtdKS5tYXAoKHY6IGFueSkgPT4gXG4gICAgICAgICAgICAgICAgbmV3IEludHJvVmlkZW8oe1xuICAgICAgICAgICAgICAgICAgaWQ6IHYuaWQsXG4gICAgICAgICAgICAgICAgICB1c2VySWQ6IHYudXNlcklkLFxuICAgICAgICAgICAgICAgICAgdmlkZW9Vcmw6IHYudmlkZW9VcmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICBjcmVhdGVkQXQ6IGNvbnZlcnRUaW1lc3RhbXAoZGF0YS5jcmVhdGVkQXQpLFxuICAgICAgICB1cGRhdGVkQXQ6IGNvbnZlcnRUaW1lc3RhbXAoZGF0YS51cGRhdGVkQXQpLFxuICAgICAgfTtcbiAgICB9KTtcblxuICAgIC8vIGNvbnNvbGUubG9nKCdBbGwgdXNlciBjaGFsbGVuZ2VzIGFmdGVyIHByb2Nlc3Npbmc6JywgSlNPTi5zdHJpbmdpZnkodXNlckNoYWxsZW5nZXMsIG51bGwsIDIpKTtcblxuICAgIHJldHVybiB1c2VyQ2hhbGxlbmdlcztcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyB1c2VyIGNoYWxsZW5nZXMgYnkgY2hhbGxlbmdlSWQ6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbmFzeW5jIGdldENvbGxlY3Rpb25CeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFN3ZWF0bGlzdENvbGxlY3Rpb24+IHtcbiAgY29uc29sZS5sb2coXCJGZXRjaGluZyBjb2xsZWN0aW9uIHdpdGggaWQ6XCIsIGlkKTtcbiAgdHJ5IHtcbiAgICBjb25zdCBkb2NSZWYgPSBkb2MoZGIsIFwic3dlYXRsaXN0LWNvbGxlY3Rpb25cIiwgaWQpO1xuICAgIGNvbnN0IGRvY1NuYXAgPSBhd2FpdCBnZXREb2MoZG9jUmVmKTtcbiAgICBpZiAoZG9jU25hcC5leGlzdHMoKSkge1xuICAgICAgcmV0dXJuIG5ldyBTd2VhdGxpc3RDb2xsZWN0aW9uKHtcbiAgICAgICAgaWQ6IGRvY1NuYXAuaWQsXG4gICAgICAgIC4uLmRvY1NuYXAuZGF0YSgpXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ29sbGVjdGlvbiBub3QgZm91bmRcIik7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBnZXR0aW5nIGNvbGxlY3Rpb24gYnkgSUQ6XCIsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4gIFxuYXN5bmMgZmV0Y2hDb2xsZWN0aW9ucyh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8U3dlYXRsaXN0Q29sbGVjdGlvbltdPiB7XG4gIGlmICghdXNlcklkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIElEIGlzIHJlcXVpcmVkJyk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IGNvbGxlY3Rpb25zUmVmID0gZnNDb2xsZWN0aW9uKGRiLCBcInN3ZWF0bGlzdC1jb2xsZWN0aW9uXCIpO1xuXG4gICAgLy8gUXVlcnkgZm9yIHJlY29yZHMgd2hlcmUgb3duZXJJZCBpcyBhbiBhcnJheSB0aGF0IGNvbnRhaW5zIHRoZSB1c2VySWQuXG4gICAgY29uc3QgcUFycmF5ID0gcXVlcnkoY29sbGVjdGlvbnNSZWYsIHdoZXJlKFwib3duZXJJZFwiLCBcImFycmF5LWNvbnRhaW5zXCIsIHVzZXJJZCkpO1xuICAgIGNvbnN0IHNuYXBzaG90QXJyYXkgPSBhd2FpdCBnZXREb2NzKHFBcnJheSk7XG4gICAgY29uc3QgY29sbGVjdGlvbnNGcm9tQXJyYXk6IFN3ZWF0bGlzdENvbGxlY3Rpb25bXSA9IHNuYXBzaG90QXJyYXkuZG9jcy5tYXAoKGRvYzogUXVlcnlEb2N1bWVudFNuYXBzaG90PERvY3VtZW50RGF0YT4pID0+IHtcbiAgICAgIGNvbnN0IGRhdGEgPSB7IGlkOiBkb2MuaWQsIC4uLmRvYy5kYXRhKCkgfTtcbiAgICAgIHJldHVybiBuZXcgU3dlYXRsaXN0Q29sbGVjdGlvbihkYXRhKTtcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKFwiVGhlIGFycmF5IGNvbGxlY3Rpb25zXCIsIGNvbGxlY3Rpb25zRnJvbUFycmF5KTtcblxuICAgIC8vIFF1ZXJ5IGZvciByZWNvcmRzIHdoZXJlIG93bmVySWQgaXMgYSBzdHJpbmcgZXF1YWwgdG8gdGhlIHVzZXJJZC5cbiAgICBjb25zdCBxU3RyaW5nID0gcXVlcnkoY29sbGVjdGlvbnNSZWYsIHdoZXJlKFwib3duZXJJZFwiLCBcIj09XCIsIHVzZXJJZCkpO1xuICAgIGNvbnN0IHNuYXBzaG90U3RyaW5nID0gYXdhaXQgZ2V0RG9jcyhxU3RyaW5nKTtcbiAgICBjb25zdCBjb2xsZWN0aW9uc0Zyb21TdHJpbmc6IFN3ZWF0bGlzdENvbGxlY3Rpb25bXSA9IHNuYXBzaG90U3RyaW5nLmRvY3MubWFwKChkb2M6IFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdDxEb2N1bWVudERhdGE+KSA9PiB7XG4gICAgICBjb25zdCBkYXRhID0geyBpZDogZG9jLmlkLCAuLi5kb2MuZGF0YSgpIH07XG4gICAgICByZXR1cm4gbmV3IFN3ZWF0bGlzdENvbGxlY3Rpb24oZGF0YSk7XG4gICAgfSk7XG5cbiAgICBjb25zb2xlLmxvZyhcIlRoZSBzdHJpbmcgY29sbGVjdGlvbnNcIiwgY29sbGVjdGlvbnNGcm9tU3RyaW5nKTtcblxuXG4gICAgLy8gQ29tYmluZSBib3RoIGFycmF5cyBhbmQgcmVtb3ZlIGR1cGxpY2F0ZXMgKGlmIGFueSkgYmFzZWQgb24gdGhlIGNvbGxlY3Rpb24gaWQuXG4gICAgY29uc3QgY29tYmluZWQgPSBbLi4uY29sbGVjdGlvbnNGcm9tQXJyYXksIC4uLmNvbGxlY3Rpb25zRnJvbVN0cmluZ107XG4gICAgY29uc3QgdW5pcXVlQ29sbGVjdGlvbnMgPSBuZXcgTWFwPHN0cmluZywgU3dlYXRsaXN0Q29sbGVjdGlvbj4oKTtcbiAgICBjb21iaW5lZC5mb3JFYWNoKGNvbGxlY3Rpb24gPT4ge1xuICAgICAgdW5pcXVlQ29sbGVjdGlvbnMuc2V0KGNvbGxlY3Rpb24uaWQsIGNvbGxlY3Rpb24pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIEFycmF5LmZyb20odW5pcXVlQ29sbGVjdGlvbnMudmFsdWVzKCkpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBzd2VhdGxpc3RzOlwiLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuXG5cbiAgICAvKipcbiAgICogRmV0Y2ggdXNlciBjaGFsbGVuZ2VzIGJ5IHVzZXJJZCBhbmQgZmlsdGVyIGZvciBhY3RpdmUgY2hhbGxlbmdlcy5cbiAgICogQHJldHVybnMgQSBwcm9taXNlIHJlc29sdmluZyB0byBhbiBhcnJheSBvZiBhY3RpdmUgY2hhbGxlbmdlcy5cbiAgICogQHRocm93cyBJZiBubyB1c2VyIGlzIHNpZ25lZCBpbiBvciBpZiB0aGUgRmlyZXN0b3JlIHF1ZXJ5IGZhaWxzLlxuICAgKi9cbiAgICBhc3luYyBmZXRjaEFjdGl2ZUNoYWxsZW5nZXMoKTogUHJvbWlzZTxVc2VyQ2hhbGxlbmdlW10+IHtcbiAgICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gdXNlclNlcnZpY2UuY3VycmVudFVzZXI7XG4gICAgICBpZiAoIWN1cnJlbnRVc2VyPy5pZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHVzZXIgaXMgc2lnbmVkIGluJyk7XG4gICAgICB9XG4gICAgXG4gICAgICBjb25zdCB1c2VyQ2hhbGxlbmdlc1JlZiA9IGNvbGxlY3Rpb24oZGIsICd1c2VyLWNoYWxsZW5nZScpO1xuICAgICAgY29uc3QgcSA9IHF1ZXJ5KHVzZXJDaGFsbGVuZ2VzUmVmLCB3aGVyZSgndXNlcklkJywgJz09JywgY3VycmVudFVzZXIuaWQpKTtcbiAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGBGZXRjaGluZyBjaGFsbGVuZ2VzIGZvciB1c2VyIElEOiAke2N1cnJlbnRVc2VyLmlkfWApO1xuICAgIFxuICAgICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XG4gICAgXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGBUb3RhbCBjaGFsbGVuZ2VzIGZldGNoZWQ6ICR7c25hcHNob3QuZG9jcy5sZW5ndGh9YCk7XG4gICAgXG4gICAgICAgIGNvbnN0IGFsbENoYWxsZW5nZXMgPSBzbmFwc2hvdC5kb2NzLm1hcCgoZG9jOiBEb2N1bWVudERhdGEpID0+IHtcbiAgICAgICAgICBjb25zdCBkYXRhID0gZG9jLmRhdGEoKTtcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyBjaGFsbGVuZ2Ugd2l0aCBJRDogJHtkb2MuaWR9YCwgZGF0YSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gVXNlIHRoZSBDaGFsbGVuZ2UgY29uc3RydWN0b3IgdG8gcGFyc2UgdGhlIGNoYWxsZW5nZSBkYXRhXG4gICAgICAgICAgLy8gY29uc29sZS5sb2coXCJkYXRlIGJlZm9yZSBmb3JtYXQ6IFwiICsgY29udmVydEZpcmVzdG9yZVRpbWVzdGFtcChkYXRhLmNoYWxsZW5nZS5zdGFydERhdGUpKTtcblxuICAgICAgICAgIGNvbnN0IGNoYWxsZW5nZSA9IGRhdGEuY2hhbGxlbmdlXG4gICAgICAgICAgICA/IG5ldyBDaGFsbGVuZ2Uoe1xuICAgICAgICAgICAgICAgIGlkOiBkYXRhLmNoYWxsZW5nZS5pZCxcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS5jaGFsbGVuZ2UudGl0bGUsXG4gICAgICAgICAgICAgICAgc3VidGl0bGU6IGRhdGEuY2hhbGxlbmdlLnN1YnRpdGxlLFxuICAgICAgICAgICAgICAgIHBhcnRpY2lwYW50czogZGF0YS5jaGFsbGVuZ2UucGFydGljaXBhbnRzIHx8IFtdLFxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5jaGFsbGVuZ2Uuc3RhdHVzIGFzIENoYWxsZW5nZVN0YXR1cyxcbiAgICAgICAgICAgICAgICBzdGFydERhdGU6IGNvbnZlcnRGaXJlc3RvcmVUaW1lc3RhbXAoZGF0YS5jaGFsbGVuZ2Uuc3RhcnREYXRlKSxcbiAgICAgICAgICAgICAgICBlbmREYXRlOiBjb252ZXJ0RmlyZXN0b3JlVGltZXN0YW1wKGRhdGEuY2hhbGxlbmdlLmVuZERhdGUpLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogY29udmVydEZpcmVzdG9yZVRpbWVzdGFtcChkYXRhLmNoYWxsZW5nZS5jcmVhdGVkQXQpLFxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogY29udmVydEZpcmVzdG9yZVRpbWVzdGFtcChkYXRhLmNoYWxsZW5nZS51cGRhdGVkQXQpLFxuICAgICAgICAgICAgICAgIGludHJvVmlkZW9zOiAoZGF0YS5jaGFsbGVuZ2UuaW50cm9WaWRlb3MgfHwgW10pLm1hcCgodjogYW55KSA9PiBcbiAgICAgICAgICAgICAgICAgIG5ldyBJbnRyb1ZpZGVvKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHYuaWQsXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogdi51c2VySWQsXG4gICAgICAgICAgICAgICAgICAgIHZpZGVvVXJsOiB2LnZpZGVvVXJsXG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIDogdW5kZWZpbmVkO1xuXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBkb2MuaWQsXG4gICAgICAgICAgICAuLi5kYXRhLFxuICAgICAgICAgICAgY2hhbGxlbmdlLFxuICAgICAgICAgICAgY3JlYXRlZEF0OiBjb252ZXJ0RmlyZXN0b3JlVGltZXN0YW1wKGRhdGEuY3JlYXRlZEF0KSxcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogY29udmVydEZpcmVzdG9yZVRpbWVzdGFtcChkYXRhLnVwZGF0ZWRBdCksXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdBbGwgY2hhbGxlbmdlcyBhZnRlciBwcm9jZXNzaW5nOicsIEpTT04uc3RyaW5naWZ5KGFsbENoYWxsZW5nZXMsIG51bGwsIDIpKTtcbiAgICBcbiAgICAgICAgLy8gRmlsdGVyIGZvciBhY3RpdmUgY2hhbGxlbmdlcyAoZW5kRGF0ZSA+IGN1cnJlbnQgZGF0ZSlcbiAgICAgICAgY29uc3QgYWN0aXZlQ2hhbGxlbmdlcyA9IGFsbENoYWxsZW5nZXMuZmlsdGVyKHVzZXJDaGFsbGVuZ2UgPT4ge1xuICAgICAgICAgIGNvbnN0IGVuZERhdGUgPSB1c2VyQ2hhbGxlbmdlLmNoYWxsZW5nZT8uZW5kRGF0ZTtcbiAgICBcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcbiAgICAgICAgICAvLyAgIGBFdmFsdWF0aW5nIGNoYWxsZW5nZSBJRDogJHt1c2VyQ2hhbGxlbmdlLmlkfSwgRW5kIERhdGU6ICR7ZW5kRGF0ZX0sIEN1cnJlbnQgRGF0ZTogJHtuZXcgRGF0ZSgpfWBcbiAgICAgICAgICAvLyApO1xuICAgIFxuICAgICAgICAgIHJldHVybiBlbmREYXRlICYmIGVuZERhdGUgPiBuZXcgRGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICBcbiAgICAgICAgLy8gY29uc29sZS5sb2coYFRvdGFsIGFjdGl2ZSBjaGFsbGVuZ2VzOiAke2FjdGl2ZUNoYWxsZW5nZXMubGVuZ3RofWAsIGFjdGl2ZUNoYWxsZW5nZXMpO1xuICAgIFxuICAgICAgICByZXR1cm4gYWN0aXZlQ2hhbGxlbmdlcztcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGFjdGl2ZSBjaGFsbGVuZ2VzOicsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgfVxuICAgIFxuXG4gIC8qKlxuICAgKiBGZXRjaCB1c2VyIGNoYWxsZW5nZXMgYnkgdXNlcklkLlxuICAgKiBAcmV0dXJucyBBIHByb21pc2UgcmVzb2x2aW5nIHRvIGFuIGFycmF5IG9mIGNoYWxsZW5nZXMuXG4gICAqIEB0aHJvd3MgSWYgbm8gdXNlciBpcyBzaWduZWQgaW4gb3IgaWYgdGhlIEZpcmVzdG9yZSBxdWVyeSBmYWlscy5cbiAgICovXG4gIGFzeW5jIGZldGNoVXNlckNoYWxsZW5nZXMoKTogUHJvbWlzZTxVc2VyQ2hhbGxlbmdlW10+IHtcbiAgICBjb25zdCBjdXJyZW50VXNlciA9IHVzZXJTZXJ2aWNlLmN1cnJlbnRVc2VyO1xuICAgIGlmICghY3VycmVudFVzZXI/LmlkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHVzZXIgaXMgc2lnbmVkIGluJyk7XG4gICAgfVxuXG4gICAgLy8gUmVmZXJlbmNlIHRvIHRoZSB1c2VyLWNoYWxsZW5nZSBjb2xsZWN0aW9uXG4gICAgY29uc3QgdXNlckNoYWxsZW5nZXNSZWYgPSBjb2xsZWN0aW9uKGRiLCAndXNlci1jaGFsbGVuZ2UnKTtcblxuICAgIC8vIFF1ZXJ5IGNoYWxsZW5nZXMgd2hlcmUgdXNlcklkIG1hdGNoZXMgdGhlIGN1cnJlbnQgdXNlcidzIElEXG4gICAgY29uc3QgcSA9IHF1ZXJ5KHVzZXJDaGFsbGVuZ2VzUmVmLCB3aGVyZSgndXNlcklkJywgJz09JywgY3VycmVudFVzZXIuaWQpKTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XG5cbiAgICAgIC8vIE1hcCBkb2N1bWVudHMgdG8gYW4gYXJyYXkgb2YgQ2hhbGxlbmdlIG9iamVjdHNcbiAgICAgIHJldHVybiBzbmFwc2hvdC5kb2NzLm1hcCgoZG9jOiBEb2N1bWVudERhdGEpID0+IG5ldyBVc2VyQ2hhbGxlbmdlKHtcbiAgICAgICAgaWQ6IGRvYy5pZCxcbiAgICAgICAgLi4uZG9jLmRhdGEoKSxcbiAgICAgIH0pKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgdXNlciBjaGFsbGVuZ2VzOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGZldGNoIHVzZXIgY2hhbGxlbmdlcycpO1xuICAgIH1cbiAgfVxuICBcbiAgLy91cGRhdGUgdGhlIHdvcmtvdXQgc3VtbWFyeSxcbiAgYXN5bmMgdXBkYXRlV29ya291dFN1bW1hcnkoe1xuICAgIHVzZXJJZCxcbiAgICB3b3Jrb3V0SWQsXG4gICAgc3VtbWFyeVxuICB9OiB7XG4gICAgdXNlcklkOiBzdHJpbmcsXG4gICAgd29ya291dElkOiBzdHJpbmcsXG4gICAgc3VtbWFyeTogV29ya291dFN1bW1hcnlcbiAgfSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdXNlcklkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHVzZXIgSUQgcHJvdmlkZWQnKTtcbiAgICB9XG4gIFxuICAgIHRyeSB7XG4gICAgICAvLyBDcmVhdGUgYSByZWZlcmVuY2UgdG8gdGhlIGNvbGxlY3Rpb25cbiAgICAgIGNvbnN0IHN1bW1hcnlSZWYgPSBkb2MoZGIsICd1c2VycycsIHVzZXJJZCwgJ3dvcmtvdXRTdW1tYXJ5Jywgc3VtbWFyeS5pZCk7XG4gIFxuICAgICAgLy8gQ29udmVydCBzdW1tYXJ5IHRvIGEgcGxhaW4gb2JqZWN0IGZvciBGaXJlc3RvcmVcbiAgICAgIGNvbnN0IHN1bW1hcnlEYXRhID0ge1xuICAgICAgICBpZDogc3VtbWFyeS5pZCxcbiAgICAgICAgd29ya291dElkOiBzdW1tYXJ5LndvcmtvdXRJZCxcbiAgICAgICAgZXhlcmNpc2VzOiBzdW1tYXJ5LmV4ZXJjaXNlcyxcbiAgICAgICAgYm9keVBhcnRzOiBzdW1tYXJ5LmJvZHlQYXJ0cyxcbiAgICAgICAgc2Vjb25kYXJ5Qm9keVBhcnRzOiBzdW1tYXJ5LnNlY29uZGFyeUJvZHlQYXJ0cyxcbiAgICAgICAgd29ya291dFRpdGxlOiBzdW1tYXJ5LndvcmtvdXRUaXRsZSxcbiAgICAgICAgY2Fsb3JpZXNCdXJuZWQ6IHN1bW1hcnkuY2Fsb3JpZXNCdXJuZWQsXG4gICAgICAgIHdvcmtvdXRSYXRpbmc6IHN1bW1hcnkud29ya291dFJhdGluZyxcbiAgICAgICAgZXhlcmNpc2VzQ29tcGxldGVkOiBzdW1tYXJ5LmV4ZXJjaXNlc0NvbXBsZXRlZCxcbiAgICAgICAgYWlJbnNpZ2h0OiBzdW1tYXJ5LmFpSW5zaWdodCxcbiAgICAgICAgcmVjb21tZW5kYXRpb25zOiBzdW1tYXJ5LnJlY29tbWVuZGF0aW9ucyxcbiAgICAgICAgZ2lmVVJMczogc3VtbWFyeS5naWZVUkxzLFxuICAgICAgICByZWNvbW1lbmRlZFdvcms6IHN1bW1hcnkucmVjb21tZW5kZWRXb3JrLFxuICAgICAgICBpc0NvbXBsZXRlZDogc3VtbWFyeS5pc0NvbXBsZXRlZCxcbiAgICAgICAgY3JlYXRlZEF0OiBzdW1tYXJ5LmNyZWF0ZWRBdCxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICBjb21wbGV0ZWRBdDogc3VtbWFyeS5jb21wbGV0ZWRBdCxcbiAgICAgICAgZHVyYXRpb246IHN1bW1hcnkuZHVyYXRpb25cbiAgICAgIH07XG4gIFxuICAgICAgLy8gU2V0IGRhdGEgd2l0aCBtZXJnZSBlbmFibGVkIChlcXVpdmFsZW50IHRvIFN3aWZ0J3Mgc2V0RGF0YSB3aXRoIG1lcmdlOiB0cnVlKVxuICAgICAgYXdhaXQgc2V0RG9jKHN1bW1hcnlSZWYsIHN1bW1hcnlEYXRhLCB7IG1lcmdlOiB0cnVlIH0pO1xuICBcbiAgICAgIGNvbnNvbGUubG9nKCdXb3Jrb3V0IHN1bW1hcnkgZG9jdW1lbnQgdXBkYXRlZCBzdWNjZXNzZnVsbHknKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgd29ya291dCBzdW1tYXJ5OicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZVdvcmtvdXRMb2dzKHtcbiAgICB1c2VySWQsXG4gICAgd29ya291dElkLCBcbiAgICBsb2dzXG4gIH06IHtcbiAgICB1c2VySWQ6IHN0cmluZyxcbiAgICB3b3Jrb3V0SWQ6IHN0cmluZywgXG4gICAgbG9nczogRXhlcmNpc2VMb2dbXVxuICB9KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHdvcmtvdXRSZWYgPSBkb2MoZGIsICd1c2VycycsIHVzZXJJZCwgJ3dvcmtvdXRTZXNzaW9ucycsIHdvcmtvdXRJZCk7XG4gICAgICBjb25zdCBsb2dzUmVmID0gY29sbGVjdGlvbih3b3Jrb3V0UmVmLCAnbG9ncycpO1xuICAgICAgY29uc3QgYmF0Y2ggPSB3cml0ZUJhdGNoKGRiKTtcbiAgICAgIFxuICAgICAgbG9ncy5mb3JFYWNoKGxvZyA9PiB7XG4gICAgICAgIGNvbnN0IGxvZ0RvY1JlZiA9IGRvYyhsb2dzUmVmLCBsb2cuaWQpO1xuICAgICAgICBiYXRjaC51cGRhdGUobG9nRG9jUmVmLCB7XG4gICAgICAgICAgLi4ubG9nLnRvRGljdGlvbmFyeSgpXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gIFxuICAgICAgYXdhaXQgYmF0Y2guY29tbWl0KCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHdvcmtvdXQgbG9nczonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvLyBUaGUgY2FuY2VsV29ya291dCBtZXRob2Qg4oCTIGl0IGRlbGV0ZXMgdGhlIHdvcmtvdXQgc2Vzc2lvbiBhbmQgc3VtbWFyeSAoaWYgYW55KSxcbi8vIGNsZWFucyB1cCB0aGUgbG9jYWwgc3RhdGUsIGFuZCBsb2dzIHRoZSBjYW5jZWxsYXRpb24uXG5hc3luYyBjYW5jZWxXb3Jrb3V0KHdvcmtvdXQ6IFdvcmtvdXQgfCBudWxsLCB3b3Jrb3V0U3VtbWFyeTogV29ya291dFN1bW1hcnkgfCBudWxsKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmICghdXNlclNlcnZpY2UuY3VycmVudFVzZXI/LmlkIHx8ICF3b3Jrb3V0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVXNlciBub3QgYXV0aGVudGljYXRlZC5cIik7XG4gIH1cblxuICB0cnkgeyAgICBcbiAgICAgIGF3YWl0IHRoaXMuZGVsZXRlV29ya291dFNlc3Npb24od29ya291dC5pZCk7XG4gICAgICBpZiAod29ya291dFN1bW1hcnkpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5kZWxldGVXb3Jrb3V0U3VtbWFyeSh3b3Jrb3V0U3VtbWFyeS5pZCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHRoaXMuY2xlYW5VcFdvcmtvdXRJblByb2dyZXNzKCk7XG4gICAgICBjb25zb2xlLmxvZyhcIldvcmtvdXQgY2FuY2VsZWQgYW5kIGNsZWFuZWQgdXAgc3VjY2Vzc2Z1bGx5LlwiKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgY2FuY2VsaW5nIHdvcmtvdXQ6XCIsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuICBcbi8vIERlbGV0ZXMgYSB3b3Jrb3V0IHNlc3Npb24gZG9jdW1lbnQgYW5kIGFsbCBpdHMgc3ViY29sbGVjdGlvbiBcImxvZ3NcIlxuYXN5bmMgZGVsZXRlV29ya291dFNlc3Npb24od29ya291dElkOiBzdHJpbmcgfCBudWxsKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmICghdXNlclNlcnZpY2UuY3VycmVudFVzZXI/LmlkIHx8ICF3b3Jrb3V0SWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJVc2VyIG5vdCBhdXRoZW50aWNhdGVkLlwiKTtcbiAgfVxuICBjb25zdCB1c2VySWQgPSB1c2VyU2VydmljZS5jdXJyZW50VXNlci5pZDtcbiAgY29uc3Qgd29ya291dFJlZiA9IGRvYyhkYiwgXCJ1c2Vyc1wiLCB1c2VySWQsIFwid29ya291dFNlc3Npb25zXCIsIHdvcmtvdXRJZCk7XG4gIFxuICB0cnkge1xuICAgIC8vIERlbGV0ZSBhbGwgbG9ncyBpbiB0aGUgc3ViY29sbGVjdGlvblxuICAgIGNvbnN0IGxvZ3NSZWYgPSBjb2xsZWN0aW9uKHdvcmtvdXRSZWYsIFwibG9nc1wiKTtcbiAgICBjb25zdCBsb2dzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGxvZ3NSZWYpO1xuICAgIGNvbnN0IGJhdGNoID0gd3JpdGVCYXRjaChkYik7XG4gICAgXG4gICAgbG9nc1NuYXBzaG90LmRvY3MuZm9yRWFjaCgobG9nRG9jKSA9PiB7XG4gICAgICBiYXRjaC5kZWxldGUobG9nRG9jLnJlZik7XG4gICAgfSk7XG4gICAgXG4gICAgLy8gRGVsZXRlIHRoZSBtYWluIHdvcmtvdXQgZG9jdW1lbnRcbiAgICBiYXRjaC5kZWxldGUod29ya291dFJlZik7XG4gICAgXG4gICAgYXdhaXQgYmF0Y2guY29tbWl0KCk7XG4gICAgY29uc29sZS5sb2coXCJXb3Jrb3V0IHNlc3Npb24gYW5kIGxvZ3MgZGVsZXRlZCBzdWNjZXNzZnVsbHkuXCIpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZWxldGluZyB3b3Jrb3V0IHNlc3Npb246XCIsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4gIC8vIERlbGV0ZXMgdGhlIHdvcmtvdXQgc3VtbWFyeSBkb2N1bWVudC5cbiAgYXN5bmMgZGVsZXRlV29ya291dFN1bW1hcnkod29ya291dFN1bW1hcnlJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCF3b3Jrb3V0U3VtbWFyeUlkIHx8ICF1c2VyU2VydmljZS5jdXJyZW50VXNlcj8uaWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN1bW1hcnlSZWYgPSBkb2MoZGIsIFwidXNlcnNcIiwgdXNlclNlcnZpY2UuY3VycmVudFVzZXIuaWQsIFwid29ya291dFN1bW1hcnlcIiwgd29ya291dFN1bW1hcnlJZCk7XG4gICAgICBhd2FpdCBkZWxldGVEb2Moc3VtbWFyeVJlZik7XG4gICAgICBjb25zb2xlLmxvZyhcIldvcmtvdXQgc3VtbWFyeSBkZWxldGVkIHN1Y2Nlc3NmdWxseS5cIik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZWxldGluZyB3b3Jrb3V0IHN1bW1hcnk6XCIsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8vIENsZWFuIHVwIGxvY2FsIHN0b3JhZ2UgYW5kIGluLW1lbW9yeSB3b3Jrb3V0IHN0YXRlLlxuICAgIGNsZWFuVXBXb3Jrb3V0SW5Qcm9ncmVzcygpOiB2b2lkIHtcbiAgICAgIHN0b3JlLmRpc3BhdGNoKHJlc2V0V29ya291dFN0YXRlKCkpO1xuICAgIH1cbiAgICAgIFxuICBcbiAgLyoqXG4gICAqIEZldGNoIHRoZSB3b3Jrb3V0IHNlc3Npb24gZnJvbSBGaXJlc3RvcmUsIHJldHVybmluZyB7IHdvcmtvdXQsIGxvZ3MgfS5cbiAgICogQ2hlY2tzIGZpcnN0IGZvciBhIFF1ZXVlZFVwIHNlc3Npb24sIHRoZW4gZm9yIEluUHJvZ3Jlc3MuXG4gICAqL1xuICBhc3luYyBmZXRjaEN1cnJlbnRXb3Jrb3V0U2Vzc2lvbih1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8e1xuICAgIHdvcmtvdXQ6IFdvcmtvdXQgfCBudWxsO1xuICAgIGxvZ3M6IEV4ZXJjaXNlTG9nW10gfCBudWxsO1xuICAgfT4ge1xuICAgIGlmICghdXNlcklkKSB0aHJvdyBuZXcgRXJyb3IoJ05vIHVzZXIgSUQgcHJvdmlkZWQnKTtcbiAgIFxuICAgIGNvbnN0IGV4ZXJjaXNlU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGNvbGxlY3Rpb24oZGIsICdleGVyY2lzZXMnKSk7XG4gICAgY29uc3QgdmlkZW9TbmFwc2hvdCA9IGF3YWl0IGdldERvY3MoY29sbGVjdGlvbihkYiwgJ2V4ZXJjaXNlVmlkZW9zJykpO1xuICAgXG4gICAgY29uc3QgZXhlcmNpc2VWaWRlb3MgPSB2aWRlb1NuYXBzaG90LmRvY3MubWFwKChkb2MpID0+IFxuICAgICAgbmV3IEV4ZXJjaXNlVmlkZW8oe1xuICAgICAgICBpZDogZG9jLmlkLFxuICAgICAgICAuLi5kb2MuZGF0YSgpXG4gICAgICB9KVxuICAgICk7XG4gICBcbiAgICBjb25zdCBleGVyY2lzZXNXaXRoVmlkZW9zID0gZXhlcmNpc2VTbmFwc2hvdC5kb2NzLm1hcChkb2MgPT4ge1xuICAgICAgY29uc3QgZXhlcmNpc2UgPSBuZXcgRXhlcmNpc2Uoe1xuICAgICAgICBpZDogZG9jLmlkLFxuICAgICAgICAuLi5kb2MuZGF0YSgpXG4gICAgICB9KTtcbiAgIFxuICAgICAgY29uc3QgbWF0Y2hpbmdWaWRlb3MgPSBleGVyY2lzZVZpZGVvcy5maWx0ZXIoXG4gICAgICAgICh2aWRlbykgPT4gdmlkZW8uZXhlcmNpc2UudG9Mb3dlckNhc2UoKSA9PT0gZXhlcmNpc2UubmFtZS50b0xvd2VyQ2FzZSgpXG4gICAgICApO1xuICAgXG4gICAgICByZXR1cm4gbmV3IEV4ZXJjaXNlKHtcbiAgICAgICAgLi4uZXhlcmNpc2UsXG4gICAgICAgIHZpZGVvczogbWF0Y2hpbmdWaWRlb3NcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgXG4gICAgY29uc3Qgd29ya291dFNlc3Npb25zUmVmID0gY29sbGVjdGlvbihkYiwgJ3VzZXJzJywgdXNlcklkLCAnd29ya291dFNlc3Npb25zJyk7XG4gICBcbiAgICBsZXQgcSA9IHF1ZXJ5KHdvcmtvdXRTZXNzaW9uc1JlZiwgd2hlcmUoJ3N0YXR1cycsICc9PScsIFdvcmtvdXRTdGF0dXMuUXVldWVkVXApKTtcbiAgICBsZXQgc25hcCA9IGF3YWl0IGdldERvY3MocSk7XG4gICBcbiAgICBpZiAoIXNuYXAuZW1wdHkpIHtcbiAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NXb3Jrb3V0U2Vzc2lvbkRvY3VtZW50KHNuYXAuZG9jc1swXSwgZXhlcmNpc2VzV2l0aFZpZGVvcyk7XG4gICAgfVxuICAgXG4gICAgcSA9IHF1ZXJ5KHdvcmtvdXRTZXNzaW9uc1JlZiwgd2hlcmUoJ3N0YXR1cycsICc9PScsIFdvcmtvdXRTdGF0dXMuSW5Qcm9ncmVzcykpO1xuICAgIHNuYXAgPSBhd2FpdCBnZXREb2NzKHEpO1xuICAgXG4gICAgaWYgKCFzbmFwLmVtcHR5KSB7XG4gICAgICByZXR1cm4gdGhpcy5wcm9jZXNzV29ya291dFNlc3Npb25Eb2N1bWVudChzbmFwLmRvY3NbMF0sIGV4ZXJjaXNlc1dpdGhWaWRlb3MpO1xuICAgIH1cbiAgIFxuICAgIHJldHVybiB7IHdvcmtvdXQ6IG51bGwsIGxvZ3M6IG51bGwgfTtcbiAgIH1cblxuICBwcml2YXRlIGFzeW5jIGZldGNoQW5kTWFwRXhlcmNpc2VzV2l0aFZpZGVvcygpOiBQcm9taXNlPEV4ZXJjaXNlW10+IHtcbiAgICB0cnkge1xuICAgICAgLy8gY29uc29sZS5sb2coJ1N0YXJ0aW5nIGZldGNoQW5kTWFwRXhlcmNpc2VzV2l0aFZpZGVvcycpO1xuICBcbiAgICAgIC8vIDEuIEZldGNoIGFsbCBleGVyY2lzZXMgXG4gICAgICBjb25zdCBleGVyY2lzZVNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhjb2xsZWN0aW9uKGRiLCAnZXhlcmNpc2VzJykpO1xuICAgICAgY29uc3QgZXhlcmNpc2VzID0gZXhlcmNpc2VTbmFwc2hvdC5kb2NzLm1hcCgoZG9jKSA9PiBcbiAgICAgICAgbmV3IEV4ZXJjaXNlKHtcbiAgICAgICAgICBpZDogZG9jLmlkLFxuICAgICAgICAgIC4uLmRvYy5kYXRhKClcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgICAvLyBjb25zb2xlLmxvZyhgRmV0Y2hlZCAke2V4ZXJjaXNlcy5sZW5ndGh9IGV4ZXJjaXNlc2ApO1xuICBcbiAgICAgIC8vIDIuIEZldGNoIGFsbCB2aWRlb3NcbiAgICAgIGNvbnN0IHZpZGVvU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGNvbGxlY3Rpb24oZGIsICdleGVyY2lzZVZpZGVvcycpKTtcbiAgICAgIGNvbnN0IGV4ZXJjaXNlVmlkZW9zID0gdmlkZW9TbmFwc2hvdC5kb2NzLm1hcCgoZG9jKSA9PiBcbiAgICAgICAgbmV3IEV4ZXJjaXNlVmlkZW8oe1xuICAgICAgICAgIGlkOiBkb2MuaWQsXG4gICAgICAgICAgLi4uZG9jLmRhdGEoKVxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKGBGZXRjaGVkICR7ZXhlcmNpc2VWaWRlb3MubGVuZ3RofSBleGVyY2lzZSB2aWRlb3NgKTtcbiAgXG4gICAgICAvLyAzLiBNYXAgdmlkZW9zIHRvIGV4ZXJjaXNlc1xuICAgICAgY29uc3QgZXhlcmNpc2VzV2l0aFZpZGVvcyA9IGV4ZXJjaXNlcy5tYXAoZXhlcmNpc2UgPT4ge1xuICAgICAgICBjb25zdCBtYXRjaGluZ1ZpZGVvcyA9IGV4ZXJjaXNlVmlkZW9zLmZpbHRlcihcbiAgICAgICAgICAodmlkZW8pID0+IHZpZGVvLmV4ZXJjaXNlLnRvTG93ZXJDYXNlKCkgPT09IGV4ZXJjaXNlLm5hbWUudG9Mb3dlckNhc2UoKVxuICAgICAgICApO1xuICAgICAgIFxuICAgICAgICByZXR1cm4gbmV3IEV4ZXJjaXNlKHtcbiAgICAgICAgICAuLi5leGVyY2lzZSxcbiAgICAgICAgICB2aWRlb3M6IG1hdGNoaW5nVmlkZW9zXG4gICAgICAgIH0pO1xuICAgICAgIH0pO1xuICBcbiAgICAgIC8vIGNvbnNvbGUubG9nKCdGaW5pc2hlZCBtYXBwaW5nIGV4ZXJjaXNlcyB3aXRoIHZpZGVvcycpO1xuICAgICAgLy8gY29uc29sZS5sb2coYFRvdGFsIGV4ZXJjaXNlcyB3aXRoIHZpZGVvczogJHtleGVyY2lzZXNXaXRoVmlkZW9zLmxlbmd0aH1gKTtcbiAgICAgICAgXG4gICAgICByZXR1cm4gZXhlcmNpc2VzV2l0aFZpZGVvcztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYW5kIG1hcHBpbmcgZXhlcmNpc2VzIHdpdGggdmlkZW9zOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBIZWxwZXIgdG8gYnVpbGQgdGhlIFdvcmtvdXQgb2JqZWN0ICsgYW55IGxvZ3MgZnJvbSB0aGUgc25hcHNob3QuXG4gICAqL1xuICBhc3luYyBmZXRjaEFsbFdvcmtvdXRTZXNzaW9ucyh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8e1xuICAgIHdvcmtvdXQ6IFdvcmtvdXQgfCBudWxsO1xuICAgIGxvZ3M6IEV4ZXJjaXNlTG9nW10gfCBudWxsO1xuICAgfVtdPiB7XG4gICAgaWYgKCF1c2VySWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gdXNlciBJRCBwcm92aWRlZCcpO1xuICAgIH1cbiAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCBleGVyY2lzZVNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhjb2xsZWN0aW9uKGRiLCAnZXhlcmNpc2VzJykpO1xuICAgICAgY29uc3QgZXhlcmNpc2VzID0gZXhlcmNpc2VTbmFwc2hvdC5kb2NzLm1hcCgoZG9jKSA9PiBcbiAgICAgICAgbmV3IEV4ZXJjaXNlKHtcbiAgICAgICAgICBpZDogZG9jLmlkLFxuICAgICAgICAgIC4uLmRvYy5kYXRhKClcbiAgICAgICAgfSlcbiAgICAgICk7XG4gIFxuICAgICAgY29uc3QgdmlkZW9TbmFwc2hvdCA9IGF3YWl0IGdldERvY3MoY29sbGVjdGlvbihkYiwgJ2V4ZXJjaXNlVmlkZW9zJykpO1xuICAgICAgY29uc3QgZXhlcmNpc2VWaWRlb3MgPSB2aWRlb1NuYXBzaG90LmRvY3MubWFwKChkb2MpID0+IFxuICAgICAgICBuZXcgRXhlcmNpc2VWaWRlbyh7XG4gICAgICAgICAgaWQ6IGRvYy5pZCxcbiAgICAgICAgICAuLi5kb2MuZGF0YSgpXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgXG4gICAgICBjb25zdCBleGVyY2lzZXNXaXRoVmlkZW9zID0gZXhlcmNpc2VzLm1hcChleGVyY2lzZSA9PiB7XG4gICAgICAgIGNvbnN0IG1hdGNoaW5nVmlkZW9zID0gZXhlcmNpc2VWaWRlb3MuZmlsdGVyKFxuICAgICAgICAgICh2aWRlbykgPT4gdmlkZW8uZXhlcmNpc2UudG9Mb3dlckNhc2UoKSA9PT0gZXhlcmNpc2UubmFtZS50b0xvd2VyQ2FzZSgpXG4gICAgICAgICk7XG4gICBcbiAgICAgICAgcmV0dXJuIG5ldyBFeGVyY2lzZSh7XG4gICAgICAgICAgLi4uZXhlcmNpc2UsXG4gICAgICAgICAgdmlkZW9zOiBtYXRjaGluZ1ZpZGVvc1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgXG4gICAgICBjb25zdCB3b3Jrb3V0U2Vzc2lvbnNSZWYgPSBjb2xsZWN0aW9uKGRiLCAndXNlcnMnLCB1c2VySWQsICd3b3Jrb3V0U2Vzc2lvbnMnKTtcbiAgICAgIGNvbnN0IHNuYXAgPSBhd2FpdCBnZXREb2NzKHdvcmtvdXRTZXNzaW9uc1JlZik7XG4gICBcbiAgICAgIGlmIChzbmFwLmVtcHR5KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdObyB3b3Jrb3V0IHNlc3Npb25zIGZvdW5kIGZvciB1c2VyJyk7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgIFxuICAgICAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgc25hcC5kb2NzLm1hcChhc3luYyAoZG9jKSA9PiB7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbkRhdGEgPSBhd2FpdCB0aGlzLnByb2Nlc3NXb3Jrb3V0U2Vzc2lvbkRvY3VtZW50KFxuICAgICAgICAgICAgZG9jLCBcbiAgICAgICAgICAgIGV4ZXJjaXNlc1dpdGhWaWRlb3NcbiAgICAgICAgICApO1xuICAgICAgICAgIFxuICAgICAgICAgIGlmIChzZXNzaW9uRGF0YS5sb2dzKSB7XG4gICAgICAgICAgICBzZXNzaW9uRGF0YS5sb2dzLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICAgICAgY29uc3Qgb3JkZXJBID0gYS5vcmRlciA/PyAwO1xuICAgICAgICAgICAgICBjb25zdCBvcmRlckIgPSBiLm9yZGVyID8/IDA7XG4gICAgICAgICAgICAgIHJldHVybiBvcmRlckEgLSBvcmRlckI7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICBcbiAgICAgICAgICByZXR1cm4gc2Vzc2lvbkRhdGE7XG4gICAgICAgIH0pXG4gICAgICApO1xuICAgXG4gICAgICByZXR1cm4gc2Vzc2lvbnM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHdvcmtvdXQgc2Vzc2lvbnM6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgfVxuXG4gIGFzeW5jIHVwZGF0ZUNvbGxlY3Rpb24oY29sbGVjdGlvbjogU3dlYXRsaXN0Q29sbGVjdGlvbik6IFByb21pc2U8U3dlYXRsaXN0Q29sbGVjdGlvbj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb2xsUmVmID0gZnNDb2xsZWN0aW9uKGRiLCBcInN3ZWF0bGlzdC1jb2xsZWN0aW9uXCIpO1xuICBcbiAgICAgIC8vIElmIGNvbGxlY3Rpb24uaWQgaXMgZW1wdHksIGdlbmVyYXRlIGEgbmV3IGRvYyBJRCBhbmQgYXNzaWduIGl0LlxuICAgICAgaWYgKCFjb2xsZWN0aW9uLmlkIHx8IGNvbGxlY3Rpb24uaWQudHJpbSgpID09PSBcIlwiKSB7XG4gICAgICAgIGNvbnN0IG5ld0RvY1JlZiA9IGRvYyhjb2xsUmVmKTtcbiAgICAgICAgY29sbGVjdGlvbi5pZCA9IG5ld0RvY1JlZi5pZDtcbiAgICAgIH1cbiAgXG4gICAgICAvLyBFbnN1cmUgdGhlIGNoYWxsZW5nZSBpZCBtYXRjaGVzIHRoZSBjb2xsZWN0aW9uIGlkLlxuICAgICAgaWYgKGNvbGxlY3Rpb24uY2hhbGxlbmdlKSB7XG4gICAgICAgIGNvbGxlY3Rpb24uY2hhbGxlbmdlLmlkID0gY29sbGVjdGlvbi5pZDtcbiAgICAgIH1cbiAgXG4gICAgICAvLyBVcGRhdGUgdGhlIHVwZGF0ZWRBdCBmaWVsZC5cbiAgICAgIGNvbGxlY3Rpb24udXBkYXRlZEF0ID0gbmV3IERhdGUoKTtcbiAgXG4gICAgICAvLyBTYXZlIHRoZSBjb2xsZWN0aW9uIHRvIEZpcmVzdG9yZS5cbiAgICAgIGF3YWl0IHNldERvYyhkb2MoY29sbFJlZiwgY29sbGVjdGlvbi5pZCksIGNvbGxlY3Rpb24udG9EaWN0aW9uYXJ5KCkpO1xuICAgICAgY29uc29sZS5sb2coXCJDb2xsZWN0aW9uIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgcmV0dXJuIGNvbGxlY3Rpb247XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluZyBjb2xsZWN0aW9uIGRvY3VtZW50OlwiLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFcnJvciB3aGlsZSB1cGRhdGluZyB0aGUgY29sbGVjdGlvblwiKTtcbiAgICB9XG4gIH1cbiAgXG4gIHByaXZhdGUgYXN5bmMgcHJvY2Vzc1dvcmtvdXRTZXNzaW9uRG9jdW1lbnQoXG4gICAgd29ya291dERvYzogUXVlcnlEb2N1bWVudFNuYXBzaG90PERvY3VtZW50RGF0YT4sXG4gICAgZXhlcmNpc2VzV2l0aFZpZGVvczogRXhlcmNpc2VbXVxuICApOiBQcm9taXNlPHsgd29ya291dDogV29ya291dDsgbG9nczogRXhlcmNpc2VMb2dbXSB9PiB7XG4gICAgY29uc3QgZGF0YSA9IHdvcmtvdXREb2MuZGF0YSgpO1xuICBcblxuICAgIC8vIE1hcCBleGVyY2lzZXMgd2l0aCB0aGVpciBmdWxsIGRhdGEgYW5kIHZpZGVvc1xuICAgIGNvbnN0IG1hcHBlZEV4ZXJjaXNlcyA9IChkYXRhLmV4ZXJjaXNlcyB8fCBbXSkubWFwKChleGVyY2lzZVJlZjogYW55KSA9PiB7XG4gICAgICAvLyBGaW5kIHRoZSBmdWxsIGV4ZXJjaXNlIHdpdGggdmlkZW9zXG4gICAgICBjb25zdCBleGVyY2lzZU5hbWVMb3dlciA9IGV4ZXJjaXNlUmVmLmV4ZXJjaXNlPy5uYW1lPy50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcbiAgICAgIGNvbnN0IGZ1bGxFeGVyY2lzZSA9IGV4ZXJjaXNlc1dpdGhWaWRlb3MuZmluZChcbiAgICAgICAgZXggPT4gZXgubmFtZS50b0xvd2VyQ2FzZSgpLnRyaW0oKSA9PT0gZXhlcmNpc2VOYW1lTG93ZXJcbiAgICAgICk7XG4gIFxuICAgICAgLy8gSWYgZnVsbCBleGVyY2lzZSBmb3VuZCwgcmV0dXJuIGl0LCBvdGhlcndpc2UgdXNlIHRoZSBvcmlnaW5hbFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uZXhlcmNpc2VSZWYsXG4gICAgICAgIGV4ZXJjaXNlOiBmdWxsRXhlcmNpc2UgfHwgZXhlcmNpc2VSZWYuZXhlcmNpc2VcbiAgICAgIH07XG4gICAgfSk7XG4gIFxuICAgIC8vIENyZWF0ZSB0aGUgd29ya291dCB3aXRoIG1hcHBlZCBleGVyY2lzZXNcbiAgICBjb25zdCB3b3Jrb3V0ID0gbmV3IFdvcmtvdXQoe1xuICAgICAgaWQ6IHdvcmtvdXREb2MuaWQsXG4gICAgICByb3VuZFdvcmtvdXRJZDogZGF0YS5yb3VuZFdvcmtvdXRJZCB8fCAnJyxcbiAgICAgIGV4ZXJjaXNlczogbWFwcGVkRXhlcmNpc2VzLFxuICAgICAgdGl0bGU6IGRhdGEudGl0bGUgfHwgJycsXG4gICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbiB8fCAnJyxcbiAgICAgIGR1cmF0aW9uOiBkYXRhLmR1cmF0aW9uIHx8IDAsXG4gICAgICB1c2VBdXRob3JDb250ZW50OiBkYXRhLnVzZUF1dGhvckNvbnRlbnQgfHwgZmFsc2UsXG4gICAgICBpc0NvbXBsZXRlZDogZGF0YS5pc0NvbXBsZXRlZCB8fCBmYWxzZSxcbiAgICAgIHdvcmtvdXRTdGF0dXM6IGRhdGEud29ya291dFN0YXR1cyB8fCBXb3Jrb3V0U3RhdHVzLkFyY2hpdmVkLFxuICAgICAgYXV0aG9yOiBkYXRhLmF1dGhvciB8fCAnJyxcbiAgICAgIGNyZWF0ZWRBdDogY29udmVydEZpcmVzdG9yZVRpbWVzdGFtcChkYXRhLmNyZWF0ZWRBdCksXG4gICAgICB1cGRhdGVkQXQ6IGNvbnZlcnRGaXJlc3RvcmVUaW1lc3RhbXAoZGF0YS51cGRhdGVkQXQpLFxuICAgICAgc3RhcnRUaW1lOiBjb252ZXJ0RmlyZXN0b3JlVGltZXN0YW1wKGRhdGEuc3RhcnRUaW1lKSxcbiAgICAgIGNvbGxlY3Rpb25JZDogZGF0YS5jb2xsZWN0aW9uSWQsXG4gICAgICBjaGFsbGVuZ2U6IGRhdGEuY2hhbGxlbmdlLFxuICAgICAgbG9nczogKGRhdGEubG9ncyB8fCBbXSkubWFwKChsb2dEYXRhOiBhbnkpID0+IHtcbiAgICAgICAgLy8gTWFwIGxvZ3Mgd2l0aCBmdWxsIGV4ZXJjaXNlc1xuICAgICAgICBjb25zdCBleGVyY2lzZU5hbWVMb3dlciA9IGxvZ0RhdGEuZXhlcmNpc2U/Lm5hbWU/LnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgICAgICBjb25zdCBmdWxsRXhlcmNpc2UgPSBleGVyY2lzZXNXaXRoVmlkZW9zLmZpbmQoXG4gICAgICAgICAgZXggPT4gZXgubmFtZS50b0xvd2VyQ2FzZSgpLnRyaW0oKSA9PT0gZXhlcmNpc2VOYW1lTG93ZXJcbiAgICAgICAgKTtcbiAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ubG9nRGF0YSxcbiAgICAgICAgICBleGVyY2lzZTogZnVsbEV4ZXJjaXNlIHx8IGxvZ0RhdGEuZXhlcmNpc2VcbiAgICAgICAgfTtcbiAgICAgIH0pLFxuICAgICAgd29ya291dFJhdGluZzogZGF0YS53b3Jrb3V0UmF0aW5nLFxuICAgICAgb3JkZXI6IGRhdGEub3JkZXIsXG4gICAgICB6b25lOiBkYXRhLnpvbmUgfHwgQm9keVpvbmUuRnVsbEJvZHlcbiAgICB9KTtcbiAgXG4gICAgLy8gRmV0Y2ggbG9ncyBmcm9tIHN1YmNvbGxlY3Rpb25cbiAgICBjb25zdCBsb2dzUmVmID0gY29sbGVjdGlvbih3b3Jrb3V0RG9jLnJlZiwgJ2xvZ3MnKTtcbiAgICBjb25zdCBsb2dzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGxvZ3NSZWYpO1xuICAgIFxuICAgIGNvbnN0IGxvZ3M6IEV4ZXJjaXNlTG9nW10gPSBsb2dzU25hcHNob3QuZG9jcy5tYXAobG9nRG9jID0+IHtcbiAgICAgIGNvbnN0IGxvZ0RhdGEgPSBsb2dEb2MuZGF0YSgpO1xuICAgICAgXG4gICAgICAvLyBGaW5kIHRoZSBmdWxsIGV4ZXJjaXNlIHdpdGggdmlkZW9zXG4gICAgICBjb25zdCBleGVyY2lzZU5hbWVMb3dlciA9IGxvZ0RhdGEuZXhlcmNpc2U/Lm5hbWU/LnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgICAgY29uc3QgZnVsbEV4ZXJjaXNlID0gZXhlcmNpc2VzV2l0aFZpZGVvcy5maW5kKFxuICAgICAgICBleCA9PiBleC5uYW1lLnRvTG93ZXJDYXNlKCkudHJpbSgpID09PSBleGVyY2lzZU5hbWVMb3dlclxuICAgICAgKTtcblxuICAgICAgY29uc3QgdXBkYXRlZEV4ZXJjaXNlID0gZnVsbEV4ZXJjaXNlXG4gICAgICA/IHtcbiAgICAgICAgICAuLi5mdWxsRXhlcmNpc2UsXG4gICAgICAgICAgY2F0ZWdvcnk6IGxvZ0RhdGEuZXhlcmNpc2UuY2F0ZWdvcnksXG4gICAgICAgIH1cbiAgICAgIDogbG9nRGF0YS5leGVyY2lzZTtcbiAgXG4gICAgICAvLyBQcmVwYXJlIGxvZyBkYXRhIHdpdGggZnVsbCBleGVyY2lzZVxuICAgICAgY29uc3QgcHJlcGFyZWRMb2dEYXRhID0ge1xuICAgICAgICAuLi5sb2dEYXRhLFxuICAgICAgICBpZDogbG9nRG9jLmlkLFxuICAgICAgICB3b3Jrb3V0SWQ6IHdvcmtvdXQuaWQsXG4gICAgICAgIGV4ZXJjaXNlOiB1cGRhdGVkRXhlcmNpc2UsXG4gICAgICAgIGNyZWF0ZWRBdDogY29udmVydEZpcmVzdG9yZVRpbWVzdGFtcChsb2dEYXRhLmNyZWF0ZWRBdCksXG4gICAgICAgIHVwZGF0ZWRBdDogY29udmVydEZpcmVzdG9yZVRpbWVzdGFtcChsb2dEYXRhLnVwZGF0ZWRBdClcbiAgICAgIH07XG4gIFxuICAgICAgLy8gVXNlIHRoZSBFeGVyY2lzZUxvZyBjb25zdHJ1Y3RvciB0byBlbnN1cmUgcHJvcGVyIG1hcHBpbmdcbiAgICAgIHJldHVybiBuZXcgRXhlcmNpc2VMb2cocHJlcGFyZWRMb2dEYXRhKTtcbiAgICB9KTtcbiAgXG4gICAgcmV0dXJuIHsgd29ya291dCwgbG9ncyB9O1xuICB9XG5cbiAgYXN5bmMgc2F2ZVdvcmtvdXRTZXNzaW9uKHtcbiAgICB1c2VySWQsXG4gICAgd29ya291dCxcbiAgICBsb2dzXG4gICB9OiB7XG4gICAgdXNlcklkOiBzdHJpbmcsXG4gICAgd29ya291dDogV29ya291dCxcbiAgICBsb2dzOiBFeGVyY2lzZUxvZ1tdXG4gICB9KTogUHJvbWlzZTxXb3Jrb3V0IHwgbnVsbD4ge1xuICAgIGlmICghdXNlcklkKSB0aHJvdyBuZXcgRXJyb3IoJ05vIHVzZXIgSUQgcHJvdmlkZWQnKTtcbiAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICBcbiAgICAgIGNvbnN0IGNsZWFuV29ya291dCA9IG5ldyBXb3Jrb3V0KHtcbiAgICAgICAgLi4ud29ya291dCxcbiAgICAgICAgcm91bmRXb3Jrb3V0SWQ6IGAke3dvcmtvdXQuaWR9LSR7Y3VycmVudERhdGUuZ2V0VGltZSgpfWAsXG4gICAgICAgIHdvcmtvdXRTdGF0dXM6IFdvcmtvdXRTdGF0dXMuUXVldWVkVXAsXG4gICAgICAgIGNyZWF0ZWRBdDogY3VycmVudERhdGUsXG4gICAgICAgIHVwZGF0ZWRBdDogY3VycmVudERhdGUsXG4gICAgICAgIHN0YXJ0VGltZTogY3VycmVudERhdGUsXG4gICAgICAgIGxvZ3M6IFtdXG4gICAgICAgfSk7XG4gICBcbiAgICAgIGNvbnN0IHdvcmtvdXRTZXNzaW9uUmVmID0gZG9jKGNvbGxlY3Rpb24oZGIsICd1c2VycycsIHVzZXJJZCwgJ3dvcmtvdXRTZXNzaW9ucycpKTtcbiAgICAgIGF3YWl0IHNldERvYyh3b3Jrb3V0U2Vzc2lvblJlZiwgY2xlYW5Xb3Jrb3V0LnRvRGljdGlvbmFyeSgpKTtcbiAgIFxuICAgICAgY29uc3QgbG9nc1JlZiA9IGNvbGxlY3Rpb24od29ya291dFNlc3Npb25SZWYsICdsb2dzJyk7XG4gICAgICBjb25zdCBsb2dCYXRjaCA9IHdyaXRlQmF0Y2goZGIpO1xuICAgXG4gICAgICBsb2dzLmZvckVhY2goKGxvZywgaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgbG9nRG9jUmVmID0gZG9jKGxvZ3NSZWYsIGAke2xvZy5pZH0tJHtjdXJyZW50RGF0ZS5nZXRUaW1lKCl9YCk7XG4gICAgICAgIGxvZ0JhdGNoLnNldChsb2dEb2NSZWYsIHtcbiAgICAgICAgICBpZDogbG9nRG9jUmVmLmlkLFxuICAgICAgICAgIHdvcmtvdXRJZDogd29ya291dFNlc3Npb25SZWYuaWQsXG4gICAgICAgICAgZXhlcmNpc2U6IGxvZy5leGVyY2lzZS50b0RpY3Rpb25hcnkoKSwgLy8gY29udmVydCB0aGUgY3VzdG9tIEV4ZXJjaXNlIG9iamVjdFxuICAgICAgICAgIG9yZGVyOiBpbmRleCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IGN1cnJlbnREYXRlLmdldFRpbWUoKSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IGN1cnJlbnREYXRlLmdldFRpbWUoKSxcbiAgICAgICAgICBsb2dTdWJtaXR0ZWQ6IGZhbHNlLFxuICAgICAgICAgIGlzQ29tcGxldGVkOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgIH0pOyBcbiAgIFxuICAgICAgYXdhaXQgbG9nQmF0Y2guY29tbWl0KCk7XG4gICAgICBcbiAgICAgIHJldHVybiBjbGVhbldvcmtvdXQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyB3b3Jrb3V0IHNlc3Npb246JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgfVxuXG4gIC8qKlxuICAgKiBFeGFtcGxlIFwiam9pbiBjaGFsbGVuZ2VcIiBtZXRob2QgdXNpbmcgdGhlIGNsaWVudCBTREsgKG5vIGFkbWluIHByaXZpbGVnZXMpLlxuICAgKiBUaGlzIGNyZWF0ZXMgYSBkb2MgaW4gYHVzZXItY2hhbGxlbmdlYCB3aXRoIHRoZSB1c2VySWQsIGNoYWxsZW5nZUlkLCBldGMuXG4gICAqL1xuICBhc3luYyBqb2luQ2hhbGxlbmdlKHtcbiAgICB1c2VybmFtZSxcbiAgICBjaGFsbGVuZ2VJZFxuICB9OiB7XG4gICAgdXNlcm5hbWU6IHN0cmluZztcbiAgICBjaGFsbGVuZ2VJZDogc3RyaW5nO1xuICB9KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gMSkgTWFrZSBzdXJlIHdlIGhhdmUgYSBzaWduZWQtaW4gdXNlclxuICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gdXNlclNlcnZpY2UuY3VycmVudFVzZXI7XG4gICAgaWYgKCFjdXJyZW50VXNlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB1c2VyIGlzIHNpZ25lZCBpbicpO1xuICAgIH1cblxuICAgIC8vIDIpIEZpbmQgdGhlIHVzZXIgZG9jIGJ5IHVzZXJuYW1lXG4gICAgY29uc3QgdXNlcnNSZWYgPSBjb2xsZWN0aW9uKGRiLCAndXNlcnMnKTtcbiAgICBjb25zdCB1c2VyUXVlcnkgPSBxdWVyeSh1c2Vyc1JlZiwgd2hlcmUoJ3VzZXJuYW1lJywgJz09JywgdXNlcm5hbWUpKTtcbiAgICBjb25zdCB1c2VyU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHVzZXJRdWVyeSk7XG5cbiAgICBpZiAodXNlclNuYXBzaG90LmVtcHR5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VzZXIgbm90IGZvdW5kJyk7XG4gICAgfVxuXG4gICAgY29uc3QgdXNlckRvYyA9IHVzZXJTbmFwc2hvdC5kb2NzWzBdO1xuICAgIGNvbnN0IHVzZXJEYXRhID0gdXNlckRvYy5kYXRhKCk7XG4gICAgY29uc3QgdXNlcklkID0gdXNlckRvYy5pZDtcblxuICAgIC8vIDMpIENoZWNrIGlmIHRoZSBjaGFsbGVuZ2UgZG9jIGV4aXN0c1xuICAgIGNvbnN0IGNoYWxsZW5nZVJlZiA9IGRvYyhkYiwgJ3N3ZWF0bGlzdC1jb2xsZWN0aW9uJywgY2hhbGxlbmdlSWQpO1xuICAgIGNvbnN0IGNoYWxsZW5nZVNuYXAgPSBhd2FpdCBnZXREb2MoY2hhbGxlbmdlUmVmKTtcblxuICAgIGlmICghY2hhbGxlbmdlU25hcC5leGlzdHMoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDaGFsbGVuZ2Ugbm90IGZvdW5kJyk7XG4gICAgfVxuXG4gICAgY29uc3QgY2hhbGxlbmdlID0gY2hhbGxlbmdlU25hcC5kYXRhKCk7XG5cbiAgICAvLyA0KSBCdWlsZCBuZXcgdXNlci1jaGFsbGVuZ2UgZG9jdW1lbnRcbiAgICBjb25zdCB1c2VyQ2hhbGxlbmdlSWQgPSBgJHtjaGFsbGVuZ2VJZH0tJHt1c2VySWR9LSR7RGF0ZS5ub3coKX1gO1xuICAgIGNvbnN0IHVzZXJDaGFsbGVuZ2VEYXRhID0ge1xuICAgICAgaWQ6IHVzZXJDaGFsbGVuZ2VJZCxcbiAgICAgIGNoYWxsZW5nZTogY2hhbGxlbmdlLFxuICAgICAgY2hhbGxlbmdlSWQsXG4gICAgICB1c2VySWQsXG4gICAgICBmY21Ub2tlbjogdXNlckRhdGEuZmNtVG9rZW4gfHwgJycsXG4gICAgICBwcm9maWxlSW1hZ2U6IHVzZXJEYXRhLnByb2ZpbGVJbWFnZSB8fCB7fSxcbiAgICAgIHByb2dyZXNzOiAwLFxuICAgICAgY29tcGxldGVkV29ya291dHM6IFtdLFxuICAgICAgaXNDb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgdWlkOiB1c2VySWQsXG4gICAgICBsb2NhdGlvbjogdXNlckRhdGEubG9jYXRpb24gfHwgbnVsbCxcbiAgICAgIGNpdHk6ICcnLFxuICAgICAgY291bnRyeTogJycsXG4gICAgICB0aW1lem9uZTogJycsXG4gICAgICB1c2VybmFtZSxcbiAgICAgIGpvaW5EYXRlOiBuZXcgRGF0ZSgpLFxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgcHVsc2VQb2ludHM6IHtcbiAgICAgICAgYmFzZUNvbXBsZXRpb246IDAsXG4gICAgICAgIGZpcnN0Q29tcGxldGlvbjogMCxcbiAgICAgICAgc3RyZWFrQm9udXM6IDAsXG4gICAgICAgIGNoZWNrSW5Cb251czogMCxcbiAgICAgICAgZWZmb3J0UmF0aW5nOiAwLFxuICAgICAgICBjaGF0UGFydGljaXBhdGlvbjogMCxcbiAgICAgICAgbG9jYXRpb25DaGVja2luOiAwLFxuICAgICAgICBjb250ZW50RW5nYWdlbWVudDogMCxcbiAgICAgICAgZW5jb3VyYWdlbWVudFNlbnQ6IDAsXG4gICAgICAgIGVuY291cmFnZW1lbnRSZWNlaXZlZDogMFxuICAgICAgfSxcbiAgICAgIGN1cnJlbnRTdHJlYWs6IDAsXG4gICAgICBlbmNvdXJhZ2VkVXNlcnM6IFtdLFxuICAgICAgZW5jb3VyYWdlZEJ5VXNlcnM6IFtdLFxuICAgICAgY2hlY2tJbnM6IFtdXG4gICAgfTtcblxuICAgIC8vIDUpIFN0b3JlIHVzZXItY2hhbGxlbmdlIGRvY1xuICAgIGF3YWl0IHNldERvYyhkb2MoZGIsICd1c2VyLWNoYWxsZW5nZScsIHVzZXJDaGFsbGVuZ2VJZCksIHVzZXJDaGFsbGVuZ2VEYXRhKTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3Qgd29ya291dFNlcnZpY2UgPSBuZXcgV29ya291dFNlcnZpY2UoKTsiXSwibmFtZXMiOlsiY29sbGVjdGlvbiIsImRvYyIsImdldERvY3MiLCJnZXREb2MiLCJ1cGRhdGVEb2MiLCJxdWVyeSIsIndoZXJlIiwib3JkZXJCeSIsImZzQ29sbGVjdGlvbiIsInNldERvYyIsImRlbGV0ZURvYyIsIndyaXRlQmF0Y2giLCJkYiIsInVzZXJTZXJ2aWNlIiwiRXhlcmNpc2VMb2ciLCJFeGVyY2lzZSIsIkV4ZXJjaXNlVmlkZW8iLCJleGVyY2lzZVNlcnZpY2UiLCJVc2VyIiwiV29ya291dCIsIkJvZHlab25lIiwiSW50cm9WaWRlbyIsIlJlcHNBbmRXZWlnaHRMb2ciLCJXb3Jrb3V0U3RhdHVzIiwiU3dlYXRsaXN0Q29sbGVjdGlvbiIsImZvcm1hdCIsImNvbnZlcnRUaW1lc3RhbXAiLCJjb252ZXJ0RmlyZXN0b3JlVGltZXN0YW1wIiwiQ2hhbGxlbmdlIiwiVXNlckNoYWxsZW5nZSIsInN0b3JlIiwic2V0Q3VycmVudFdvcmtvdXQiLCJzZXRDdXJyZW50RXhlcmNpc2VMb2dzIiwicmVzZXRXb3Jrb3V0U3RhdGUiLCJzZXRXb3Jrb3V0U3VtbWFyeSIsIldvcmtvdXRTZXJ2aWNlIiwiZ2VuZXJhdGVJZCIsImlkIiwiZm9ybWF0V29ya291dEFuZEluaXRpYWxpemVMb2dzIiwiZXhlcmNpc2VEZXRhaWxzIiwid29ya291dEF1dGhvciIsIndvcmtJZCIsImV4ZXJjaXNlUmVmZXJlbmNlcyIsImV4ZXJjaXNlTG9ncyIsInZhbGlkRXhlcmNpc2VEZXRhaWxzIiwibmV3V29ya291dCIsImZpbHRlciIsImRldGFpbCIsImV4ZXJjaXNlIiwiZm9yRWFjaCIsImluZGV4IiwiY2F0ZWdvcnkiLCJleGVyY2lzZUluc3RhbmNlIiwid29ya291dFNlcnZpY2UiLCJuYW1lIiwiYXV0aG9yIiwidXNlcklkIiwidXNlcm5hbWUiLCJkZXNjcmlwdGlvbiIsInR5cGUiLCJkZXRhaWxzIiwicHJpbWFyeUJvZHlQYXJ0cyIsInNlY29uZGFyeUJvZHlQYXJ0cyIsInRhZ3MiLCJ2aWRlb3MiLCJjcmVhdGVkQXQiLCJEYXRlIiwidXBkYXRlZEF0IiwiZXhlcmNpc2VSZWYiLCJncm91cElkIiwicHVzaCIsInNldHMiLCJyZXBzIiwid2VpZ2h0Iiwic2NyZWVuVGltZSIsInNldHNMb2dzIiwiQXJyYXkiLCJmcm9tIiwibGVuZ3RoIiwicGFyc2VJbnQiLCJleGVyY2lzZUxvZ0lkIiwiZ2VuZXJhdGVFeGVyY2lzZUxvZ0lEIiwiY3VycmVudFVzZXIiLCJsb2ciLCJ3b3Jrb3V0SWQiLCJsb2dzIiwiZmVlZGJhY2siLCJub3RlIiwibm90ZXMiLCJpc1NwbGl0IiwibG9nU3VibWl0dGVkIiwibG9nSXNFZGl0aW5nIiwiaXNDb21wbGV0ZWQiLCJvcmRlciIsImNvbXBsZXRlZEF0Iiwicm91bmRXb3Jrb3V0SWQiLCJleGVyY2lzZXMiLCJ0aXRsZSIsImR1cmF0aW9uIiwiZXN0aW1hdGVkRHVyYXRpb24iLCJ3b3Jrb3V0UmF0aW5nIiwidXNlQXV0aG9yQ29udGVudCIsIndvcmtvdXRTdGF0dXMiLCJ6b25lIiwiZGV0ZXJtaW5lV29ya291dFpvbmUiLCJ3b3Jrb3V0IiwiZ2V0VXNlckJ5SWQiLCJ1c2VyRG9jIiwiZXJyb3IiLCJleGlzdHMiLCJFcnJvciIsImRhdGEiLCJjb25zb2xlIiwicmV2ZXJ0QXV0aG9yRm9ybWF0IiwiYXV0aG9ySWQiLCJ3b3Jrb3V0UmVmIiwidXBkYXRlV29ya291dCIsImJhdGNoIiwibG9nc1JlZiIsInRvRGljdGlvbmFyeSIsIm1lcmdlIiwibG9nUmVmIiwic2V0IiwiY29tbWl0IiwiZmV0Y2hDdXJyZW50V29ya291dCIsInNlc3Npb24iLCJmZXRjaEN1cnJlbnRXb3Jrb3V0U2Vzc2lvbiIsImdldEFsbFN3ZWF0bGlzdHMiLCJ3b3Jrb3V0c1JlZiIsImV4ZXJjaXNlc1dpdGhWaWRlb3MiLCJ3b3Jrb3V0c1NuYXBzaG90Iiwid29ya291dHMiLCJ3b3Jrb3V0RG9jIiwid29ya291dERhdGEiLCJtYXBwZWRFeGVyY2lzZXMiLCJsb2dzU25hcHNob3QiLCJmaXJlc3RvcmVFcnJvciIsImZldGNoQW5kTWFwRXhlcmNpc2VzV2l0aFZpZGVvcyIsImRvY3MiLCJtYXAiLCJmdWxsRXhlcmNpc2UiLCJmaW5kIiwiZXgiLCJjb2xsZWN0aW9uSWQiLCJjaGFsbGVuZ2UiLCJzdGFydFRpbWUiLCJ1bmRlZmluZWQiLCJsb2dEb2MiLCJtZXNzYWdlIiwiZ2V0VXNlckNoYWxsZW5nZXNCeUNoYWxsZW5nZUlkIiwiY2hhbGxlbmdlSWQiLCJ1c2VyQ2hhbGxlbmdlc1JlZiIsInEiLCJzbmFwc2hvdCIsInVzZXJDaGFsbGVuZ2VzIiwiZmV0Y2hXb3Jrb3V0U3VtbWFyaWVzIiwiZGF0ZSIsImZvcm1hdHRlZERhdGUiLCJzdW1tYXJpZXNSZWYiLCJmZXRjaEFsbFdvcmtvdXRTdW1tYXJpZXMiLCJmZXRjaFVzZXJDaGFsbGVuZ2VzQnlVc2VySWQiLCJzdWJ0aXRsZSIsInBhcnRpY2lwYW50cyIsInN0YXR1cyIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJpbnRyb1ZpZGVvcyIsInYiLCJ2aWRlb1VybCIsImZldGNoQ29sbGVjdGlvbldpdGhTd2VhdExpc3RzIiwic3dlYXRMaXN0cyIsInN3ZWF0bGlzdElkZW50aWZpZXIiLCJnZXRDb2xsZWN0aW9uQnlJZCIsInN3ZWF0bGlzdElkcyIsImZldGNoU2F2ZWRXb3Jrb3V0Iiwic3dlYXRsaXN0QXV0aG9ySWQiLCJ3b3Jrb3V0U25hcCIsInNpemUiLCJsb2dEYXRhIiwiZXhlcmNpc2VOYW1lIiwiZXhlcmNpc2VDYXRlZ29yeSIsInVwZGF0ZWRFeGVyY2lzZSIsInJlY29tbWVuZGVkV2VpZ2h0IiwiaXNCb2R5V2VpZ2h0IiwiZmV0Y2hVc2VyQ2hhbGxlbmdlc0J5Q2hhbGxlbmdlSWQiLCJkb2NSZWYiLCJkb2NTbmFwIiwiZmV0Y2hDb2xsZWN0aW9ucyIsImNvbGxlY3Rpb25zUmVmIiwicUFycmF5Iiwic25hcHNob3RBcnJheSIsImNvbGxlY3Rpb25zRnJvbUFycmF5IiwicVN0cmluZyIsInNuYXBzaG90U3RyaW5nIiwiY29sbGVjdGlvbnNGcm9tU3RyaW5nIiwiY29tYmluZWQiLCJ1bmlxdWVDb2xsZWN0aW9ucyIsIk1hcCIsInZhbHVlcyIsImZldGNoQWN0aXZlQ2hhbGxlbmdlcyIsImFsbENoYWxsZW5nZXMiLCJhY3RpdmVDaGFsbGVuZ2VzIiwidXNlckNoYWxsZW5nZSIsImZldGNoVXNlckNoYWxsZW5nZXMiLCJ1cGRhdGVXb3Jrb3V0U3VtbWFyeSIsInN1bW1hcnkiLCJzdW1tYXJ5UmVmIiwic3VtbWFyeURhdGEiLCJib2R5UGFydHMiLCJ3b3Jrb3V0VGl0bGUiLCJjYWxvcmllc0J1cm5lZCIsImV4ZXJjaXNlc0NvbXBsZXRlZCIsImFpSW5zaWdodCIsInJlY29tbWVuZGF0aW9ucyIsImdpZlVSTHMiLCJyZWNvbW1lbmRlZFdvcmsiLCJ1cGRhdGVXb3Jrb3V0TG9ncyIsImxvZ0RvY1JlZiIsInVwZGF0ZSIsImNhbmNlbFdvcmtvdXQiLCJ3b3Jrb3V0U3VtbWFyeSIsImRlbGV0ZVdvcmtvdXRTZXNzaW9uIiwiZGVsZXRlV29ya291dFN1bW1hcnkiLCJjbGVhblVwV29ya291dEluUHJvZ3Jlc3MiLCJkZWxldGUiLCJyZWYiLCJ3b3Jrb3V0U3VtbWFyeUlkIiwiZGlzcGF0Y2giLCJleGVyY2lzZVNuYXBzaG90IiwidmlkZW9TbmFwc2hvdCIsImV4ZXJjaXNlVmlkZW9zIiwid29ya291dFNlc3Npb25zUmVmIiwic25hcCIsIm1hdGNoaW5nVmlkZW9zIiwidmlkZW8iLCJ0b0xvd2VyQ2FzZSIsIlF1ZXVlZFVwIiwiZW1wdHkiLCJwcm9jZXNzV29ya291dFNlc3Npb25Eb2N1bWVudCIsIkluUHJvZ3Jlc3MiLCJmZXRjaEFsbFdvcmtvdXRTZXNzaW9ucyIsInNlc3Npb25zIiwiUHJvbWlzZSIsImFsbCIsInNlc3Npb25EYXRhIiwic29ydCIsImEiLCJiIiwib3JkZXJBIiwib3JkZXJCIiwidXBkYXRlQ29sbGVjdGlvbiIsImNvbGxSZWYiLCJuZXdEb2NSZWYiLCJ0cmltIiwiZXhlcmNpc2VOYW1lTG93ZXIiLCJBcmNoaXZlZCIsIkZ1bGxCb2R5IiwicHJlcGFyZWRMb2dEYXRhIiwic2F2ZVdvcmtvdXRTZXNzaW9uIiwiY3VycmVudERhdGUiLCJjbGVhbldvcmtvdXQiLCJ3b3Jrb3V0U2Vzc2lvblJlZiIsImxvZ0JhdGNoIiwiZ2V0VGltZSIsImpvaW5DaGFsbGVuZ2UiLCJ1c2Vyc1JlZiIsInVzZXJRdWVyeSIsInVzZXJTbmFwc2hvdCIsInVzZXJEYXRhIiwiY2hhbGxlbmdlUmVmIiwiY2hhbGxlbmdlU25hcCIsInVzZXJDaGFsbGVuZ2VJZCIsInVzZXJDaGFsbGVuZ2VEYXRhIiwibm93IiwiZmNtVG9rZW4iLCJwcm9maWxlSW1hZ2UiLCJwcm9ncmVzcyIsImNvbXBsZXRlZFdvcmtvdXRzIiwidWlkIiwibG9jYXRpb24iLCJjaXR5IiwiY291bnRyeSIsInRpbWV6b25lIiwiam9pbkRhdGUiLCJwdWxzZVBvaW50cyIsImJhc2VDb21wbGV0aW9uIiwiZmlyc3RDb21wbGV0aW9uIiwic3RyZWFrQm9udXMiLCJjaGVja0luQm9udXMiLCJlZmZvcnRSYXRpbmciLCJjaGF0UGFydGljaXBhdGlvbiIsImxvY2F0aW9uQ2hlY2tpbiIsImNvbnRlbnRFbmdhZ2VtZW50IiwiZW5jb3VyYWdlbWVudFNlbnQiLCJlbmNvdXJhZ2VtZW50UmVjZWl2ZWQiLCJjdXJyZW50U3RyZWFrIiwiZW5jb3VyYWdlZFVzZXJzIiwiZW5jb3VyYWdlZEJ5VXNlcnMiLCJjaGVja0lucyIsImN1cnJlbnRXb3Jrb3V0IiwiZ2V0U3RhdGUiLCJjdXJyZW50V29ya291dExvZ3MiLCJjdXJyZW50RXhlcmNpc2VMb2dzIiwiY3VycmVudFdvcmtvdXRTdW1tYXJ5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/api/firebase/workout/service.ts\n"));

/***/ })

});
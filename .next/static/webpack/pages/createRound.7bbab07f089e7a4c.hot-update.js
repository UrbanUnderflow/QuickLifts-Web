"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("pages/createRound",{

/***/ "./src/api/firebase/gemini/service.ts":
/*!********************************************!*\
  !*** ./src/api/firebase/gemini/service.ts ***!
  \********************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GeminiService: function() { return /* binding */ GeminiService; }\n/* harmony export */ });\n/* harmony import */ var _swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @swc/helpers/_/_async_to_generator */ \"./node_modules/@swc/helpers/esm/_async_to_generator.js\");\n/* harmony import */ var _swc_helpers_class_call_check__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @swc/helpers/_/_class_call_check */ \"./node_modules/@swc/helpers/esm/_class_call_check.js\");\n/* harmony import */ var _swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @swc/helpers/_/_ts_generator */ \"./node_modules/@swc/helpers/esm/_ts_generator.js\");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../config */ \"./src/api/firebase/config.ts\");\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! firebase/firestore */ \"./node_modules/firebase/firestore/dist/esm/index.esm.js\");\n// services/GeminiService.ts\n\n\n\n\n\nvar GeminiService = /*#__PURE__*/ function() {\n    \"use strict\";\n    function GeminiService() {\n        (0,_swc_helpers_class_call_check__WEBPACK_IMPORTED_MODULE_2__._)(this, GeminiService);\n    }\n    var _proto = GeminiService.prototype;\n    _proto.sendPrompt = function sendPrompt(prompt) {\n        var _this = this;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_3__._)(function() {\n            var generateRef, response, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_4__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        _state.trys.push([\n                            0,\n                            3,\n                            ,\n                            4\n                        ]);\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.collection)(_config__WEBPACK_IMPORTED_MODULE_0__.db, \"generate\"), {\n                                prompt: prompt\n                            })\n                        ];\n                    case 1:\n                        generateRef = _state.sent();\n                        console.log(\"Generated prompt document ID:\", generateRef.id);\n                        return [\n                            4,\n                            _this.fetchOutputWithRetry(generateRef, 30, 2000)\n                        ];\n                    case 2:\n                        response = _state.sent();\n                        return [\n                            2,\n                            response\n                        ];\n                    case 3:\n                        error = _state.sent();\n                        console.error(\"Error sending prompt:\", error);\n                        throw error;\n                    case 4:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.fetchOutputWithRetry = function fetchOutputWithRetry(docRef, attempts, delay) {\n        var _this = this;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_3__._)(function() {\n            var snapshot, data;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_4__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        if (attempts === 0) {\n                            throw new Error(\"Max retry attempts reached\");\n                        }\n                        return [\n                            4,\n                            (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.getDoc)(docRef)\n                        ];\n                    case 1:\n                        snapshot = _state.sent();\n                        data = snapshot.data();\n                        if (data === null || data === void 0 ? void 0 : data.output) {\n                            return [\n                                2,\n                                data.output\n                            ];\n                        }\n                        return [\n                            4,\n                            new Promise(function(resolve) {\n                                return setTimeout(resolve, delay);\n                            })\n                        ];\n                    case 2:\n                        _state.sent();\n                        return [\n                            2,\n                            _this.fetchOutputWithRetry(docRef, attempts - 1, delay)\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.generateRound = function generateRound(mustIncludeExercises, userPrompt, preferences, creatorExercises, allAvailableExercises, startDate, endDate) {\n        var _this = this;\n        return (0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_3__._)(function() {\n            var numberOfWorkouts, mustIncludeList, creatorExerciseList, allExerciseList, prompt, response, jsonString, parsedResponse, error;\n            return (0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_4__._)(this, function(_state) {\n                switch(_state.label){\n                    case 0:\n                        // Calculate the number of workouts based on date range\n                        numberOfWorkouts = _this.calculateNumberOfWorkouts(startDate, endDate);\n                        // Combine all available exercises\n                        mustIncludeList = mustIncludeExercises.join(\", \");\n                        creatorExerciseList = creatorExercises.map(function(ex) {\n                            return ex.name;\n                        }).join(\", \");\n                        allExerciseList = allAvailableExercises.map(function(ex) {\n                            return ex.name;\n                        }).join(\", \");\n                        prompt = \"\\nYou are a JSON-generating fitness AI. Return PURE JSON only.\\n\\nPROGRAM REQUIREMENTS:\\n- \".concat(numberOfWorkouts, \" total workouts from \").concat(startDate.toLocaleDateString(), \" to \").concat(endDate.toLocaleDateString(), \"\\n- 4-5 exercises per workout (no more than 5)\\n- Use only exercises from these lists:\\n  Must include: \").concat(mustIncludeList, \"\\n  Prefer creator exercises: \").concat(creatorExerciseList, \"\\n  Other available: \").concat(allExerciseList, \"\\n\\nUSER PREFERENCES:\\n\").concat(userPrompt, \"\\n\").concat(preferences.join(\"\\n\"), '\\n\\nRESPONSE FORMAT:\\n{\\n  \"stacks\": [\\n    {\\n      \"title\": \"Workout Title\",\\n      \"description\": \"Brief description\",\\n      \"exercises\": [\\n        {\\n          \"name\": \"Exercise Name\",\\n          \"category\": {\\n            \"type\": \"weightTraining\",\\n            \"details\": {\\n              \"sets\": 3,\\n              \"reps\": [\"8\",\"10\"],\\n              \"weight\": 0,\\n              \"screenTime\": 0\\n            }\\n          }\\n        }\\n      ]\\n    }\\n  ]\\n}\\n\\nRULES:\\n- Return ONLY valid JSON\\n- No comments or markdown\\n- Exactly ').concat(numberOfWorkouts, \" stacks\\n- Only use listed exercises\\n- Keep descriptions under 100 characters\");\n                        console.log(\"Generating program with\", numberOfWorkouts, \"workouts\");\n                        _state.label = 1;\n                    case 1:\n                        _state.trys.push([\n                            1,\n                            3,\n                            ,\n                            4\n                        ]);\n                        return [\n                            4,\n                            _this.sendPrompt(prompt)\n                        ];\n                    case 2:\n                        response = _state.sent();\n                        // Clean and sanitize the response\n                        jsonString = response.replace(/```json/g, \"\").replace(/```/g, \"\").replace(/[\\u201C\\u201D]/g, '\"').replace(/&quot;/g, '\"').replace(/\\n/g, \"\").replace(/\\r/g, \"\").replace(/\\t/g, \"\").replace(/\\\\/g, \"\").trim();\n                        if (!jsonString.startsWith(\"{\") || !jsonString.endsWith(\"}\")) {\n                            throw new Error(\"Invalid JSON structure\");\n                        }\n                        try {\n                            parsedResponse = JSON.parse(jsonString);\n                            if (!parsedResponse.stacks || !Array.isArray(parsedResponse.stacks)) {\n                                throw new Error(\"Invalid response structure - missing stacks array\");\n                            }\n                            // Verify we got the correct number of workouts\n                            if (parsedResponse.stacks.length !== numberOfWorkouts) {\n                                throw new Error(\"Expected \".concat(numberOfWorkouts, \" stacks, but got \").concat(parsedResponse.stacks.length));\n                            }\n                            parsedResponse.stacks.forEach(function(stack, index) {\n                                if (!stack.title || !stack.description || !Array.isArray(stack.exercises)) {\n                                    throw new Error(\"Invalid stack structure at index \".concat(index));\n                                }\n                                stack.exercises.forEach(function(exercise, exIndex) {\n                                    var _exercise_category_details, _exercise_category;\n                                    if (!exercise.name || !((_exercise_category = exercise.category) === null || _exercise_category === void 0 ? void 0 : (_exercise_category_details = _exercise_category.details) === null || _exercise_category_details === void 0 ? void 0 : _exercise_category_details.reps)) {\n                                        throw new Error(\"Invalid exercise structure at stack \".concat(index, \", exercise \").concat(exIndex));\n                                    }\n                                });\n                            });\n                            return [\n                                2,\n                                parsedResponse\n                            ];\n                        } catch (parseError) {\n                            console.error(\"JSON Parse Error:\", parseError);\n                            console.error(\"Raw Response:\", response);\n                            console.error(\"Cleaned Response:\", jsonString);\n                            throw new Error(\"Failed to parse AI response\");\n                        }\n                        return [\n                            3,\n                            4\n                        ];\n                    case 3:\n                        error = _state.sent();\n                        console.error(\"Generation Error:\", error);\n                        throw new Error(\"Failed to generate workout round\");\n                    case 4:\n                        return [\n                            2\n                        ];\n                }\n            });\n        })();\n    };\n    _proto.calculateNumberOfWorkouts = function calculateNumberOfWorkouts(startDate, endDate) {\n        // Calculate the difference in days\n        var msPerDay = 1000 * 60 * 60 * 24;\n        var diffInMs = endDate.getTime() - startDate.getTime();\n        var days = Math.ceil(diffInMs / msPerDay);\n        // Add 1 to include both start and end dates\n        return days + 1;\n    };\n    GeminiService.getInstance = function getInstance() {\n        if (!GeminiService.instance) {\n            GeminiService.instance = new GeminiService();\n        }\n        return GeminiService.instance;\n    };\n    return GeminiService;\n}();\n/* harmony default export */ __webpack_exports__[\"default\"] = (GeminiService);\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXBpL2ZpcmViYXNlL2dlbWluaS9zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLDRCQUE0Qjs7OztBQUVHO0FBQ29EO0FBMkI1RSxrQ0FBSzs7YUFBQ0k7K0VBQUFBOztpQkFBQUE7SUFZWCxPQUFjQyxVQWFiLEdBYkQsU0FBY0EsV0FBV0MsTUFBYzs7ZUFBdkM7Z0JBRVVDLGFBS0FDLFVBRUNDOzs7Ozs7Ozs7O3dCQVBhOzs0QkFBTVAsMERBQU1BLENBQUNELDhEQUFVQSxDQUFDRCx1Q0FBRUEsRUFBRSxhQUFhO2dDQUMzRE0sUUFBUUE7NEJBQ1Y7Ozt3QkFGTUMsY0FBYzt3QkFJcEJHLFFBQVFDLEdBQUcsQ0FBQyxpQ0FBaUNKLFlBQVlLLEVBQUU7d0JBQzFDOzs0QkFBTSxNQUFLQyxvQkFBb0IsQ0FBQ04sYUFBYSxJQUFJOzs7d0JBQTVEQyxXQUFXO3dCQUNqQjs7NEJBQU9BOzs7d0JBQ0FDO3dCQUNQQyxRQUFRRCxLQUFLLENBQUMseUJBQXlCQTt3QkFDdkMsTUFBTUE7Ozs7Ozs7UUFFVjs7SUFFQSxPQUFjSSxvQkFrQmIsR0FsQkQsU0FBY0EscUJBQ1pDLE1BQXlCLEVBQ3pCQyxRQUFnQixFQUNoQkMsS0FBYTs7ZUFIZjtnQkFTUUMsVUFDQUM7Ozs7d0JBTE4sSUFBSUgsYUFBYSxHQUFHOzRCQUNsQixNQUFNLElBQUlJLE1BQU07d0JBQ2xCO3dCQUVpQjs7NEJBQU1oQiwwREFBTUEsQ0FBQ1c7Ozt3QkFBeEJHLFdBQVc7d0JBQ1hDLE9BQU9ELFNBQVNDLElBQUk7d0JBRTFCLElBQUlBLGlCQUFBQSwyQkFBQUEsS0FBTUUsTUFBTSxFQUFFOzRCQUNoQjs7Z0NBQU9GLEtBQUtFLE1BQU07O3dCQUNwQjt3QkFFQTs7NEJBQU0sSUFBSUMsUUFBUUMsU0FBQUE7dUNBQVdDLFdBQVdELFNBQVNOOzs7O3dCQUFqRDt3QkFDQTs7NEJBQU8sTUFBS0gsb0JBQW9CLENBQUNDLFFBQVFDLFdBQVcsR0FBR0M7Ozs7UUFDekQ7O0lBRUEsT0FB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TCxPQUFNLGVBQXFCLE9BQVJLO29DQUM1RTtnQ0FDRjs0QkFDRjs0QkFFQTs7Z0NBQU94Qjs7d0JBQ1QsRUFBRSxPQUFPNEIsWUFBWTs0QkFDbkJ2RCxRQUFRRCxLQUFLLENBQUMscUJBQXFCd0Q7NEJBQ25DdkQsUUFBUUQsS0FBSyxDQUFDLGlCQUFpQkQ7NEJBQy9CRSxRQUFRRCxLQUFLLENBQUMscUJBQXFCMkI7NEJBQ25DLE1BQU0sSUFBSWpCLE1BQU07d0JBQ2xCOzs7Ozs7d0JBQ09WO3dCQUNQQyxRQUFRRCxLQUFLLENBQUMscUJBQXFCQTt3QkFDbkMsTUFBTSxJQUFJVSxNQUFNOzs7Ozs7O1FBRXBCOztJQUVBLE9BQVFtQix5QkFRUCxHQVJELFNBQVFBLDBCQUEwQlIsU0FBZSxFQUFFQyxPQUFhO1FBQzlELG1DQUFtQztRQUNuQyxJQUFNbUMsV0FBVyxPQUFPLEtBQUssS0FBSztRQUNsQyxJQUFNQyxXQUFXcEMsUUFBUXFDLE9BQU8sS0FBS3RDLFVBQVVzQyxPQUFPO1FBQ3RELElBQU1DLE9BQU9DLEtBQUtDLElBQUksQ0FBQ0osV0FBV0Q7UUFFbEMsNENBQTRDO1FBQzVDLE9BQU9HLE9BQU87SUFDaEI7SUEvS1dqRSxjQUtHb0UsV0FLYixHQUxELFNBQWNBO1FBQ1osSUFBSSxDQUFDcEUsY0FBY3FFLFFBQVEsRUFBRTtZQU5wQnJFLGNBT09xRSxRQUFRLEdBQUcsSUFQbEJyRTtRQVFUO1FBQ0EsT0FBT0EsY0FBY3FFLFFBQVE7SUFDL0I7V0FWV3JFO0lBaUxaO0FBRUQsK0RBQWVBLGFBQWFBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL2FwaS9maXJlYmFzZS9nZW1pbmkvc2VydmljZS50cz82ZmI1Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNlcnZpY2VzL0dlbWluaVNlcnZpY2UudHNcbmltcG9ydCB7IEV4ZXJjaXNlIH0gZnJvbSAnLi4vZXhlcmNpc2UnO1xuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi9jb25maWcnO1xuaW1wb3J0IHsgY29sbGVjdGlvbiwgYWRkRG9jLCBnZXREb2MsIERvY3VtZW50UmVmZXJlbmNlIH0gZnJvbSAnZmlyZWJhc2UvZmlyZXN0b3JlJztcblxuaW50ZXJmYWNlIEdlbmVyYXRlZEV4ZXJjaXNlIHtcbiAgbmFtZTogc3RyaW5nO1xuICBzZXRzOiBudW1iZXI7XG4gIHJlcHM6IHN0cmluZ1tdO1xuICBjYXRlZ29yeToge1xuICAgIHR5cGU6ICd3ZWlnaHRUcmFpbmluZyc7XG4gICAgZGV0YWlsczoge1xuICAgICAgc2V0czogbnVtYmVyO1xuICAgICAgcmVwczogc3RyaW5nW107XG4gICAgICB3ZWlnaHQ6IG51bWJlcjtcbiAgICAgIHNjcmVlblRpbWU6IG51bWJlcjtcbiAgICB9O1xuICB9O1xufVxuXG5pbnRlcmZhY2UgR2VuZXJhdGVkU3RhY2sge1xuICB0aXRsZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBleGVyY2lzZXM6IEdlbmVyYXRlZEV4ZXJjaXNlW107XG59XG5cbmludGVyZmFjZSBHZW5lcmF0ZWRSb3VuZFJlc3BvbnNlIHtcbiAgc3RhY2tzOiBHZW5lcmF0ZWRTdGFja1tdO1xufVxuXG5leHBvcnQgY2xhc3MgR2VtaW5pU2VydmljZSB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBHZW1pbmlTZXJ2aWNlO1xuICBcbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHt9XG5cbiAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBHZW1pbmlTZXJ2aWNlIHtcbiAgICBpZiAoIUdlbWluaVNlcnZpY2UuaW5zdGFuY2UpIHtcbiAgICAgIEdlbWluaVNlcnZpY2UuaW5zdGFuY2UgPSBuZXcgR2VtaW5pU2VydmljZSgpO1xuICAgIH1cbiAgICByZXR1cm4gR2VtaW5pU2VydmljZS5pbnN0YW5jZTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgc2VuZFByb21wdChwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGdlbmVyYXRlUmVmID0gYXdhaXQgYWRkRG9jKGNvbGxlY3Rpb24oZGIsICdnZW5lcmF0ZScpLCB7XG4gICAgICAgIHByb21wdDogcHJvbXB0XG4gICAgICB9KTtcbiAgXG4gICAgICBjb25zb2xlLmxvZygnR2VuZXJhdGVkIHByb21wdCBkb2N1bWVudCBJRDonLCBnZW5lcmF0ZVJlZi5pZCk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZmV0Y2hPdXRwdXRXaXRoUmV0cnkoZ2VuZXJhdGVSZWYsIDMwLCAyMDAwKTtcbiAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2VuZGluZyBwcm9tcHQ6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBmZXRjaE91dHB1dFdpdGhSZXRyeShcbiAgICBkb2NSZWY6IERvY3VtZW50UmVmZXJlbmNlLFxuICAgIGF0dGVtcHRzOiBudW1iZXIsXG4gICAgZGVsYXk6IG51bWJlclxuICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGlmIChhdHRlbXB0cyA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNYXggcmV0cnkgYXR0ZW1wdHMgcmVhY2hlZCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jKGRvY1JlZik7XG4gICAgY29uc3QgZGF0YSA9IHNuYXBzaG90LmRhdGEoKTtcblxuICAgIGlmIChkYXRhPy5vdXRwdXQpIHtcbiAgICAgIHJldHVybiBkYXRhLm91dHB1dDtcbiAgICB9XG5cbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcbiAgICByZXR1cm4gdGhpcy5mZXRjaE91dHB1dFdpdGhSZXRyeShkb2NSZWYsIGF0dGVtcHRzIC0gMSwgZGVsYXkpO1xuICB9XG5cbiAgYXN5bmMgZ2VuZXJhdGVSb3VuZChcbiAgICBtdXN0SW5jbHVkZUV4ZXJjaXNlczogc3RyaW5nW10sXG4gICAgdXNlclByb21wdDogc3RyaW5nLFxuICAgIHByZWZlcmVuY2VzOiBzdHJpbmdbXSxcbiAgICBjcmVhdG9yRXhlcmNpc2VzOiBFeGVyY2lzZVtdLFxuICAgIGFsbEF2YWlsYWJsZUV4ZXJjaXNlczogRXhlcmNpc2VbXSxcbiAgICBzdGFydERhdGU6IERhdGUsXG4gICAgZW5kRGF0ZTogRGF0ZVxuICApOiBQcm9taXNlPEdlbmVyYXRlZFJvdW5kUmVzcG9uc2U+IHtcbiAgICAvLyBDYWxjdWxhdGUgdGhlIG51bWJlciBvZiB3b3Jrb3V0cyBiYXNlZCBvbiBkYXRlIHJhbmdlXG4gICAgY29uc3QgbnVtYmVyT2ZXb3Jrb3V0cyA9IHRoaXMuY2FsY3VsYXRlTnVtYmVyT2ZXb3Jrb3V0cyhzdGFydERhdGUsIGVuZERhdGUpO1xuICAgIFxuICAgIC8vIENvbWJpbmUgYWxsIGF2YWlsYWJsZSBleGVyY2lzZXNcbiAgICBjb25zdCBtdXN0SW5jbHVkZUxpc3QgPSBtdXN0SW5jbHVkZUV4ZXJjaXNlcy5qb2luKFwiLCBcIik7XG4gICAgY29uc3QgY3JlYXRvckV4ZXJjaXNlTGlzdCA9IGNyZWF0b3JFeGVyY2lzZXMubWFwKGV4ID0+IGV4Lm5hbWUpLmpvaW4oXCIsIFwiKTtcbiAgICBjb25zdCBhbGxFeGVyY2lzZUxpc3QgPSBhbGxBdmFpbGFibGVFeGVyY2lzZXMubWFwKGV4ID0+IGV4Lm5hbWUpLmpvaW4oXCIsIFwiKTtcbiAgICBcbiAgICBjb25zdCBwcm9tcHQgPSBgXG5Zb3UgYXJlIGEgSlNPTi1nZW5lcmF0aW5nIGZpdG5lc3MgQUkuIFJldHVybiBQVVJFIEpTT04gb25seS5cblxuUFJPR1JBTSBSRVFVSVJFTUVOVFM6XG4tICR7bnVtYmVyT2ZXb3Jrb3V0c30gdG90YWwgd29ya291dHMgZnJvbSAke3N0YXJ0RGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKX0gdG8gJHtlbmREYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygpfVxuLSA0LTUgZXhlcmNpc2VzIHBlciB3b3Jrb3V0IChubyBtb3JlIHRoYW4gNSlcbi0gVXNlIG9ubHkgZXhlcmNpc2VzIGZyb20gdGhlc2UgbGlzdHM6XG4gIE11c3QgaW5jbHVkZTogJHttdXN0SW5jbHVkZUxpc3R9XG4gIFByZWZlciBjcmVhdG9yIGV4ZXJjaXNlczogJHtjcmVhdG9yRXhlcmNpc2VMaXN0fVxuICBPdGhlciBhdmFpbGFibGU6ICR7YWxsRXhlcmNpc2VMaXN0fVxuXG5VU0VSIFBSRUZFUkVOQ0VTOlxuJHt1c2VyUHJvbXB0fVxuJHtwcmVmZXJlbmNlcy5qb2luKFwiXFxuXCIpfVxuXG5SRVNQT05TRSBGT1JNQVQ6XG57XG4gIFwic3RhY2tzXCI6IFtcbiAgICB7XG4gICAgICBcInRpdGxlXCI6IFwiV29ya291dCBUaXRsZVwiLFxuICAgICAgXCJkZXNjcmlwdGlvblwiOiBcIkJyaWVmIGRlc2NyaXB0aW9uXCIsXG4gICAgICBcImV4ZXJjaXNlc1wiOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBcIm5hbWVcIjogXCJFeGVyY2lzZSBOYW1lXCIsXG4gICAgICAgICAgXCJjYXRlZ29yeVwiOiB7XG4gICAgICAgICAgICBcInR5cGVcIjogXCJ3ZWlnaHRUcmFpbmluZ1wiLFxuICAgICAgICAgICAgXCJkZXRhaWxzXCI6IHtcbiAgICAgICAgICAgICAgXCJzZXRzXCI6IDMsXG4gICAgICAgICAgICAgIFwicmVwc1wiOiBbXCI4XCIsXCIxMFwiXSxcbiAgICAgICAgICAgICAgXCJ3ZWlnaHRcIjogMCxcbiAgICAgICAgICAgICAgXCJzY3JlZW5UaW1lXCI6IDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9XG4gIF1cbn1cblxuUlVMRVM6XG4tIFJldHVybiBPTkxZIHZhbGlkIEpTT05cbi0gTm8gY29tbWVudHMgb3IgbWFya2Rvd25cbi0gRXhhY3RseSAke251bWJlck9mV29ya291dHN9IHN0YWNrc1xuLSBPbmx5IHVzZSBsaXN0ZWQgZXhlcmNpc2VzXG4tIEtlZXAgZGVzY3JpcHRpb25zIHVuZGVyIDEwMCBjaGFyYWN0ZXJzYDtcblxuICAgIGNvbnNvbGUubG9nKFwiR2VuZXJhdGluZyBwcm9ncmFtIHdpdGhcIiwgbnVtYmVyT2ZXb3Jrb3V0cywgXCJ3b3Jrb3V0c1wiKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnNlbmRQcm9tcHQocHJvbXB0KTtcblxuICAgICAgLy8gQ2xlYW4gYW5kIHNhbml0aXplIHRoZSByZXNwb25zZVxuICAgICAgbGV0IGpzb25TdHJpbmcgPSByZXNwb25zZVxuICAgICAgICAucmVwbGFjZSgvYGBganNvbi9nLCAnJylcbiAgICAgICAgLnJlcGxhY2UoL2BgYC9nLCAnJylcbiAgICAgICAgLnJlcGxhY2UoL1tcXHUyMDFDXFx1MjAxRF0vZywgJ1wiJylcbiAgICAgICAgLnJlcGxhY2UoLyZxdW90Oy9nLCAnXCInKVxuICAgICAgICAucmVwbGFjZSgvXFxuL2csICcnKVxuICAgICAgICAucmVwbGFjZSgvXFxyL2csICcnKVxuICAgICAgICAucmVwbGFjZSgvXFx0L2csICcnKVxuICAgICAgICAucmVwbGFjZSgvXFxcXC9nLCAnJylcbiAgICAgICAgLnRyaW0oKTtcblxuICAgICAgaWYgKCFqc29uU3RyaW5nLnN0YXJ0c1dpdGgoJ3snKSB8fCAhanNvblN0cmluZy5lbmRzV2l0aCgnfScpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBKU09OIHN0cnVjdHVyZScpO1xuICAgICAgfVxuXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBwYXJzZWRSZXNwb25zZSA9IEpTT04ucGFyc2UoanNvblN0cmluZyk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXBhcnNlZFJlc3BvbnNlLnN0YWNrcyB8fCAhQXJyYXkuaXNBcnJheShwYXJzZWRSZXNwb25zZS5zdGFja3MpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHJlc3BvbnNlIHN0cnVjdHVyZSAtIG1pc3Npbmcgc3RhY2tzIGFycmF5Jyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWZXJpZnkgd2UgZ290IHRoZSBjb3JyZWN0IG51bWJlciBvZiB3b3Jrb3V0c1xuICAgICAgICBpZiAocGFyc2VkUmVzcG9uc2Uuc3RhY2tzLmxlbmd0aCAhPT0gbnVtYmVyT2ZXb3Jrb3V0cykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRXhwZWN0ZWQgJHtudW1iZXJPZldvcmtvdXRzfSBzdGFja3MsIGJ1dCBnb3QgJHtwYXJzZWRSZXNwb25zZS5zdGFja3MubGVuZ3RofWApO1xuICAgICAgICB9XG5cbiAgICAgICAgcGFyc2VkUmVzcG9uc2Uuc3RhY2tzLmZvckVhY2goKHN0YWNrOiBhbnksIGluZGV4OiBudW1iZXIpID0+IHtcbiAgICAgICAgICBpZiAoIXN0YWNrLnRpdGxlIHx8ICFzdGFjay5kZXNjcmlwdGlvbiB8fCAhQXJyYXkuaXNBcnJheShzdGFjay5leGVyY2lzZXMpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgc3RhY2sgc3RydWN0dXJlIGF0IGluZGV4ICR7aW5kZXh9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHN0YWNrLmV4ZXJjaXNlcy5mb3JFYWNoKChleGVyY2lzZTogYW55LCBleEluZGV4OiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgIGlmICghZXhlcmNpc2UubmFtZSB8fCAhZXhlcmNpc2UuY2F0ZWdvcnk/LmRldGFpbHM/LnJlcHMpIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIGV4ZXJjaXNlIHN0cnVjdHVyZSBhdCBzdGFjayAke2luZGV4fSwgZXhlcmNpc2UgJHtleEluZGV4fWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcGFyc2VkUmVzcG9uc2U7XG4gICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04gUGFyc2UgRXJyb3I6JywgcGFyc2VFcnJvcik7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JhdyBSZXNwb25zZTonLCByZXNwb25zZSk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NsZWFuZWQgUmVzcG9uc2U6JywganNvblN0cmluZyk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHBhcnNlIEFJIHJlc3BvbnNlJyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0dlbmVyYXRpb24gRXJyb3I6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2VuZXJhdGUgd29ya291dCByb3VuZCcpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY2FsY3VsYXRlTnVtYmVyT2ZXb3Jrb3V0cyhzdGFydERhdGU6IERhdGUsIGVuZERhdGU6IERhdGUpOiBudW1iZXIge1xuICAgIC8vIENhbGN1bGF0ZSB0aGUgZGlmZmVyZW5jZSBpbiBkYXlzXG4gICAgY29uc3QgbXNQZXJEYXkgPSAxMDAwICogNjAgKiA2MCAqIDI0O1xuICAgIGNvbnN0IGRpZmZJbk1zID0gZW5kRGF0ZS5nZXRUaW1lKCkgLSBzdGFydERhdGUuZ2V0VGltZSgpO1xuICAgIGNvbnN0IGRheXMgPSBNYXRoLmNlaWwoZGlmZkluTXMgLyBtc1BlckRheSk7XG4gICAgXG4gICAgLy8gQWRkIDEgdG8gaW5jbHVkZSBib3RoIHN0YXJ0IGFuZCBlbmQgZGF0ZXNcbiAgICByZXR1cm4gZGF5cyArIDE7XG4gIH1cblxufVxuXG5leHBvcnQgZGVmYXVsdCBHZW1pbmlTZXJ2aWNlOyJdLCJuYW1lcyI6WyJkYiIsImNvbGxlY3Rpb24iLCJhZGREb2MiLCJnZXREb2MiLCJHZW1pbmlTZXJ2aWNlIiwic2VuZFByb21wdCIsInByb21wdCIsImdlbmVyYXRlUmVmIiwicmVzcG9uc2UiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJpZCIsImZldGNoT3V0cHV0V2l0aFJldHJ5IiwiZG9jUmVmIiwiYXR0ZW1wdHMiLCJkZWxheSIsInNuYXBzaG90IiwiZGF0YSIsIkVycm9yIiwib3V0cHV0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiZ2VuZXJhdGVSb3VuZCIsIm11c3RJbmNsdWRlRXhlcmNpc2VzIiwidXNlclByb21wdCIsInByZWZlcmVuY2VzIiwiY3JlYXRvckV4ZXJjaXNlcyIsImFsbEF2YWlsYWJsZUV4ZXJjaXNlcyIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJudW1iZXJPZldvcmtvdXRzIiwibXVzdEluY2x1ZGVMaXN0IiwiY3JlYXRvckV4ZXJjaXNlTGlzdCIsImFsbEV4ZXJjaXNlTGlzdCIsImpzb25TdHJpbmciLCJwYXJzZWRSZXNwb25zZSIsImNhbGN1bGF0ZU51bWJlck9mV29ya291dHMiLCJqb2luIiwibWFwIiwiZXgiLCJuYW1lIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwicmVwbGFjZSIsInRyaW0iLCJzdGFydHNXaXRoIiwiZW5kc1dpdGgiLCJKU09OIiwicGFyc2UiLCJzdGFja3MiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJmb3JFYWNoIiwic3RhY2siLCJpbmRleCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJleGVyY2lzZXMiLCJleGVyY2lzZSIsImV4SW5kZXgiLCJjYXRlZ29yeSIsImRldGFpbHMiLCJyZXBzIiwicGFyc2VFcnJvciIsIm1zUGVyRGF5IiwiZGlmZkluTXMiLCJnZXRUaW1lIiwiZGF5cyIsIk1hdGgiLCJjZWlsIiwiZ2V0SW5zdGFuY2UiLCJpbnN0YW5jZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/api/firebase/gemini/service.ts\n"));

/***/ })

});